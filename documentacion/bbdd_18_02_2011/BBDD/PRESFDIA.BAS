10 '                        PRESFDIA.BAS
20 '                    ---------------------
30 '        PROGRAMA DE CIERRE TOTAL DEL DIA EN HOSTELERIA
40 '        ----------------------------------------------
50 ON ERROR GOTO 9110
52 DEFSTR C,B,F
85 '
87 GOSUB 33000
90 OPTION BASE 1:KEY 1,CHR$(14)
100 '
102 '
111 '
130 FECHA$=MID$(DATE$,4,2)+"-"+LEFT$(DATE$,2)+"-"+RIGHT$(DATE$,2)
140 GOSUB 8000
150 COLOR 11:LOCATE 10,24:PRINT "PROCESO DE FIN DE DIA EN HOSTELERIA"
160 LOCATE 11,24:PRINT STRING$(35,205)
165 GOSUB 8500:MEN$=" Espere por favor ........:GOSUB 8500
7512 COLOR 28:LOCATE 13,18:PRINT "ES CONVENIENTE SACAR RESPALDO DE LOS FICHEROS"
7514 COLOR 11:LOCATE 14,18:PRINT STRING$(45,205)
7516 GOSUB 8500:LOCATE 22,15
7518 COLOR 11:PRINT "Para sacar Respaldos pulsar ";
7520 COLOR 15:PRINT " ENTER ";
7522 COLOR 11:PRINT ", Si no pulsar ";
7524 COLOR 15:PRINT " F1 "
7526 A$=INPUT$(1)
7528 IF ASC(A$)<13 OR ASC(A$)>14 THEN BEEP:GOTO 7526
7530 IF ASC(A$)=14 THEN 7600
7540 '
7550 '
7560 '
7570 '
7580 CLS
7590 SHELL "RESBACK.BAT"
7600 GOSUB 60000:FOR H!=1 TO 8000!:B=B:NEXT H!
7610 '
7620 GOSUB 61000
7630 FOR H!=1 TO 8000!:B=B:NEXT H!:CLS
7640 GOTO 9000
8000 '***********************************************
8010 '***  RUTINA PARA SACAR CARATULA EN PANTALLA ***
8020 '***********************************************
8030 '
8040 CLS:COLOR 10:LOCATE 1,1:PRINT CHR$(201)+STRING$(78,205)+CHR$(187)
8050 LOCATE 2,1:PRINT CHR$(186):COLOR 11:LOCATE 2,3:PRINT" " EMPRESA$" ":COLOR 10:LOCATE 2,34:PRINT "Aplicaci¢n : HOSTELERIA":COLOR 11:LOCATE 2,63:PRINT "FECHA : "FECHA$" ":COLOR 10 : LOCATE 2,80 :PRINT CHR$(186)
8060 LOCATE 3,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
8070 FOR J%=4 TO 21 :LOCATE J%,1:PRINT CHR$(186):LOCATE J%,80 :PRINT CHR$(186):NEXT
8080 LOCATE 21,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
8090 LOCATE 22,1:PRINT CHR$(186):COLOR 11:LOCATE 22,3:PRINT "Mensajes: ":COLOR 10:LOCATE 22,80:PRINT CHR$(186)
8100 LOCATE 23,1:PRINT CHR$(200)+STRING$(78,205)+CHR$(188);
8110 COLOR 7,0,0:RETURN
8120 '
8250 '
8490 '*************************
8500 '***IMPRESION DE MENSAJES*
8510 '*************************
8515 '
8520 L.L$=""+MEN$+"":LOCATE 22,15:PRINT L.L$;
8525 IF RET%=1 THEN FOR H=1 TO 1500:NEXT H:RET%=0
8530 MEN$=SPACE$(64)
8540 RETURN
8550 '
9000 '**********************
9010 '***FIN DEL PROGRAMA***
9020 '**********************
9025 CLOSE
9030 RUN "PRESINIC"      'FINALIZAR LA JORNADA
9040 '
9050 END
9060 '
9070 '
9080 '
9090 '
9100 '*******************************
9110 '***RUTINA CONTROL DE ERRORES***
9120 '*******************************
9130 '
9140 GOTO 9190
9142 GOSUB 8500:MEN$="Fichero FACAALUM.DIR inexistente, pulse una tecla":GOSUB 8500:A$=INPUT$(1):CLOSE:GOTO 9000
9144 GOSUB 8500:MEN$="Fichero FACAALUM.DAT inexistente, pulse una tecla":GOSUB 8500:A$=INPUT$(1):CLOSE:GOTO 9000
9150 '
9190 ON ERROR GOTO 0
33000 '**********************************
33010 '***APERTURA FICHERO DATOS FIJOS***
33020 '**********************************
33030 OPEN "R",#1,"FDATFIJ.DAT",100
33040 FIELD #1,2 AS NRO$,8 AS NDIRE$,30 AS NEMPRESA$,15 AS NNIF$,8 AS NPROG$,37 AS NFILLER$
33050 GET #1,1
33052 NROEM$=NRO$
33060 DIRE$=NDIRE$
33070 EMPRESA$="** ESCUELA DE HOSTELERIA **"
33080 NIF$=NNIF$
33082 PROGRAMA$=NPROG$
33090 CLOSE
33100 '
33110 '
33120 RETURN
33130 '
60000 CLS:COLOR 15:LOCATE 2,1,0:PRINT CHR$(201)+STRING$(78,205)+CHR$(187)
60010  FOR J%=3 TO 22:LOCATE J%,1:PRINT CHR$(186):LOCATE J%,80:PRINT CHR$(186);:NEXT
60020  LOCATE 23,1:PRINT CHR$(200)+STRING$(78,205)+CHR$(188);
60030 '
60050 COLOR 12
60052 FOR A%=3 TO 22
60053 LOCATE A%,2:PRINT STRING$(78,"²")
60054 NEXT A%
60060 COLOR 10
60065 LOCATE 3,74:PRINT STRING$(6,"²")
60130 N%=8
60140 FOR A%=4 TO 21
60150 LOCATE A%,80-N%:PRINT STRING$(6,"²")
60160 N%=N%+4
60170 NEXT A%
60171 LOCATE 22,2:PRINT STRING$(6,"²")
60172 LOCATE 3,2:PRINT STRING$(6,"²")
60173 N%=4
60174 FOR A%=4 TO 21
60176 LOCATE A%,N%:PRINT STRING$(6,"²")
60178 N%=N%+4
60180 NEXT A%
60182 LOCATE 22,74:PRINT STRING$(6,"²")
60183 COLOR 15:LOCATE 12,2:PRINT STRING$(78,"²")
60184 LOCATE 13,2:PRINT STRING$(78,"²")
60186 FOR A%=3 TO 22
60187 LOCATE A%,38:PRINT STRING$(6,"²")
60188 NEXT A%
60190 'END
60200 COLOR 13:LOCATE 8,28,0:PRINT CHR$(201)+STRING$(23,205)+CHR$(187)
60210  FOR J%=9 TO 15:LOCATE J%,28:PRINT CHR$(186)+STRING$(23," ")+CHR$(186):NEXT
60220  LOCATE 16,28:PRINT CHR$(200)+STRING$(23,205)+CHR$(188);
60230 COLOR 15
60240 LOCATE 10,31:PRINT "A P L I C A C I O N"
60250 LOCATE 12,31:PRINT "   E S C U E L A   "
60260 LOCATE 14,31:PRINT "H O S T E L E R I A"
60270 RETURN
61000 CLS
61010 LOCATE 10,31:PRINT "M U C H I S I M A S"
61020 LOCATE 12,31:PRINT "   G R A C I A S   "
61030 LOCATE 14,31:PRINT "H A S T A   O T R A"
61040 COLOR 9:LOCATE 8,28,0:PRINT CHR$(201)+STRING$(23,205)+CHR$(187)
61050  FOR J%=9 TO 15:LOCATE J%,28:PRINT CHR$(186):LOCATE J%,52:PRINT CHR$(186):NEXT
61060  LOCATE 16,28:PRINT CHR$(200)+STRING$(23,205)+CHR$(188);
61070 COLOR 15:N%=77
61080 LOCATE 23,2:PRINT STRING$(78,"²")
61090 FOR A%=22 TO 17 STEP -1
61100 LOCATE A%,80-N%:PRINT STRING$(N%,"²")
61110 N%=N%-4
61120 NEXT A%
61130 LOCATE 16,27:PRINT "²"
61140 FOR A%=16 TO 10 STEP -1
61150 LOCATE A%,53:PRINT STRING$(27,"²")
61160 NEXT A%
61170 N%=25:COLOR 12
61180 FOR A%=9 TO 3 STEP -1
61190 LOCATE A%,80-N%:PRINT STRING$(N%,"²")
61200 N%=N%-4
61210 NEXT A%
61220 COLOR 11
61230 N%=1
61240 FOR A%=22 TO 16 STEP -1
61250 LOCATE A%,2:PRINT STRING$(N%,"²")
61260 N%=N%+4
61270 NEXT A%
61280 FOR A%=15 TO 9 STEP -1
61290 LOCATE A%,2:PRINT STRING$(26,"²")
61300 NEXT A%
61310 LOCATE 9,53:PRINT STRING$(2,"²")
61320 LOCATE 8,2:PRINT STRING$(26,"²")
61330 LOCATE 8,53:PRINT STRING$(6,"²")
61340 N%=61
61350 FOR A%=7 TO 3 STEP -1
61360 LOCATE A%,2:PRINT STRING$(N%,"²")
61370 N%=N%+4
61380 NEXT A%
61390 LOCATE 2,2:PRINT STRING$(78,"²")
61391 COLOR 10
61392 FOR A%=4 TO 8
61393 LOCATE A%,6:PRINT STRING$(2,"²")
61394 NEXT A%
61395 LOCATE 5,4:PRINT STRING$(6,"²")
61400 COLOR 15:LOCATE 1,1,0:PRINT CHR$(201)+STRING$(78,205)+CHR$(187)
61410  FOR J%=2 TO 23:LOCATE J%,1:PRINT CHR$(186):LOCATE J%,80:PRINT CHR$(186);:NEXT
61420  LOCATE 24,1:PRINT CHR$(200)+STRING$(78,205)+CHR$(188);
61430 RETURN
