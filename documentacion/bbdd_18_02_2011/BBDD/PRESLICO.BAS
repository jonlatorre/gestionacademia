10 '                       PRESLICO.BAS
20 '                      --------------
30 '      LISTADO DE LOS CODIGOS DE PRODUCTOS RESTAURANTE
40 '   ----------------------------------------------------
52 '
54 '
56 '
60 ON ERROR GOTO 9100
70 'WIDTH "LPT1:",132:OPEN "LPT1:" FOR OUTPUT AS #9
75 'LPRINT CHR$(27) "C" CHR$(72);:LPRINT CHR$(15)
80 KEY 1,CHR$(14):KEY 7,CHR$(7):KEY 8,CHR$(9):KEY 10,CHR$(10)
82 KEY 2,CHR$(15):KEY 3,CHR$(16):KEY 4,CHR$(17)
90 CERO$=STRING$(15,"0"):T$=STRING$(4,205):B$="    ":F$=STRING$(4,178)
100 '
132 FECHA$=MID$(DATE$,4,3)+LEFT$(DATE$,3)+RIGHT$(DATE$,2)
134 GOSUB 33000
140 DEFSTR H,C,N
150 OPTION BASE 1
160 DIM TABRUT$(7),DIAS%(12),TABENT$(30)
174 DATA 31,28,31,30,31,30,31,31,30,31,30,31
176 FOR A%=1 TO 12:READ DIAS%(A%):NEXT A%
178 TOPE1%=7:TOPE2%=8
300 '******************************
302 '***TRATAMIENTO DEL PROGRAMA***
310 '******************************
320 'Presentamos el Menu del Programa.
330 GOSUB 8000
332 TIT$="- LISTADO DE LAS TABLAS DE CODIGOS DEL RESTAURANTE -"
334 X%=80-LEN(TIT$):X%=INT(X%/2)
340 COLOR 11:LOCATE 7,X%:PRINT TIT$
350 LOCATE 8,X%:PRINT STRING$(LEN(TIT$),205)
522 GOSUB 8500:MEN$="Espere Por Favor...":GOSUB 8500
530 GOSUB 30010        'Apertura Fichero HIBRIDO
550 GOSUB 32000
552 LINEA1$=CHR$(201)+STRING$(28,205)+CHR$(187)
554 LINEA2$=CHR$(200)+STRING$(28,205)+CHR$(188)
570 N%=0
590 '
610 N%=N%+1:GET #4,N%
618 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
619 PUT #4,N%
620 N%=N%+1:GET #4,N%
630 LSET NDES="º      MENUS  Y  EXTRAS      º":LSET NODI=MKI$(0):LSET NLIB=""
640 PUT #4,N%
650 N%=N%+1:GET #4,N%
652 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
654 PUT #4,N%
656 N%=N%+1:GET #4,N%
658 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
660 PUT #4,N%
662 FOR A%=1 TO 50
664 GET #2,A%
666 IF CSTA="P" THEN 674
668 N%=N%+1:GET #4,N%
670 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
672 PUT #4,N%
674 NEXT A%
676 N%=N%+1:GET #4,N%
678 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
680 PUT #4,N%
710 N%=N%+1:GET #4,N%
718 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
719 PUT #4,N%
720 N%=N%+1:GET #4,N%
730 LSET NDES="º    CAFES  E  INFUSIONES    º":LSET NODI=MKI$(0):LSET NLIB=""
740 PUT #4,N%
750 N%=N%+1:GET #4,N%
752 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
754 PUT #4,N%
756 N%=N%+1:GET #4,N%
758 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
760 PUT #4,N%
762 FOR A%=51 TO 100
764 GET #2,A%
766 IF CSTA="P" THEN 774
768 N%=N%+1:GET #4,N%
770 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
772 PUT #4,N%
774 NEXT A%
776 N%=N%+1:GET #4,N%
778 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
780 PUT #4,N%
810 N%=N%+1:GET #4,N%
818 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
819 PUT #4,N%
820 N%=N%+1:GET #4,N%
830 LSET NDES="º    B  R  A  N  D  Y  S     º":LSET NODI=MKI$(0):LSET NLIB=""
840 PUT #4,N%
850 N%=N%+1:GET #4,N%
852 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
854 PUT #4,N%
856 N%=N%+1:GET #4,N%
858 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
860 PUT #4,N%
862 FOR A%=101 TO 150
864 GET #2,A%
866 IF CSTA="P" THEN 874
868 N%=N%+1:GET #4,N%
870 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
872 PUT #4,N%
874 NEXT A%
876 N%=N%+1:GET #4,N%
878 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
880 PUT #4,N%
910 N%=N%+1:GET #4,N%
918 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
919 PUT #4,N%
920 N%=N%+1:GET #4,N%
930 LSET NDES="º    P A T X A R A N E S     º":LSET NODI=MKI$(0):LSET NLIB=""
940 PUT #4,N%
950 N%=N%+1:GET #4,N%
952 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
954 PUT #4,N%
956 N%=N%+1:GET #4,N%
958 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
960 PUT #4,N%
962 FOR A%=151 TO 200
964 GET #2,A%
966 IF CSTA="P" THEN 974
968 N%=N%+1:GET #4,N%
970 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
972 PUT #4,N%
974 NEXT A%
975 G%=N%+1
976 FOR F%=G% TO 60
977 N%=N%+1:GET #4,N%
978 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
980 PUT #4,N%
982 NEXT F%
1010 N%=N%+1:GET #4,N%
1018 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
1019 PUT #4,N%
1020 N%=N%+1:GET #4,N%
1030 LSET NDES="º      A  N  I  S  E  S      º":LSET NODI=MKI$(0):LSET NLIB=""
1040 PUT #4,N%
1050 N%=N%+1:GET #4,N%
1052 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
1054 PUT #4,N%
1056 N%=N%+1:GET #4,N%
1058 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1060 PUT #4,N%
1062 FOR A%=201 TO 250
1064 GET #2,A%
1066 IF CSTA="P" THEN 1074
1068 N%=N%+1:GET #4,N%
1070 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
1072 PUT #4,N%
1074 NEXT A%
1076 N%=N%+1:GET #4,N%
1078 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1080 PUT #4,N%
1110 N%=N%+1:GET #4,N%
1118 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
1119 PUT #4,N%
1120 N%=N%+1:GET #4,N%
1130 LSET NDES="º      G I N E B R A S       º":LSET NODI=MKI$(0):LSET NLIB=""
1140 PUT #4,N%
1150 N%=N%+1:GET #4,N%
1152 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
1154 PUT #4,N%
1156 N%=N%+1:GET #4,N%
1158 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1160 PUT #4,N%
1162 FOR A%=251 TO 300
1164 GET #2,A%
1166 IF CSTA="P" THEN 1174
1168 N%=N%+1:GET #4,N%
1170 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
1172 PUT #4,N%
1174 NEXT A%
1176 N%=N%+1:GET #4,N%
1178 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1180 PUT #4,N%
1210 N%=N%+1:GET #4,N%
1218 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
1219 PUT #4,N%
1220 N%=N%+1:GET #4,N%
1230 LSET NDES="º       R  O  N  E  S        º":LSET NODI=MKI$(0):LSET NLIB=""
1240 PUT #4,N%
1250 N%=N%+1:GET #4,N%
1252 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
1254 PUT #4,N%
1256 N%=N%+1:GET #4,N%
1258 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1260 PUT #4,N%
1262 FOR A%=301 TO 350
1264 GET #2,A%
1266 IF CSTA="P" THEN 1274
1268 N%=N%+1:GET #4,N%
1270 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
1272 PUT #4,N%
1274 NEXT A%
1276 N%=N%+1:GET #4,N%
1278 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1280 PUT #4,N%
1310 N%=N%+1:GET #4,N%
1318 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
1319 PUT #4,N%
1320 N%=N%+1:GET #4,N%
1330 LSET NDES="º    W  H  I  S  K  Y  S     º":LSET NODI=MKI$(0):LSET NLIB=""
1340 PUT #4,N%
1350 N%=N%+1:GET #4,N%
1352 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
1354 PUT #4,N%
1356 N%=N%+1:GET #4,N%
1358 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1360 PUT #4,N%
1362 FOR A%=351 TO 400
1364 GET #2,A%
1366 IF CSTA="P" THEN 1374
1368 N%=N%+1:GET #4,N%
1370 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
1372 PUT #4,N%
1374 NEXT A%
1376 N%=N%+1:GET #4,N%
1378 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1380 PUT #4,N%
1410 N%=N%+1:GET #4,N%
1418 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
1419 PUT #4,N%
1420 N%=N%+1:GET #4,N%
1430 LSET NDES="º      W  O  D  K  A  S      º":LSET NODI=MKI$(0):LSET NLIB=""
1440 PUT #4,N%
1450 N%=N%+1:GET #4,N%
1452 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
1454 PUT #4,N%
1456 N%=N%+1:GET #4,N%
1458 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1460 PUT #4,N%
1462 FOR A%=401 TO 450
1464 GET #2,A%
1466 IF CSTA="P" THEN 1474
1468 N%=N%+1:GET #4,N%
1470 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
1472 PUT #4,N%
1474 NEXT A%
1475 'G%=N%
1476 'FOR F%=1 TO TOPE2%
1477 N%=N%+1:GET #4,N%
1478 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1480 PUT #4,N%
1482 'NEXT F%
1510 N%=N%+1:GET #4,N%
1518 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
1519 PUT #4,N%
1520 N%=N%+1:GET #4,N%
1530 LSET NDES="º   T  E  Q  U  I  L  A  S   º":LSET NODI=MKI$(0):LSET NLIB=""
1540 PUT #4,N%
1550 N%=N%+1:GET #4,N%
1552 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
1554 PUT #4,N%
1556 N%=N%+1:GET #4,N%
1558 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1560 PUT #4,N%
1562 FOR A%=451 TO 500
1564 GET #2,A%
1566 IF CSTA="P" THEN 1574
1568 N%=N%+1:GET #4,N%
1570 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
1572 PUT #4,N%
1574 NEXT A%
1575 G%=N%+1
1576 FOR F%=G% TO 120
1577 N%=N%+1:GET #4,N%
1578 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1580 PUT #4,N%
1585 NEXT F%
1610 N%=N%+1:GET #4,N%
1618 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
1619 PUT #4,N%
1620 N%=N%+1:GET #4,N%
1630 LSET NDES="º      O  R  U  J  O  S      º":LSET NODI=MKI$(0):LSET NLIB=""
1640 PUT #4,N%
1650 N%=N%+1:GET #4,N%
1652 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
1654 PUT #4,N%
1656 N%=N%+1:GET #4,N%
1658 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1660 PUT #4,N%
1662 FOR A%=501 TO 550
1664 GET #2,A%
1666 IF CSTA="P" THEN 1674
1668 N%=N%+1:GET #4,N%
1670 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
1672 PUT #4,N%
1674 NEXT A%
1676 N%=N%+1:GET #4,N%
1678 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1680 PUT #4,N%
1710 N%=N%+1:GET #4,N%
1718 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
1719 PUT #4,N%
1720 N%=N%+1:GET #4,N%
1730 LSET NDES="º    L  I  C  O  R  E  S     º":LSET NODI=MKI$(0):LSET NLIB=""
1740 PUT #4,N%
1750 N%=N%+1:GET #4,N%
1752 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
1754 PUT #4,N%
1756 N%=N%+1:GET #4,N%
1758 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1760 PUT #4,N%
1762 FOR A%=551 TO 600
1764 GET #2,A%
1766 IF CSTA="P" THEN 1774
1768 N%=N%+1:GET #4,N%
1770 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
1772 PUT #4,N%
1774 NEXT A%
1776 N%=N%+1:GET #4,N%
1778 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1780 PUT #4,N%
1810 N%=N%+1:GET #4,N%
1818 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
1819 PUT #4,N%
1820 N%=N%+1:GET #4,N%
1830 LSET NDES="º      C  O  ¥  A  C  S      º":LSET NODI=MKI$(0):LSET NLIB=""
1840 PUT #4,N%
1850 N%=N%+1:GET #4,N%
1852 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
1854 PUT #4,N%
1856 N%=N%+1:GET #4,N%
1858 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1860 PUT #4,N%
1862 FOR A%=601 TO 650
1864 GET #2,A%
1866 IF CSTA="P" THEN 1874
1868 N%=N%+1:GET #4,N%
1870 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
1872 PUT #4,N%
1874 NEXT A%
1876 N%=N%+1:GET #4,N%
1878 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1880 PUT #4,N%
1910 N%=N%+1:GET #4,N%
1918 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
1919 PUT #4,N%
1920 N%=N%+1:GET #4,N%
1930 LSET NDES="º     R E F R E S C O S      º":LSET NODI=MKI$(0):LSET NLIB=""
1940 PUT #4,N%
1950 N%=N%+1:GET #4,N%
1952 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
1954 PUT #4,N%
1956 N%=N%+1:GET #4,N%
1958 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1960 PUT #4,N%
1962 FOR A%=701 TO 750
1964 GET #2,A%
1966 IF CSTA="P" THEN 1974
1968 N%=N%+1:GET #4,N%
1970 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
1972 PUT #4,N%
1974 NEXT A%
1976 N%=N%+1:GET #4,N%
1978 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1980 PUT #4,N%
1981 G%=N%+1
1982 FOR F%=G% TO 180
1984 N%=N%+1:GET #4,N%
1986 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
1988 PUT #4,N%
1989 NEXT F%
2000 N%=N%+1:GET #4,N%
2002 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
2004 PUT #4,N%
2006 N%=N%+1:GET #4,N%
2008 LSET NDES="º    C O M B I N A D O S     º":LSET NODI=MKI$(0):LSET NLIB=""
2010 PUT #4,N%
2012 N%=N%+1:GET #4,N%
2014 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
2016 PUT #4,N%
2018 N%=N%+1:GET #4,N%
2020 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
2022 PUT #4,N%
2024 FOR A%=751 TO 800
2026 GET #2,A%
2028 IF CSTA="P" THEN 2036
2030 N%=N%+1:GET #4,N%
2032 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
2034 PUT #4,N%
2036 NEXT A%
2038 N%=N%+1:GET #4,N%
2040 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
2042 PUT #4,N%
2044 N%=N%+1:GET #4,N%
2046 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
2048 PUT #4,N%
2050 N%=N%+1:GET #4,N%
2052 LSET NDES="º    A P E R I T I V O S     º":LSET NODI=MKI$(0):LSET NLIB=""
2054 PUT #4,N%
2056 N%=N%+1:GET #4,N%
2058 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
2060 PUT #4,N%
2062 N%=N%+1:GET #4,N%
2064 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
2066 PUT #4,N%
2068 FOR A%=801 TO 850
2070 GET #2,A%
2072 IF CSTA="P" THEN 2080
2074 N%=N%+1:GET #4,N%
2076 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
2078 PUT #4,N%
2080 NEXT A%
2082 N%=N%+1:GET #4,N%
2084 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
2086 PUT #4,N%
2088 N%=N%+1:GET #4,N%
2090 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
2092 PUT #4,N%
2094 N%=N%+1:GET #4,N%
2096 LSET NDES="º     C A F E T E R I A      º":LSET NODI=MKI$(0):LSET NLIB=""
2098 PUT #4,N%
2100 N%=N%+1:GET #4,N%
2102 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
2104 PUT #4,N%
2106 N%=N%+1:GET #4,N%
2108 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
2110 PUT #4,N%
2112 FOR A%=851 TO 900
2114 GET #2,A%
2116 IF CSTA="P" THEN 2124
2118 N%=N%+1:GET #4,N%
2120 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
2122 PUT #4,N%
2124 NEXT A%
2126 N%=N%+1:GET #4,N%
2128 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
2130 PUT #4,N%
2132 N%=N%+1:GET #4,N%
2134 LSET NDES=LINEA1$:LSET NODI=MKI$(0):LSET NLIB=""
2136 PUT #4,N%
2138 N%=N%+1:GET #4,N%
2140 LSET NDES="º    T  A  B  A  C  O  S     º":LSET NODI=MKI$(0):LSET NLIB=""
2142 PUT #4,N%
2144 N%=N%+1:GET #4,N%
2146 LSET NDES=LINEA2$:LSET NODI=MKI$(0):LSET NLIB=""
2148 PUT #4,N%
2150 N%=N%+1:GET #4,N%
2152 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
2154 PUT #4,N%
2156 FOR A%=651 TO 700
2158 GET #2,A%
2160 IF CSTA="P" THEN 2168
2162 N%=N%+1:GET #4,N%
2164 LSET NDES=LEFT$(CDES,30):LSET NODI=MKI$(A%):LSET  NLIB=""
2166 PUT #4,N%
2168 NEXT A%
2170 G%=N%+1
2172 FOR F%=G% TO 60
2174 N%=N%+1:GET #4,N%
2176 LSET NDES=STRING$(30," "):LSET NODI=MKI$(0):LSET NLIB=""
2178 PUT #4,N%
2180 NEXT F%
4000 CLOSE
4020 '
4040 '
4060 '
4480 '*************************
4490 '***INFORME DEL FICHERO***
4492 '*************************
4494 GOSUB 8500:MEN$="Espere por Favor...":GOSUB 8500
4496 WIDTH "LPT1:",132:OPEN "LPT1:" FOR OUTPUT AS #9
4498 LPRINT CHR$(27)+"&l0O"+CHR$(27)
4500 'LPRINT CHR$(27) "C" CHR$(66);:LPRINT CHR$(15)
4502 '
4504 '
4510 GOSUB 32000
4515 LPRINT TAB(33) "T A B L A    D E    C O D I G O S    D E L    R E S T A U R A N T E"
4520 LPRINT TAB(33) STRING$(67,205)
4525 LPRINT
4530 FOR AA%=1 TO 60
4535 GET #4,AA%
4540 IF CVI(NODI)=0 THEN 4560
4545 GUAPRI#=CVI(NODI):GOSUB 64770
4550 LPRINT TAB(6-L.C%) GUAPRI$"-";
4555 LPRINT TAB(8) NDES;:GOTO 4565
4560 LPRINT TAB(5) NDES;
4565 '
4570 GET #4,AA%+60
4575 IF CVI(NODI)=0 THEN 4595
4580 GUAPRI#=CVI(NODI):GOSUB 64770
4585 LPRINT TAB(52-L.C%) GUAPRI$"-";
4590 LPRINT TAB(54) NDES;:GOTO 4600
4595 LPRINT TAB(51) NDES;
4600 '
4670 GET #4,AA%+120
4675 IF CVI(NODI)=0 THEN 4695
4680 GUAPRI#=CVI(NODI):GOSUB 64770
4685 LPRINT TAB(98-L.C%) GUAPRI$"-";
4690 LPRINT TAB(100) NDES:GOTO 4700
4695 LPRINT TAB(97) NDES
4700 '
4705 NEXT AA%
4710 '
4712 LPRINT CHR$(12)
4715 'GOTO 9000
4720 'STOP
5000 LPRINT TAB(33) "T A B L A    D E    C O D I G O S    D E L    R E S T A U R A N T E"
5010 LPRINT TAB(33) STRING$(67,205)
5020 LPRINT
5030 FOR AA%=181 TO 240
5040 GET #4,AA%
5050 IF CVI(NODI)=0 THEN 5090
5060 GUAPRI#=CVI(NODI):GOSUB 64770
5070 LPRINT TAB(6-L.C%) GUAPRI$"-";
5080 LPRINT TAB(8) NDES;:GOTO 5100
5090 LPRINT TAB(5) NDES;
5100 '
5110 GET #4,AA%+60
5120 IF CVI(NODI)=0 THEN 5160
5130 GUAPRI#=CVI(NODI):GOSUB 64770
5140 LPRINT TAB(52-L.C%) GUAPRI$"-";
5150 LPRINT TAB(54) NDES;:GOTO 5170
5160 LPRINT TAB(51) NDES;
5170 '
5180 GET #4,AA%+120
5190 IF CVI(NODI)=0 THEN 5230
5200 GUAPRI#=CVI(NODI):GOSUB 64770
5210 LPRINT TAB(98-L.C%) GUAPRI$"-";
5220 LPRINT TAB(100) NDES:GOTO 5240
5230 LPRINT TAB(97) NDES
5240 '
5250 NEXT AA%
5260 LPRINT CHR$(12)
5265 CLOSE
5270 KILL "FRESCODI.LIS"
5280 GOTO 9000
5290 '
8000 '***********************************************
8010 '***  RUTINA PARA SACAR CARATULA EN PANTALLA ***
8020 '***********************************************
8030 '
8040 CLS:COLOR 10:LOCATE 1,1:PRINT CHR$(201)+STRING$(78,205)+CHR$(187)
8050 LOCATE 2,1:PRINT CHR$(186):COLOR 11:LOCATE 2,3:PRINT" " EMPRESA$" ":COLOR 10:LOCATE 2,36:PRINT "Aplicaci¢n : RESTAURANTE":COLOR 11:LOCATE 2,63:PRINT "FECHA : "FECHA$" ":COLOR 10 : LOCATE 2,80 :PRINT CHR$(186)
8060 LOCATE 3,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
8070 FOR J%=4 TO 21 :LOCATE J%,1:PRINT CHR$(186):LOCATE J%,80 :PRINT CHR$(186):NEXT
8080 LOCATE 22,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
8090 LOCATE 23,1:PRINT CHR$(186):COLOR 11:LOCATE 23,3:PRINT "Mensajes: ":COLOR 10:LOCATE 23,80:PRINT CHR$(186)
8100 LOCATE 24,1:PRINT CHR$(200)+STRING$(78,205)+CHR$(188);
8110 COLOR 7,0,0:RETURN
8120 '
8250 '
8490 '*************************
8500 '***IMPRESION DE MENSAJES*
8510 '*************************
8515 '
8520 L.L$=""+MEN$+"":LOCATE 23,14:PRINT L.L$;
8525 IF RET%=1 THEN FOR H%=1 TO 1500:NEXT H%:RET%=0
8530 MEN$=SPACE$(64)
8540 RETURN
8550 '
9000 '**********************
9010 '***FIN DEL PROGRAMA***
9020 '**********************
9030 CLOSE
9040 RUN "PRESCODI"
9050 END
9060 '
9070 '
9080 '
9090 '
9100 '*******************************
9110 '***RUTINA CONTROL DE ERRORES***
9120 '*******************************
9130 IF ERR=24 OR ERR=25 OR ERR=27 THEN GOSUB 8500:MEN$="--COMPRUEBE LA IMPRESORA Y PULSE UNA TECLA---":GOSUB 8500:A$=INPUT$(1):RESUME
9140 IF ERL=30052 AND ERR=53 THEN GOSUB 8500:MEN$="Fichero FACTCALE.DIR inexistente, pulsa una tecla":GOSUB 8500:A$=INPUT$(1):CLOSE:RESUME 9000
9150 IF ERL=30100 AND ERR=53 THEN GOSUB 8500:MEN$="Fichero FACTCALE.DAT inexistente, pulsa una tecla":GOSUB 8500:A$=INPUT$(1):CLOSE:RESUME 9000
9170 ON ERROR GOTO 0
9180 '
30000 '*******************************
30010 '***APERTURA FICHERO HIBRIDO ***
30020 '*******************************
30090 ' Apertura del fichero de datos   FRESCODI.DAT
30095 '
30100 OPEN "R",#2,"FRESCODI.DAT",80
30105 '
30110 FIELD #2,4 AS CODI,50 AS CDES,4 AS CPRE,4 AS CBOT,2 AS CCEN,15 AS CLIB,1 AS CSTA
30114 '
30116 'FOR A%=1 TO 9999
30117 'GET #2,A%
30118 'LSET CODI="":LSET CDES="":LSET CPRE=MKS$(0):LSET CBOT=MKS$(0):LSET CCEN=MKI$(0):LSET CLIB="":LSET CSTA="P"
30119 'PUT #2,A%
30120 'NEXT A%
30121 'STOP
30122 '
30128 RETURN
30130 '
30140 '
32000 '*******************************
32010 '***APERTURA FICHERO HIBRIDO ***
32020 '*******************************
32090 ' Apertura del fichero de datos   FRESCODI.DAT
32095 '
32100 OPEN "R",#4,"FRESCODI.LIS",35
32105 '
32110 FIELD #4,2 AS NODI,30 AS NDES,3 AS NLIB
32122 '
32128 RETURN
32130 '
32140 '
33000 '**********************************
33010 '***APERTURA FICHERO DATOS FIJOS***
33020 '**********************************
33030 OPEN "R",#1,"FDATFIJ.DAT",100
33040 FIELD #1,2 AS NRO$,8 AS NDIRE$,30 AS NEMPRESA$,15 AS NNIF$,8 AS NPROG$,37 AS NFILLER$
33050 GET #1,1
33052 NROEM$=NRO$
33060 DIRE$=NDIRE$
33070 EMPRESA$=NEMPRESA$
33080 NIF$=NNIF$
33082 PROGRAMA$=NPROG$
33090 CLOSE
33100 '
33110 '
33120 RETURN
33130 '
64760 '========================================================================
64762 ' RUTINA PARA EDITAR IMPORTES EN CRISTIANO X.XXX.XXX,XX                 =
64764 '                                                                       =
64766 ' SE ENTRARA A ESTA RUTINA DE LA FORMA  SIGUIENTE:                      =
64768 '                                                                       =
64770 ' GOSUB 64760 MANDANDO EN UN CAMPO LLAMADO GUAPRI#,                     =
64772 '                                                                       =
64773 '             LA CANTIDAD O NUMERO QUE DESEEMOS EDITAR.                 =
64774 '                                                                       =
64775 '             Y EN UN CAMPO LLAMADO N.D% EL NUMERO DE DECIMALES         =
64776 '                                                                       =
64778 ' DEVOLVERA EL CAMPO EDITADO EN GUAPRI$ Y LA LONGITUD EN L.C%           =
64780 '                                                                       =
64782 '========================================================================
64784 '
64786 '
64788 GUAPRI$=STR$(GUAPRI#):L.P%=0:N.D%=0
64790 FOR I%=1 TO 30:TABENT$(I%)="":NEXT I%
64792 SIGNO$=LEFT$(GUAPRI$,1):GUAPRI$=RIGHT$(GUAPRI$,LEN(GUAPRI$)-1)
64794 FOR I%=1 TO LEN(GUAPRI$)
64796   IF MID$(GUAPRI$,I%,1)="." THEN L.P%=I%:I%=LEN(GUAPRI$)
64798 NEXT I%
64800 IF L.P%=0 THEN DEC$="":ENT$=GUAPRI$:GOTO 64812
64802 IF N.D%=0 THEN DEC$="":GOTO 64808
64804 DEC$=","+MID$(GUAPRI$,L.P%+1,N.D%)
64806 IF LEN(DEC$)<>N.D%+1 THEN DEC$=DEC$+LEFT$(CERO$,N.D%+1-LEN(DEC$))
64808 ENT$=LEFT$(GUAPRI$,L.P%-1)
64810 IF LEN(ENT$)=0 THEN GUAPRI$="0":GOTO 64834
64812 X%=31
64814 FOR I%=LEN(ENT$) TO 1 STEP -1
64816   X%=X%-1
64818   IF X%=27 OR X%=23 OR X%=19 OR X%=15 OR X%=12 THEN TABENT$(X%)=".":X%=X%-1
64820   TABENT$(X%)=MID$(ENT$,I%,1)
64822 NEXT I%
64824 GUAPRI$=""
64826 FOR I%=1 TO 30
64828   IF TABENT$(I%)="" THEN 64832
64830   GUAPRI$=GUAPRI$+TABENT$(I%)
64832 NEXT I%
64833 IF SIGNO$=" " THEN GUAPRI$=GUAPRI$+DEC$:L.C%=LEN(GUAPRI$)-1:RETURN
64834 GUAPRI$=GUAPRI$+DEC$+SIGNO$:L.C%=LEN(GUAPRI$)-1
64836 RETURN
64838 '
