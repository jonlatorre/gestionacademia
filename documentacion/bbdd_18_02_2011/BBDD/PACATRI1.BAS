10 '                       PACATRI1.BAS
20 '                      --------------
30 '        TRATAMIENTO DE LAS CALIFICAIONES TRIMESTRE 1
40 '        --------------------------------------------
52 '
54 '
56 '
60 ON ERROR GOTO 9100
70 GOSUB 33000
80 KEY 1,CHR$(14):KEY 7,CHR$(7):KEY 8,CHR$(9):KEY 10,CHR$(10)
82 KEY 2,CHR$(15):KEY 3,CHR$(16):KEY 4,CHR$(17)
90 CERO$=STRING$(15,"0"):BLANCO$=STRING$(40," "):PUNTO$=STRING$(100,"Ä")
100 '
130 FEDIA$=RIGHT$(DATE$,4)+LEFT$(DATE$,2)+MID$(DATE$,4,2)
132 FECHA$=RIGHT$(FEDIA$,2)+"-"+MID$(FEDIA$,5,2)+"-"+LEFT$(FEDIA$,4)
134 '
140 DEFSTR C,A,F,J,N,G
150 OPTION BASE 1
160 DIM DIAS%(12),TABENT$(30),JAL%(12),FAL%(12),PERI$(12)
170 '
172 '
174 '
176 '
178 '
200 DATA "Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"
202 FOR I%=1 TO 12:READ PERI$(I%):NEXT I%
290 '
292 DATA 31,28,31,30,31,30,31,31,30,31,30,31
294 FOR I%=1 TO 12:READ DIAS%(I%):NEXT I%
296 '
299 '
300 '******************************
302 '***TRATAMIENTO DEL PROGRAMA***
304 '******************************
310 '
315 TIT$="- TRATAMIENTO CALIFICACIONES PRIMER TRIMESTRE -"
320 X%=80-LEN(TIT$):X%=INT(X%/2)
325 GOSUB 8000
330 COLOR 11:LOCATE 4,X%:PRINT TIT$
335 LOCATE 5,X%:PRINT STRING$(LEN(TIT$),205)
340 COLOR 15:LOCATE 7,26:PRINT "1.- ";:COLOR 10:PRINT "INTRODUCIR CALIFICACIONES."
345 COLOR 15:LOCATE 8,26:PRINT "2.- ";:COLOR 10:PRINT "QUITAR CALIFICACIONES."
350 COLOR 15:LOCATE 9,26:PRINT "3.- ";:COLOR 10:PRINT "MODIFICAR CALIFICACIONES."
355 COLOR 15:LOCATE 10,26:PRINT "4.- ";:COLOR 10:PRINT "CONSULTAR CALIFICACIONES."
360 COLOR 15:LOCATE 11,26:PRINT "5.- ";:COLOR 10:PRINT "LISTAR CALIFICACIONES."
365 COLOR 15:LOCATE 12,26:PRINT "6.- ";:COLOR 10:PRINT "No se usa."
370 COLOR 15:LOCATE 13,26:PRINT "7.- ";:COLOR 10:PRINT "No se usa."
375 COLOR 15:LOCATE 14,26:PRINT "8.- ";:COLOR 10:PRINT "No se usa."
380 COLOR 15:LOCATE 15,26:PRINT "9.- ";:COLOR 10:PRINT "No se usa."
385 COLOR 15:LOCATE 16,25:PRINT "10.- ";:COLOR 10:PRINT "No se usa."
390 COLOR 15:LOCATE 17,25:PRINT "11.- ";:COLOR 10:PRINT "FINAL DE CALIFICACIONES."
395 LOCATE 19,33:COLOR 11:PRINT "TECLEAR OPCION : <  > "
400 COLOR 15
405 '
410 '
415 'PEDIMOS OPCION.
420 F.C1%=19:C.C1%=51:L.E%=2:L.D%=0:NEG%=0:BO%=2:GOSUB 63000
425 IF I.T%=4 THEN COLOR 15:GOTO 9000
430 IF I.T%<>0 THEN 420
435 COLOR 15
440 I.A%=VAL(D.E$)
445 IF I.A%<1 OR I.A%>11 THEN 395
450 ON I.A% GOTO 500,300,2500,2500,4005,300,300,300,300,300,9000
455 '
460 '
465 '
500 TIT$="- INTRODUCIR CALIFICACIONES PRIMER TRIMESTRE -":GOTO 510
505 '
510 '
511 GOSUB 8000
512 COLOR 10
514 LOCATE 5,18:PRINT TIT$
516 LOCATE 6,18:PRINT STRING$(LEN(TIT$),205)
700 '
702 '
704 '
706 '
718 FALUDIR$="FACAALUM.ALF":FALUDAT$="FACAALUM.DAT"
720 GOSUB 30000:GOSUB 32000
724 GOSUB 35000
728 GOSUB 7650
730       '*******************************
732       '***ENTRADA NUMERO DE ALUMNO ***
734       '*******************************
736       COLOR 15
738       F.C1%=8:C.C1%=20:L.E%=5:BO%=6:ESC%=1:GOSUB 63000
740       IF I.T%=0 THEN CUENTA$=D.E$:GOTO 758 'Entrada OK
741       IF I.T%=4 THEN CLOSE:GOTO 300
742       BEEP:LOCATE 8,20:PRINT SPC(6):GOTO 732
756       '
758       REG%=VAL(CUENTA$)
760       GUAPRI#=VAL(CUENTA$):GOSUB 64770:LOCATE 8,25-L.C%:PRINT GUAPRI$
762     ' GET #2,REG%  'BUSCAR REGISTRO
764       IF REG%<2 OR REG%>ULTIMO% THEN GOSUB 8500:MEN$="Este N£mero de Alumno no existe, pulsar una tecla":GOSUB 8500:A$=INPUT$(1):GOTO 724
765       GET #2,REG%  'BUSCAR REGISTRO
766       IF CMARCA="L" THEN GOSUB 8500:MEN$="Alumno dado de BAJA, pulsar una tecla":GOSUB 8500:A$=INPUT$(1):GOTO 724
768       NOM$=CNOMBRE:APE1$=CAPELL1:APE2$=CAPELL2:GOSUB 40000
770       LOCATE 8,28:PRINT CUCUCU$
774       '
776       '
778       '
780       '
878       '
880       '
1000       '******************************
1002       '***ENTRADA PUNTOS CONTROL 1***
1004       '******************************
1006       F.C1%=10:C.C1%=18:L.E%=3:BO%=3:ESC%=1:GOSUB 63000
1008       IF I.T%=0 THEN CONO1%=VAL(D.E$):GOTO 1026
1010       '
1012       IF I.T%=1 AND I.A%=1 THEN CONO1%=0:GOTO 1026
1014       IF I.T%=1 AND I.A%=3 THEN CONO1%=CVI(NCOE11):GOTO 1026
1016       IF I.T%=3 AND I.A%=1 THEN LOCATE 10,18:PRINT SPC(3):GOTO 1006
1018       IF I.T%=3 THEN 1006
1020       IF I.T%=4 THEN 4000               'Fin Entrada.
1022       IF I.T%=2 AND I.A%=1 THEN 1026
1024       IF I.T%=2 THEN 1006
1026       '
1028       LOCATE 10,18:PRINT USING "###";CONO1%
1029       '
1030       '******************************
1032       '***ENTRADA SOBRE  CONTROL 1***
1034       '******************************
1036       F.C1%=10:C.C1%=22:L.E%=3:BO%=3:ESC%=1:GOSUB 63000
1038       IF I.T%=0 THEN CONS1%=VAL(D.E$):GOTO 1056
1040       '
1042       IF I.T%=1 AND I.A%=1 THEN CONS1%=0:GOTO 1056
1044       IF I.T%=1 AND I.A%=3 THEN CONS1%=CVI(NCOS11):GOTO 1056
1046       IF I.T%=3 AND I.A%=1 THEN LOCATE 10,18:PRINT SPC(3):GOTO 1006
1048       IF I.T%=3 THEN 1006
1050       IF I.T%=4 THEN 4000               'Fin Entrada.
1052       IF I.T%=2 AND I.A%=1 THEN 1056
1054       IF I.T%=2 THEN 1036
1056       '
1058       LOCATE 10,22:PRINT USING "###";CONS1%
1059       '
1060       '******************************
1062       '***ENTRADA PUNTOS CONTROL 2***
1064       '******************************
1066       F.C1%=10:C.C1%=43:L.E%=3:BO%=3:ESC%=1:GOSUB 63000
1068       IF I.T%=0 THEN CONO2%=VAL(D.E$):GOTO 1086
1070       '
1072       IF I.T%=1 AND I.A%=1 THEN CONO2%=0:GOTO 1086
1074       IF I.T%=1 AND I.A%=3 THEN CONO2%=CVI(NCOE12):GOTO 1086
1076       IF I.T%=3 AND I.A%=1 THEN LOCATE 10,22:PRINT SPC(3):GOTO 1036
1078       IF I.T%=3 THEN 1036
1080       IF I.T%=4 THEN 4000               'Fin Entrada.
1082       IF I.T%=2 AND I.A%=1 THEN 1086
1084       IF I.T%=2 THEN 1066
1086       '
1088       LOCATE 10,43:PRINT USING "###";CONO2%
1089       '
1090       '******************************
1092       '***ENTRADA SOBRE  CONTROL 2***
1094       '******************************
1096       F.C1%=10:C.C1%=47:L.E%=3:BO%=3:ESC%=1:GOSUB 63000
1098       IF I.T%=0 THEN CONS2%=VAL(D.E$):GOTO 1116
1100       '
1102       IF I.T%=1 AND I.A%=1 THEN CONS2%=0:GOTO 1116
1104       IF I.T%=1 AND I.A%=3 THEN CONS2%=CVI(NCOS12):GOTO 1116
1106       IF I.T%=3 AND I.A%=1 THEN LOCATE 10,43:PRINT SPC(3):GOTO 1066
1108       IF I.T%=3 THEN 1066
1110       IF I.T%=4 THEN 4000               'Fin Entrada.
1112       IF I.T%=2 AND I.A%=1 THEN 1116
1114       IF I.T%=2 THEN 1096
1116       '
1118       LOCATE 10,47:PRINT USING "###";CONS2%
1119       '
1120       '******************************
1122       '***ENTRADA PUNTOS CONTROL 3***
1124       '******************************
1126       F.C1%=10:C.C1%=68:L.E%=3:BO%=3:ESC%=1:GOSUB 63000
1128       IF I.T%=0 THEN CONO3%=VAL(D.E$):GOTO 1146
1130       '
1132       IF I.T%=1 AND I.A%=1 THEN CONO3%=0:GOTO 1146
1134       IF I.T%=1 AND I.A%=3 THEN CONO3%=CVI(NCOE13):GOTO 1146
1136       IF I.T%=3 AND I.A%=1 THEN LOCATE 10,47:PRINT SPC(3):GOTO 1096
1138       IF I.T%=3 THEN 1096
1140       IF I.T%=4 THEN 4000               'Fin Entrada.
1142       IF I.T%=2 AND I.A%=1 THEN 1146
1144       IF I.T%=2 THEN 1126
1146       '
1148       LOCATE 10,68:PRINT USING "###";CONO3%
1149       '
1150       '******************************
1152       '***ENTRADA SOBRE  CONTROL 3***
1154       '******************************
1156       F.C1%=10:C.C1%=72:L.E%=3:BO%=3:ESC%=1:GOSUB 63000
1158       IF I.T%=0 THEN CONS3%=VAL(D.E$):GOTO 1176
1160       '
1162       IF I.T%=1 AND I.A%=1 THEN CONS3%=0:GOTO 1176
1164       IF I.T%=1 AND I.A%=3 THEN CONS3%=CVI(NCOS13):GOTO 1176
1166       IF I.T%=3 AND I.A%=1 THEN LOCATE 10,68:PRINT SPC(3):GOTO 1126
1168       IF I.T%=3 THEN 1126
1170       IF I.T%=4 THEN 4000               'Fin Entrada.
1172       IF I.T%=2 AND I.A%=1 THEN 1176
1174       IF I.T%=2 THEN 1156
1176       '
1178       LOCATE 10,72:PRINT USING "###";CONS3%
1179       '
1180       '******************************
1182       '***ENTRADA COMPORTAMIENTO  ***
1184       '******************************
1186       LOCATE 20,13:COLOR 12:PRINT "E = Muy Bueno,    B = Bueno,    R = Regular,    M = Malo":COLOR 15
1187       F.C1%=12:C.C1%=30:L.E%=1:BO%=1:GOSUB 64000
1188       IF I.T%=0 THEN COMPO$=D.E$:GOTO 1206
1190       '
1192       IF I.T%=1 AND I.A%=1 THEN COMPO$=" ":GOTO 1206
1194       IF I.T%=1 AND I.A%=3 THEN COMPO$=NCOMP1:GOTO 1206
1196       IF I.T%=3 AND I.A%=1 THEN LOCATE 10,72:PRINT SPC(3):GOTO 1156
1198       IF I.T%=3 THEN 1156
1200       IF I.T%=4 THEN 4000               'Fin Entrada.
1202       IF I.T%=2 AND I.A%=1 THEN 1206
1204       IF I.T%=2 THEN 1186
1206       IF COMPO$="M" OR COMPO$="R" OR COMPO$="B" OR COMPO$="E" THEN 1208
1207       GOTO 1186
1208       LOCATE 12,30:PRINT COMPO$
1209       LOCATE 20,3:PRINT STRING$(76," ")
1210       '******************************
1212       '***ENTRADA TAREAS          ***
1214       '******************************
1216       COLOR 12:LOCATE 20,2:PRINT "S = Siempre,   C = Casi Siempre,   A = A Veces,   P = Pocas Veces,   N = Nunca":COLOR 15
1217       F.C1%=12:C.C1%=67:L.E%=1:BO%=1:GOSUB 64000
1218       IF I.T%=0 THEN TAREA$=D.E$:GOTO 1236
1220       '
1222       IF I.T%=1 AND I.A%=1 THEN TAREA$=" ":GOTO 1236
1224       IF I.T%=1 AND I.A%=3 THEN TAREA$=NTARE1:GOTO 1236
1226       IF I.T%=3 AND I.A%=1 THEN LOCATE 12,30:PRINT SPC(1):GOTO 1186
1228       IF I.T%=3 THEN 1186
1230       IF I.T%=4 THEN 4000               'Fin Entrada.
1232       IF I.T%=2 AND I.A%=1 THEN 1236
1234       IF I.T%=2 THEN 1216
1236       IF TAREA$="S" OR TAREA$="A" OR TAREA$="N" OR TAREA$="C" OR TAREA$="P" THEN 1238
1237       GOTO 1216
1238       LOCATE 12,67:PRINT TAREA$
1239       LOCATE 20,2:PRINT STRING$(78," ")
1240       '******************************
1242       '***ENTRADA PUNTOS GRAMATICA***
1244       '******************************
1246       F.C1%=14:C.C1%=53:L.E%=3:BO%=3:ESC%=1:GOSUB 63000
1248       IF I.T%=0 THEN GRAME%=VAL(D.E$):GOTO 1266
1250       '
1252       IF I.T%=1 AND I.A%=1 THEN GRAME%=0:GOTO 1266
1254       IF I.T%=1 AND I.A%=3 THEN GRAME%=CVI(NGRE01):GOTO 1266
1256       IF I.T%=3 AND I.A%=1 THEN LOCATE 12,67:PRINT SPC(1):GOTO 1216
1258       IF I.T%=3 THEN 1216
1260       IF I.T%=4 THEN 4000               'Fin Entrada.
1262       IF I.T%=2 AND I.A%=1 THEN 1266
1264       IF I.T%=2 THEN 1246
1266       '
1268       LOCATE 14,53:PRINT USING "###";GRAME%
1269       '
1270       '******************************
1272       '***ENTRADA PUNTOS GRAMATICA***
1274       '******************************
1276       F.C1%=14:C.C1%=57:L.E%=3:BO%=3:ESC%=1:GOSUB 63000
1278       IF I.T%=0 THEN GRAMS%=VAL(D.E$):GOTO 1296
1280       '
1282       IF I.T%=1 AND I.A%=1 THEN GRAMS%=0:GOTO 1296
1284       IF I.T%=1 AND I.A%=3 THEN GRAMS%=CVI(NGRS01):GOTO 1296
1286       IF I.T%=3 AND I.A%=1 THEN LOCATE 14,53:PRINT SPC(3):GOTO 1246
1288       IF I.T%=3 THEN 1246
1290       IF I.T%=4 THEN 4000               'Fin Entrada.
1292       IF I.T%=2 AND I.A%=1 THEN 1296
1294       IF I.T%=2 THEN 1276
1296       '
1298       LOCATE 14,57:PRINT USING "###";GRAMS%
1299       '
1300       '******************************
1302       '***ENTRADA PUNTOS COMPRENSI***
1304       '******************************
1306       F.C1%=16:C.C1%=53:L.E%=3:BO%=3:ESC%=1:GOSUB 63000
1308       IF I.T%=0 THEN COMPR%=VAL(D.E$):GOTO 1326
1310       '
1312       IF I.T%=1 AND I.A%=1 THEN COMPR%=0:GOTO 1326
1314       IF I.T%=1 AND I.A%=3 THEN COMPR%=CVI(NEXE01):GOTO 1326
1316       IF I.T%=3 AND I.A%=1 THEN LOCATE 14,57:PRINT SPC(3):GOTO 1276
1318       IF I.T%=3 THEN 1276
1320       IF I.T%=4 THEN 4000               'Fin Entrada.
1322       IF I.T%=2 AND I.A%=1 THEN 1326
1324       IF I.T%=2 THEN 1306
1326       '
1328       LOCATE 16,53:PRINT USING "###";COMPR%
1329       '
1330       '******************************
1332       '***ENTRADA PUNTOS COMPRENSI***
1334       '******************************
1336       F.C1%=16:C.C1%=57:L.E%=3:BO%=3:ESC%=1:GOSUB 63000
1338       IF I.T%=0 THEN COMPS%=VAL(D.E$):GOTO 1356
1340       '
1342       IF I.T%=1 AND I.A%=1 THEN COMPS%=0:GOTO 1356
1344       IF I.T%=1 AND I.A%=3 THEN COMPS%=CVI(NEXS01):GOTO 1356
1346       IF I.T%=3 AND I.A%=1 THEN LOCATE 16,53:PRINT SPC(3):GOTO 1306
1348       IF I.T%=3 THEN 1306
1350       IF I.T%=4 THEN 4000               'Fin Entrada.
1352       IF I.T%=2 AND I.A%=1 THEN 1356
1354       IF I.T%=2 THEN 1336
1356       '
1358       LOCATE 16,57:PRINT USING "###";COMPS%
1359       '
1360       '******************************
1362       '***ENTRADA PUNTOS LITERATUR***
1364       '******************************
1366       F.C1%=18:C.C1%=53:L.E%=3:BO%=3:ESC%=1:GOSUB 63000
1368       IF I.T%=0 THEN LITER%=VAL(D.E$):GOTO 1386
1370       '
1372       IF I.T%=1 AND I.A%=1 THEN LITER%=0:GOTO 1386
1374       IF I.T%=1 AND I.A%=3 THEN LITER%=CVI(NLIE01):GOTO 1386
1376       IF I.T%=3 AND I.A%=1 THEN LOCATE 16,57:PRINT SPC(3):GOTO 1336
1378       IF I.T%=3 THEN 1336
1380       IF I.T%=4 THEN 4000               'Fin Entrada.
1382       IF I.T%=2 AND I.A%=1 THEN 1386
1384       IF I.T%=2 THEN 1366
1386       '
1388       LOCATE 18,53:PRINT USING "###";LITER%
1389       '
1390       '******************************
1392       '***ENTRADA PUNTOS LITERATUR***
1394       '******************************
1396       F.C1%=18:C.C1%=57:L.E%=3:BO%=3:ESC%=1:GOSUB 63000
1398       IF I.T%=0 THEN LITES%=VAL(D.E$):GOTO 1416
1400       '
1402       IF I.T%=1 AND I.A%=1 THEN LITES%=0:GOTO 1416
1404       IF I.T%=1 AND I.A%=3 THEN LITES%=CVI(NLIS01):GOTO 1416
1406       IF I.T%=3 AND I.A%=1 THEN LOCATE 18,53:PRINT SPC(3):GOTO 1366
1408       IF I.T%=3 THEN 1366
1410       IF I.T%=4 THEN 4000               'Fin Entrada.
1412       IF I.T%=2 AND I.A%=1 THEN 1416
1414       IF I.T%=2 THEN 1396
1416       '
1418       LOCATE 18,57:PRINT USING "###";LITES%
1419       '
2000   '*************************************
2002   '***PEDIMOS CONFORMIDAD A LOS DATOS***
2004   '*************************************
2006   GOSUB 8500
2008   COLOR 10:LOCATE 22,15:PRINT "Datos Correctos ";
2010   COLOR 15:PRINT " ENTER ";
2012   COLOR 10:PRINT " Datos Erroneos ";
2014   COLOR 15:PRINT " F1 "
2016   COLOR 10
2018   '
2020   A$=INPUT$(1)
2022   IF ASC(A$)<13 OR ASC(A$)>14 THEN BEEP:GOTO 2020
2024   '
2026   IF ASC(A$)=13 THEN 2042
2028   '
2030   '
2032   '
2034   GOTO 724
2042   '
2054   GET #6,REG%
2056   LSET NCOE11=MKI$(CONO1%):LSET NCOS11=MKI$(CONS1%)
2057   LSET NCOE12=MKI$(CONO2%):LSET NCOS12=MKI$(CONS2%)
2059   LSET NCOE13=MKI$(CONO3%):LSET NCOS13=MKI$(CONS3%)
2061   LSET NCOMP1=COMPO$:LSET NTARE1=TAREA$
2064   LSET NGRE01=MKI$(GRAME%):LSET NGRS01=MKI$(GRAMS%)
2065   LSET NEXE01=MKI$(COMPR%):LSET NEXS01=MKI$(COMPS%)
2066   LSET NLIE01=MKI$(LITER%):LSET NLIS01=MKI$(LITES%)
2098   '
2300   PUT #6,REG%
2302   IF I.A%=3 THEN CLOSE:GOTO 2511
2304   '
2306   GOTO 724
2500 '
2505 IF I.A%=3 THEN TIT$="- MODIFICAR NOTAS PRIMER TRIMESTRE -":GOTO 2511
2510 TIT$="- CONSULTAR NOTAS PRIMER TRIMESTRE -":GOTO 2511
2511 GOSUB 8000
2512 COLOR 10
2514 LOCATE 5,23:PRINT TIT$
2516 LOCATE 6,23:PRINT STRING$(LEN(TIT$),205)
2718 FALUDIR$="FACAALUM.ALF":FALUDAT$="FACAALUM.DAT"
2720 GOSUB 30000:GOSUB 32000
2724 COLOR 11:GOSUB 35000
2728 GOSUB 7650
2730       '*******************************
2732       '***ENTRADA NUMERO DE ALUMNO ***
2734       '*******************************
2736       COLOR 15
2738       F.C1%=8:C.C1%=20:L.E%=5:BO%=6:ESC%=1:GOSUB 63000
2740       IF I.T%=0 THEN CUENTA$=D.E$:GOTO 2758 'Entrada OK
2741       IF I.T%=4 THEN CLOSE:GOTO 300
2742       BEEP:LOCATE 8,20:PRINT SPC(6):GOTO 2732
2756       '
2758       REG%=VAL(CUENTA$)
2760      GUAPRI#=VAL(CUENTA$):N.D%=0:GOSUB 64770:LOCATE 8,25-L.C%:PRINT GUAPRI$
2762     ' GET #2,REG%  'BUSCAR REGISTRO
2764       IF REG%<2 OR REG%>ULTIMO% THEN GOSUB 8500:MEN$="Este N£mero de Alumno no existe, pulsar una tecla":GOSUB 8500:A$=INPUT$(1):GOTO 2724
2765       GET #2,REG%  'BUSCAR REGISTRO
2766       IF CMARCA="L" THEN GOSUB 8500:MEN$="Alumno dado de BAJA, pulsar una tecla":GOSUB 8500:A$=INPUT$(1):GOTO 2724
2768       NOM$=CNOMBRE:APE1$=CAPELL1:APE2$=CAPELL2:GOSUB 40000
2770       LOCATE 8,28:PRINT CUCUCU$
2774       GET #6,REG%
2780       LOCATE 10,18:PRINT USING "###/###";CVI(NCOE11);CVI(NCOS11)
2782       LOCATE 10,43:PRINT USING "###/###";CVI(NCOE12);CVI(NCOS12)
2784       LOCATE 10,68:PRINT USING "###/###";CVI(NCOE13);CVI(NCOS13)
2786       LOCATE 12,30:PRINT NCOMP1
2788       LOCATE 12,67:PRINT NTARE1
2790       LOCATE 14,53:PRINT USING "###/###";CVI(NGRE01);CVI(NGRS01)
2792       LOCATE 16,53:PRINT USING "###/###";CVI(NEXE01);CVI(NEXS01)
2794       LOCATE 18,53:PRINT USING "###/###";CVI(NLIE01);CVI(NLIS01)
2796       IF I.A%=3 THEN 1000
2800       GOSUB 8500:MEN$="Para otra Consulta pulsa una tecla":GOSUB 8500
2805       A$=INPUT$(1):CLOSE:GOTO 2500
4000 CLOSE:GOTO 300
4005 TIT$="- LISTAR CALIFICACIONES DEL PRIMER TIMESTRE -"
4010 GOSUB 32500
4011 GOSUB 8000
4012 COLOR 10
4014 LOCATE 5,18:PRINT TIT$
4016 LOCATE 6,18:PRINT STRING$(LEN(TIT$),205)
4018 COLOR 11:LOCATE 10,16:PRINT "Teclea Grupo a listar : <   >
4019      GOSUB 8500:MEN$=" Teclear 999 para finalizar el listado.":GOSUB 8500
4020       '**********************
4022       '***ENTRADA DEL GRUPO**
4024       '**********************
4026       COLOR 15:F.C1%=10:C.C1%=41:L.E%=3:BO%=3:GOSUB 63000
4028       IF I.T%=0 THEN GRU%=VAL(D.E$):GOTO 4032
4030       BEEP:GOTO 4026
4032       IF GRU%=999 THEN CLOSE:GOTO 300
4033       GET #4,GRU%:CURSO$=GCURSO:ESCUE$=GESCUE:NALU%=CVI(GALTAS)
4034       LOCATE 10,41:PRINT D.E$:LOCATE 10,46:PRINT CURSO$:DESDE%=-4
4036      COLOR 11:LOCATE 12,16:PRINT "Profesores del Curso .. <" SPACE$(30) ">"
4038      COLOR 15
4040      '**********************
4042      '***ENTRADA PROFES  ***
4044      '**********************
4046      F.C1%=12:C.C1%=41:L.E%=30:BO%=30:GOSUB 64000
4048      IF I.T%=0 THEN PROFE$=D.E$:GOTO 4052
4050      GOTO 4046
4052      '
4054      LOCATE 12,41:PRINT PROFE$
4056   '*************************************
4058   '***PEDIMOS CONFORMIDAD A LOS DATOS***
4060   '*************************************
4062   GOSUB 8500
4064   COLOR 10:LOCATE 22,15:PRINT "Datos Correctos ";
4066   COLOR 15:PRINT " ENTER ";
4068   COLOR 10:PRINT " Datos Erroneos ";
4070   COLOR 15:PRINT " F1 "
4072   COLOR 10
4074   '
4076   A$=INPUT$(1)
4078   IF ASC(A$)<13 OR ASC(A$)>14 THEN BEEP:GOTO 4076
4080   '
4082   IF ASC(A$)=13 THEN 4090
4084   LOCATE 10,2:PRINT SPC(78)
4086   LOCATE 12,2:PRINT SPC(78)
4088   CLOSE:GOTO 4000
4090   '
4095 FALUDIR$="FACAALUM.ALF":FALUDAT$="FACAALUM.DAT"
4100   GOSUB 30000:GOSUB 31500:GOSUB 32000
4102   WIDTH "LPT1:",80:OPEN "LPT1:" FOR OUTPUT AS #9
4103   LPRINT CHR$(27)+"&l0O"+CHR$(27)+"(s10h0B";
4105  'LPRINT CHR$(27) "C" CHR$(72);:LPRINT CHR$(18)
4110   FOR NN%=1 TO NALU%
4115   DESDE%=DESDE%+5
4120   GET #5,VAL(MID$(GALUS,DESDE%,5))
4125  'GET #5,245
4130  FAL%=CVI(AOCT)+CVI(ANOV)+CVI(ADIC)
4132  JAL%=CVI(JOCT)+CVI(JNOV)+CVI(JDIC)
4135  GET #2,VAL(MID$(GALUS,DESDE%,5))
4137  GET #6,VAL(MID$(GALUS,DESDE%,5))
4140  FE1#=VAL(FEDIA$):FE2#=VAL(CFENA):DIF#=FE1#-FE2#
4145  IF DIF#>199999! THEN NOM$=CNOMBRE:APE1$=CAPELL1:APE2$=CAPELL2:GOTO 4151
4150  NOM$="Sres.":APE1$=CAPELL1:APE2$=CAPELL2
4151  GOSUB 40000
4152  DESTI$=CUCUCU$
4155  NOM$=CPOBLA:APE1$="-":APE2$=CPROVI:GOSUB 40000
4157 PUEBLO$=CUCUCU$
4160  NOM$=CNOMBRE:APE1$=CAPELL1:APE2$=CAPELL2:GOSUB 40000
4165  ALUMNO$=CUCUCU$:LC%=LEN(ALUMNO$)
4175  FOR A%=1 TO 4:LPRINT:NEXT A%
4180  LPRINT TAB(11) "SCHOOL OF ENGLISH";:LPRINT TAB(45) LEFT$(DESTI$,35)
4185  LPRINT TAB(11) "GENARO ORAA N§ 6";:LPRINT TAB(45) LEFT$(CDIREC,35)
4190  LPRINT TAB(11) "SANTURCE - VIZCAYA";:LPRINT TAB(45) LEFT$(PUEBLO$,35)
4195  LPRINT TAB(11) "Telfono 4.93.70.05"
4200  FOR A%=1 TO 4:LPRINT:NEXT A%
4205  LPRINT TAB(23) "N O T A S    T R I M E S T R A L E S"
4210  LPRINT TAB(23) STRING$(36,205):LPRINT
4215  LPRINT TAB(7) "Nombre del Alumno : " ALUMNO$
4217  LPRINT TAB(7) "Curso ........... : " CURSO$
4219  LPRINT TAB(7) "Profesores ...... : " PROFE$:LPRINT
4222  LPRINT TAB(7) "                                   PRIMER.      SEGUNDO      TERCER. "
4224  LPRINT TAB(7) "      C O N C E P T O S           TRIMESTRE    TRIMESTRE    TRIMESTRE"
4225  LPRINT TAB(7) "------------------------------    ---------    ---------    ---------":LPRINT
4226  LPRINT TAB(7) "Faltas de asistencia .........";
4227  LPRINT TAB(46) USING "##";FAL%
4236  LPRINT TAB(7) "Faltas justificadas ..........";
4237  LPRINT TAB(46) USING "##";JAL%
4289  LPRINT
4290  LPRINT TAB(7) "Control n£mero 1 .............";
4292  IF CVI(NCOS11)=0 THEN 4300
4293 IF CVI(NCOS11)=999 AND CVI(NCOE11)=999 THEN LPRINT TAB(41) "NO PRESEN":GOTO 4300
4294  GUAPRI#=CVI(NCOE11)*100/CVI(NCOS11):N.D%=2:GOSUB 64770
4296  LPRINT TAB(47-L.C%) GUAPRI$ " %"
4300 'IF CVI(NCOS21)=0 THEN 4310
4302 'GUAPRI#=CVI(NCOE21)*100/CVI(NCOS21):N.D%=2:GOSUB 64770
4304 'LPRINT TAB(60-L.C%) GUAPRI$ " %";
4310 'IF CVI(NCOS31)=0 THEN 4320
4312 'GUAPRI#=CVI(NCOE31)*100/CVI(NCOS31):N.D%=2:GOSUB 64770
4314 'LPRINT TAB(73-L.C%) GUAPRI$ " %"
4320  LPRINT TAB(7) "Control n£mero 2 .............";
4322  IF CVI(NCOS12)=0 THEN 4330
4323 IF CVI(NCOS12)=999 AND CVI(NCOE12)=999 THEN LPRINT TAB(41) "NO PRESEN":GOTO 4330
4324  GUAPRI#=CVI(NCOE12)*100/CVI(NCOS12):N.D%=2:GOSUB 64770
4326  LPRINT TAB(47-L.C%) GUAPRI$ " %"
4330 'IF CVI(NCOS22)=0 THEN 4340
4332 'GUAPRI#=CVI(NCOE22)*100/CVI(NCOS22):N.D%=2:GOSUB 64770
4334 'LPRINT TAB(60-L.C%) GUAPRI$ " %";
4340 'IF CVI(NCOS32)=0 THEN 4350
4342 'GUAPRI#=CVI(NCOE32)*100/CVI(NCOS32):N.D%=2:GOSUB 64770
4344 'LPRINT TAB(73-L.C%) GUAPRI$ " %"
4350  IF ESCUE$="S" THEN LPRINT TAB(7) "Control n£mero 3 .............";:GOTO 4352
4351  LPRINT TAB(7) "EXAMEN FIN DE TRIMESTRE ......";
4352  IF CVI(NCOS13)=0 THEN 4360
4353 IF CVI(NCOS13)=999 AND CVI(NCOE13)=999 THEN LPRINT TAB(41) "NO PRESEN":GOTO 4360
4354  GUAPRI#=CVI(NCOE13)*100/CVI(NCOS13):N.D%=2:GOSUB 64770
4356  LPRINT TAB(47-L.C%) GUAPRI$ " %"
4360 'IF CVI(NCOS23)=0 THEN 4370
4362 'GUAPRI#=CVI(NCOE23)*100/CVI(NCOS23):N.D%=2:GOSUB 64770
4364 'LPRINT TAB(60-L.C%) GUAPRI$ " %";
4370 'IF CVI(NCOS33)=0 THEN 4380
4372 'GUAPRI#=CVI(NCOE33)*100/CVI(NCOS33):N.D%=2:GOSUB 64770
4374 'LPRINT TAB(73-L.C%) GUAPRI$ " %";
4380  LPRINT:LPRINT:LPRINT TAB(7) "Comportamiento ...............";
4382  IF NCOMP1="M" THEN LPRINT TAB(42) "Malo":GOTO 4390
4384  IF NCOMP1="R" THEN LPRINT TAB(42) "Regular":GOTO 4390
4386  IF NCOMP1="B" THEN LPRINT TAB(42) "Bueno":GOTO 4390
4388  IF NCOMP1="E" THEN LPRINT TAB(42) "Muy Bueno"
4389  LPRINT TAB(42) "         "
4390  IF ESCUE$="N" THEN 4500
4392  LPRINT TAB(7) "Realizaci¢n de Tareas ........";
4394  IF NTARE1="S" THEN LPRINT TAB(42) "Siempre":GOTO 4420
4395  IF NTARE1="C" THEN LPRINT TAB(42) "Casi Siempre":GOTO 4420
4396  IF NTARE1="A" THEN LPRINT TAB(42) "A veces":GOTO 4420
4397  IF NTARE1="P" THEN LPRINT TAB(42) "Pocas veces":GOTO 4420
4398  IF NTARE1="N" THEN LPRINT TAB(42) "Nunca":GOTO 4420
4399  LPRINT TAB(42) "     ":GOTO 4420
4400  '
4402  LPRINT
4403  LPRINT TAB(7) "De  0,00 %  a  49,99 %  ÄÄ>  Suspenso     "
4404  LPRINT TAB(7) "De 50,00 %  a  59,99 %  ÄÄ>  Apto         "
4405  LPRINT TAB(7) "De 60,00 %  a  69,99 %  ÄÄ>  Bien         "
4406  LPRINT TAB(7) "De 70,00 %  a  89,99 %  ÄÄ>  Notable      "
4407  LPRINT TAB(7) "De 90,00 %  a 100,00 %  ÄÄ>  Sobresaliente"
4408  LPRINT
4410  GOTO 4500
4420  LPRINT
4421  LPRINT TAB(7) "EXAMEN FIN DE TRIMESTRE"
4422  LPRINT TAB(7) "-----------------------"
4423  LPRINT TAB(7) "Gram tica y vocabulario ......";
4424  IF CVI(NGRS01)=0 THEN 4430
4425 IF CVI(NGRE01)=999 AND CVI(NGRS01)=999 THEN LPRINT TAB(41) "NO PRESEN":GOTO 4430
4426  GUAPRI#=CVI(NGRE01)*100/CVI(NGRS01):N.D%=2:GOSUB 64770
4427  LPRINT TAB(47-L.C%) GUAPRI$ " %"
4430 'IF CVI(NGRS02)=0 THEN 4440
4432 'GUAPRI#=CVI(NGRE02)*100/CVI(NGRS02):N.D%=2:GOSUB 64770
4434 'LPRINT TAB(60-L.C%) GUAPRI$ " %";
4440 'IF CVI(NGRS03)=0 THEN 4450
4442 'GUAPRI#=CVI(NGRE03)*100/CVI(NGRS03):N.D%=2:GOSUB 64770
4444 'LPRINT TAB(73-L.C%) GUAPRI$ " %"
4450  LPRINT TAB(7) "Comprensi¢n y expresi¡on oral.";
4452  IF CVI(NEXS01)=0 THEN 4460
4453 IF CVI(NEXE01)=999 AND CVI(NEXS01)=999 THEN LPRINT TAB(41) "NO PRESEN":GOTO 4460
4454  GUAPRI#=CVI(NEXE01)*100/CVI(NEXS01):N.D%=2:GOSUB 64770
4456  LPRINT TAB(47-L.C%) GUAPRI$ " %"
4460 'IF CVI(NEXS02)=0 THEN 4470
4462 'GUAPRI#=CVI(NEXE02)*100/CVI(NEXS02):N.D%=2:GOSUB 64770
4464 'LPRINT TAB(60-L.C%) GUAPRI$ " %";
4470 'IF CVI(NEXS03)=0 THEN 4480
4472 'GUAPRI#=CVI(NEXE03)*100/CVI(NEXS03):N.D%=2:GOSUB 64770
4474 'LPRINT TAB(73-L.C%) GUAPRI$ " %"
4480  LPRINT TAB(7) "Literatura y composici¢n .....";
4482  IF CVI(NLIS01)=0 THEN 4490
4483 IF CVI(NLIE01)=999 AND CVI(NLIS01)=999 THEN LPRINT TAB(39) "NO PRESEN":GOTO 4490
4484  GUAPRI#=CVI(NLIE01)*100/CVI(NLIS01):N.D%=2:GOSUB 64770
4486  LPRINT TAB(47-L.C%) GUAPRI$ " %"
4490 'IF CVI(NLIS02)=0 THEN 4495
4492 'GUAPRI#=CVI(NLIE02)*100/CVI(NLIS02):N.D%=2:GOSUB 64770
4494 'LPRINT TAB(60-L.C%) GUAPRI$ " %";
4495 'IF CVI(NLIS03)=0 THEN 4500
4496 'GUAPRI#=CVI(NLIE03)*100/CVI(NLIS03):N.D%=2:GOSUB 64770
4497 'LPRINT TAB(73-L.C%) GUAPRI$ " %"
4500  LPRINT
4502  LPRINT:LPRINT TAB(7) "Observaciones generales :":LPRINT
4504  LPRINT TAB(7) STRING$(69,196)
4506  LPRINT TAB(7) STRING$(69,196)
4508  LPRINT TAB(7) STRING$(69,196)
4510  LPRINT TAB(7) STRING$(69,196)
4512  LPRINT TAB(7) STRING$(69,196)
4514  LPRINT
4516  LPRINT TAB(51) "Firma de los padres"
4518  FOR A%=1 TO 3:LPRINT:NEXT A%
4520  LPRINT TAB(7) "Comentarios de los padres :":LPRINT
4522  LPRINT TAB(7) STRING$(69,196)
4524  LPRINT TAB(7) STRING$(69,196)
4526  LPRINT TAB(7) STRING$(69,196):LPRINT
4530  IF ESCUE$="N" THEN 4534
4531  IF LEFT$(GCURSO,5)="ADVAN" OR LEFT$(GCURSO,5)="FURTH" THEN LPRINT TAB(7) "Este centro considera que el nivel requerido para aprobar es un 65 %":GOTO 4545
4532  LPRINT TAB(7) "Este centro considera que el nivel requerido para aprobar es un 70 %":GOTO 4545
4534  LPRINT TAB(7) "De  0,00 %  a  49,99 %  ÄÄ>  Suspenso     "
4536  LPRINT TAB(7) "De 50,00 %  a  59,99 %  ÄÄ>  Apto         "
4538  LPRINT TAB(7) "De 60,00 %  a  69,99 %  ÄÄ>  Bien         "
4540  LPRINT TAB(7) "De 70,00 %  a  89,99 %  ÄÄ>  Notable      "
4542  LPRINT TAB(7) "De 90,00 %  a 100,00 %  ÄÄ>  Sobresaliente"
4545  LPRINT CHR$(12)
4547  NEXT NN%
4549 CLOSE
4550 GOTO 4000
7640 '**************************************************
7650 '***PRESENTAMOS MENSAJES TECLAS DE FUNCION ALTAS***
7660 '**************************************************
7670 GOSUB 8500:LOCATE 22,13
7672 COLOR 10:PRINT "ENTER =>";
7674 COLOR 15:PRINT " Saltar ";
7700 COLOR 10:PRINT " F7 =>";
7710 COLOR 15:PRINT " Fin Opci¢n.";
7720 COLOR 10:PRINT " F8 =>";
7730 COLOR 15:PRINT " Campo Atr s ";
7740 COLOR 10:PRINT " F10 =>";
7750 COLOR 15:PRINT " Dup."
7760 '
7770 RETURN
8000 '***********************************************
8010 '***  RUTINA PARA SACAR CARATULA EN PANTALLA ***
8020 '***********************************************
8030 '
8040 CLS:COLOR 10:LOCATE 1,1:PRINT CHR$(201)+STRING$(78,205)+CHR$(187)
8050 LOCATE 2,1:PRINT CHR$(186):COLOR 11:LOCATE 2,3:PRINT" " EMPRESA$" ":COLOR 10:LOCATE 2,33:PRINT "Aplicaci¢n : ACADEMIAS ":COLOR 11:LOCATE 2,61:PRINT "FECHA : "FECHA$" ":COLOR 10 : LOCATE 2,80 :PRINT CHR$(186)
8060 LOCATE 3,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
8070 FOR J%=4 TO 21 :LOCATE J%,1:PRINT CHR$(186):LOCATE J%,80 :PRINT CHR$(186):NEXT
8080 LOCATE 21,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
8090 LOCATE 22,1:PRINT CHR$(186):COLOR 11:LOCATE 22,3:PRINT "Mensajes: ":COLOR 10:LOCATE 22,80:PRINT CHR$(186)
8100 LOCATE 23,1:PRINT CHR$(200)+STRING$(78,205)+CHR$(188);
8110 COLOR 15:RETURN
8120 '
8250 '
8490 '*************************
8500 '***IMPRESION DE MENSAJES*
8510 '*************************
8515 '
8520 COLOR 10:L.L$="Mensajes: "+MEN$+"":LOCATE 22,3:PRINT L.L$;
8525 IF RET%=1 THEN FOR H=1 TO 7500:NEXT H:RET%=0
8530 MEN$=SPACE$(66)
8540 RETURN
8550 '
9000 '**********************
9010 '***FIN DEL PROGRAMA***
9020 '**********************
9030 CLOSE
9040 RUN "PACAFANO"
9050 END
9060 '
9070 '
9080 '
9090 '
9100 '*******************************
9110 '***RUTINA CONTROL DE ERRORES***
9120 '*******************************
9130 IF ERR=24 OR ERR=25 OR ERR=27 THEN GOSUB 8500:MEN$="--COMPRUEBE LA IMPRESORA Y PULSE UNA TECLA---":GOSUB 8500:A$=INPUT$(1):RESUME
9140 GOTO 9150
9142 GOSUB 8500:MEN$="Fichero FACAALUM.DIR inexistente":RET%=1:GOSUB 8500:CLOSE:GOTO 9000
9144 GOSUB 8500:MEN$="Fichero FACAALUM.DAT inexistente":RET%=1:GOSUB 8500:CLOSE:GOTO 9000
9150 '
9170 ON ERROR GOTO 0
9180 '
30000 '*******************************
30010 '***APERTURA FICHERO ALUMNOS ***
30020 '*******************************
30025 '
30052 OPEN "R",#1,FALUDIR$,65
30054 FIELD #1,2 AS FULTI,20 AS FLLAMA,20 AS FAPE1,20 AS FAPE2,2 AS FILER,1 AS FSTA
30056 GET #1,1
30058 ULTIAL%=CVI(FULTI)
30090 ' Apertura del fichero de datos   FACAALUM.DAT
30100 OPEN "R",#2,FALUDAT$,270
30110 FIELD #2,5 AS CCUENTA,1 AS CSTATUS,20 AS CNOMBRE,20 AS CAPELL1,20 AS CAPELL2,40 AS CDIREC,20 AS CPOBLA,15 AS CPROVI,5 AS CCOPOS,7 AS CTELEFO,7 AS CTELEFA,13 AS CDNI,3 AS CGRUPO
30112 FIELD #2,176 AS TODO1$,8 AS CFENA,4 AS CBANCO,4 AS CSUCUR,2 AS CDIGI,10 AS CCUBAN,8 AS CFALTA,8 AS CFBAJA,1 AS CCUESP,4 AS CIMPOR,1 AS CMARCA,1 AS CCONFI,20 AS COBSER,6 AS CFACT,17 AS CFILL
30114 FIELD #2,5 AS CCUEN1,1 AS CSTAT,2 AS CULTI,2 AS CULTACT,12 AS CFICHER,1 AS CSWG,1 AS CSWA,2 AS CVIGO,235 AS REST1$,6 AS CFEFAC,3 AS REST2$
30115 GET #2,1
30116 IF CFICHER<>"FACAALUM.DAT" THEN 9144
30117 ULTIMO%=CVI(CULTI)
30118 ULTACT%=CVI(CULTACT):N.R%=ULTACT%
30120 VIVAS%=CVI(CVIGO)
30140 RETURN
30150 '
31500 '********************************
31502 '***APERTURA FICHERO DE FALTAS***
31504 '********************************
31506 'FICHE1$="\"+ESTA$+"\FACAAUSE.DAT"
31508 '
31510 'APERTURA FICHERO DE DATOS.
31512 OPEN "R",#5,"FACAAUSE.DAT",48
31514 'REGISTRO DE DATOS.
31516 FIELD #5,2 AS AENE,2 AS AFEB,2 AS AMAR,2 AS AABR,2 AS AMAY,2 AS AJUN,2 AS AJUL,2 AS AAGO,2 AS ASET,2 AS AOCT,2 AS ANOV,2 AS ADIC
31517 '
31518 FIELD #5,24 AS JTOD,2 AS JENE,2 AS JFEB,2 AS JMAR,2 AS JABR,2 AS JMAY,2 AS JJUN,2 AS JJUL,2 AS JAGO,2 AS JSET,2 AS JOCT,2 AS JNOV,2 AS JDIC
31520 '
31587 RETURN
31588 '
31590 '
32000 '***APERTURA FICHERO DE NOTAS ***
32010 '********************************
32020 'FICHE1$="\"+ESTA$+"\FACANOTA.DAT"
32030 'DEFSTR N
32040 'APERTURA FICHERO DE DATOS.
32050 OPEN "R",#6,"FACANOTA.DAT",100
32060 'REGISTRO DE DATOS.
32070 FIELD #6,2 AS NCOE11,2 AS NCOS11,2 AS NCOE12,2 AS NCOS12,2 AS NCOE13,2 AS NCOS13
32080 FIELD #6,12 AS NRE001,2 AS NCOE21,2 AS NCOS21,2 AS NCOE22,2 AS NCOS22,2 AS NCOE23,2 AS NCOS23
32090 FIELD #6,24 AS NRE002,2 AS NCOE31,2 AS NCOS31,2 AS NCOE32,2 AS NCOS32,2 AS NCOE33,2 AS NCOS33
32100 FIELD #6,36 AS NRE003,2 AS NGRE01,2 AS NGRS01,2 AS NGRE02,2 AS NGRS02,2 AS NGRE03,2 AS NGRS03
32110 FIELD #6,48 AS NRE004,2 AS NEXE01,2 AS NEXS01,2 AS NEXE02,2 AS NEXS02,2 AS NEXE03,2 AS NEXS03
32120 FIELD #6,60 AS NRE005,2 AS NLIE01,2 AS NLIS01,2 AS NLIE02,2 AS NLIS02,2 AS NLIE03,2 AS NLIS03
32130 FIELD #6,72 AS NRE006,1 AS NCOMP1,1 AS NCOMP2,1 AS NCOMP3,1 AS NTARE1,1 AS NTARE2,1 AS NTARE3,22 AS NRE007
32140 '
32150 RETURN
32160 '
32500 '*******************************
32510 '***APERTURA FICHERO GRUPOS  ***
32520 '*******************************
32530 'Comprobamos la existencia del fichero.
32540 ' Apertura del fichero de datos   FACAGRUP.DAT
32550 OPEN "R",#4,"FACAGRUP.DAT",380
32560 FIELD #4,3 AS GGRUPO,1 AS GSTATUS,15 AS GCURSO,15 AS GTEXTO,2 AS GALUMNOS,2 AS GALTAS,2 AS GCONFIR,4 AS GCUOTA,8 AS GLUNESA,2 AS GPILUA,2 AS GAULUA,8 AS GMARTEA,2 AS GPIMAA,2 AS GAUMAA
32570 FIELD #4,68 AS GPRIP,8 AS GMIERCA,2 AS GPIMIA,2 AS GAUMIA,8 AS GJUEVEA,2 AS GPIJUA,2 AS GAUJUA,8 AS GVIERNA,2 AS GPIVIA,2 AS GAUVIA
32580 FIELD #4,104 AS GPRI1,8 AS GLUNESB,2 AS GPILUB,2 AS GAULUB,8 AS GMARTEB,2 AS GPIMAB,2 AS GAUMAB,8 AS GMIERCB,2 AS GPIMIB,2 AS GAUMIB,8 AS GJUEVEB,2 AS GPIJUB
32590 FIELD #4,150 AS GPRI2,2 AS GAUJUB,8 AS GVIERNB,2 AS GPIVIB,2 AS GAUVIB,1 AS GSB,1 AS GESCUE,14 AS GLIBR,200 AS GALUS
32600 FIELD #4,3 AS GLIBR1,1 AS GSTATUS,12 AS GETIQUETA,2 AS GULTIMO,162 AS GLIB2,200 AS GLIB2
32610 FIELD #4,180 AS GTODO,200 AS GALUS
32620 GET #4,1
32630 IF GETIQUETA="FACAGRUP.DAT" THEN 32650
32640 GOSUB 8500:MEN$="NO TENEMOS FICHERO DE GRUPOS, PULSAR UNA TECLA":GOSUB 8500:A$=INPUT$(1):GOTO 9000
32650 ULTGRU%=CVI(GULTIMO)
32660 RETURN
33000 '**********************************
33010 '***APERTURA FICHERO DATOS FIJOS***
33020 '**********************************
33030 OPEN "R",#1,"FDATFIJ.DAT",100
33040 FIELD #1,2 AS NRO$,8 AS NDIRE$,30 AS NEMPRESA$,15 AS NNIF$,8 AS NPROG$,37 AS NFILLER$
33050 GET #1,1
33052 NROEM$=NRO$
33060 DIRE$=NDIRE$
33070 EMPRESA$=NEMPRESA$
33080 NIF$=NNIF$
33082 PROGRAMA$=NPROG$
33090 CLOSE
33100 '
33110 '
33120 RETURN
33130 '
35000 '*********************************
35002 '*** PANTALLA DE DATOS A METER ***
35004 '*********************************
35006 COLOR 11:LOCATE 8,5:PRINT "Alumno N§.  : <      >" STRING$(50," ")
35008 LOCATE 10,5:PRINT "Control 1 : <   /   >"
35010 LOCATE 10,30:PRINT "Control 2 : <   /   >"
35012 LOCATE 10,55:PRINT "Control 3 : <   /   >"
35014 LOCATE 12,12:PRINT "Comportamiento : < >"
35016 LOCATE 12,42:PRINT "Realizacion de Tareas : < >"
35018 LOCATE 14,21:PRINT "Gram tica y vocabulario .... : <   /   >"
35020 LOCATE 16,21:PRINT "Comprensi¢n y expresi¢n oral : <   /   >"
35022 LOCATE 18,21:PRINT "Literatura y composici¢n ... : <   /   >"
35024 '
35026 RETURN
35028 '
40000 'Ponemos el Nombre y los dos Apellidos en una linea.
40010 NOMBRE$=""
40020 'Bucle del Nombre.
40030 LONG%=LEN(NOM$)
40040 FOR I%=LONG% TO 1 STEP -1
40050    IF MID$(NOM$,I%,1)<>" " THEN LNOMBRE%=I%:I%=0
40060 NEXT I%
40070 '
40080 'Bucle del Apellido 1.
40090 LONG%=LEN(APE1$)
40100 FOR I%=LONG% TO 1 STEP -1
40110    IF MID$(APE1$,I%,1)<>" " THEN LAPELL1%=I%:I%=0
40120 NEXT I%
40130 '
40140 'Bucle del Apellido 2.
40150 LONG%=LEN(APE2$)
40160 FOR I%=LONG% TO 1 STEP -1
40170    IF MID$(APE2$,I%,1)<>" " THEN LAPELL2%=I%:I%=0
40180 NEXT I%
40190 CUCUCU$=LEFT$(NOM$,LNOMBRE%)+" "+LEFT$(APE1$,LAPELL1%)+" "+LEFT$(APE2$,LAPELL2%)
40200 CUCUCU$=LEFT$(CUCUCU$,50)
40210 RETURN
40220 '
60000 '   +-------------------------------------------+
60010 '   +   SUBRUTINA de CONTROL DE FECHA LOGICA    +
60020 '   +-------------------------------------------+
60030 '   -  Recibe la fecha en formato DDMMAA sobre FECSUB$
60040 '   -  Devuelve sobre FEF$ la fecha en formato DD-MM-AA
60050 '   -  Utiliza ERF como Codigo de Retorno.0=fecha correcta,1=fecha erronea
60060 '-------------------------------------------------------------------------
60070 AA$=RIGHT$(FECSUB$,4):MM$=MID$(FECSUB$,3,2):DD$=LEFT$(FECSUB$,2)
60080 ANOMAX%=VAL(RIGHT$(DATE$,2))
60090 ANO%=VAL(AA$):MES%=VAL(MM$):DIA%=VAL(DD$):ERF%=0
60100 IF  (ANO% < 1900  OR ANO% > 2099 OR MES% < 1 OR MES% > 12) THEN 60140
60110 IF (ANO% MOD 4)= 0 THEN DIAS%(2)=29 ELSE DIAS%(2)=28
60120 IF (DIA% < 1 OR DIA% > DIAS%(MES%)) THEN 60140
60130 FDMA$=DD$+"-"+MM$+"-"+AA$:FAMD$=AA$+MM$+DD$:ERF%=0:RETURN 'Fecha Correcta
60140 ERF%=1:RETURN  'Fecha Incorrecta
60150 '-------------------------------------------------------------------------
60160 '
63000 '********************************
63010 '***RUTINA DE ENTRADA NUMERICA***
63020 '********************************
63030 '
63040 D.E$="":I.T%=0
63050 LOCATE F.C1%,C.C1%,1,0,6
63060 FOR JMG%=1 TO L.E%
63070  D.R$=INPUT$(1)
63075  IF ASC(D.R$)=14 AND JMG%=1 THEN JMG%=L.E%:I.T%=5:GOTO 63200  '===>AL NEXT
63080  IF ASC(D.R$)=13 AND JMG%=1 THEN JMG%=L.E%:I.T%=1:GOTO 63200  '===>AL NEXT
63090  IF ASC(D.R$)=13 THEN JMG%=L.E%:GOTO 63200  '===>AL NEXT
63100  IF ASC(D.R$)=10 THEN JMG%=L.E%:I.T%=2:GOTO 63200  '===>AL NEXT
63110  IF ASC(D.R$)=9 THEN JMG%=L.E%:I.T%=3:GOTO 63200   '===>AL NEXT
63120  IF ASC(D.R$)=7 THEN JMG%=L.E%:I.T%=4:GOTO 63200   '===>AL NEXT
63130  IF JMG%=1 THEN LOCATE F.C1%,C.C1%:PRINT STRING$(BO%,"-"):LOCATE F.C1%,C.C1%
63140  IF D.R$<"0" OR D.R$>"9" THEN 63170               'Error
63150  D.E$=D.E$+D.R$:PRINT D.R$;
63160  GOTO 63200 'AL NEXT
63170  'Error.
63175  IF ASC(D.R$)=8 AND JMG%=1 THEN 63190
63180  IF ASC(D.R$)=8 THEN LOCATE F.C1%,C.C1%+LEN(D.E$)-1:PRINT "-":LOCATE F.C1%,C.C1%+LEN(D.E$)-1:D.E$=LEFT$(D.E$,LEN(D.E$)-1):JMG%=JMG%-1
63190  JMG%=JMG%-1
63200 NEXT JMG%
63210 IF I.T%<>0 THEN 63230
63220 IF LEN(D.E$)<>L.E% THEN D.E$=LEFT$(CERO$,L.E%-LEN(D.E$))+D.E$
63225 LOCATE F.C1%,C.C1%:PRINT STRING$(BO%," ")
63230 RETURN
63240 '
64000 '*************************************
64010 '***RUTINA DE ENTRADA ALFA/NUMERICA***
64020 '*************************************
64030 '
64040 D.E$="":I.T%=0
64050 LOCATE F.C1%,C.C1%,1,0,6
64060 FOR JMG%=1 TO L.E%
64070  D.R$=INPUT$(1)
64075  IF ASC(D.R$)=14 AND JMG%=1 THEN JMG%=L.E%:I.T%=5:GOTO 64200  '===>AL NEXT
64080  IF ASC(D.R$)=13 AND JMG%=1 THEN JMG%=L.E%:I.T%=1:GOTO 64200  '===>AL NEXT
64090  IF ASC(D.R$)=13 THEN JMG%=L.E%:GOTO 64200  '===>AL NEXT
64100  IF ASC(D.R$)=10 THEN JMG%=L.E%:I.T%=2:GOTO 64200  '===>AL NEXT
64110  IF ASC(D.R$)=9 THEN JMG%=L.E%:I.T%=3:GOTO 64200   '===>AL NEXT
64120  IF ASC(D.R$)=7 THEN JMG%=L.E%:I.T%=4:GOTO 64200   '===>AL NEXT
64130  IF JMG%=1 THEN LOCATE F.C1%,C.C1%:PRINT STRING$(BO%," "):LOCATE F.C1%,C.C1%
64135  IF ASC(D.R$)=34 THEN 64170
64140  IF ASC(D.R$)<32 OR ASC(D.R$)>126 THEN 64170               'Error
64150  D.E$=D.E$+D.R$:PRINT D.R$;
64160  GOTO 64200 'AL NEXT
64170  'Error.
64172  IF D.R$="¥" OR D.R$="¤" THEN 64150
64175  IF ASC(D.R$)=8 AND JMG%=1 THEN 64190
64180  IF ASC(D.R$)=8 THEN LOCATE F.C1%,C.C1%+LEN(D.E$)-1:PRINT " ":LOCATE F.C1%,C.C1%+LEN(D.E$)-1:D.E$=LEFT$(D.E$,LEN(D.E$)-1):JMG%=JMG%-1
64190  JMG%=JMG%-1
64200 NEXT JMG%
64210 IF I.T%<>0 THEN 64230
64220 'D.E$=D.E$+LEFT$(BLANCO$,L.E%-LEN(D.E$))
64225 'LOCATE F.C1%,C.C1%:PRINT D.E$
64230 RETURN
64240 '
64760 '========================================================================
64762 ' RUTINA PARA EDITAR IMPORTES EN CRISTIANO X.XXX.XXX,XX                 =
64764 '                                                                       =
64766 ' SE ENTRARA A ESTA RUTINA DE LA FORMA  SIGUIENTE:                      =
64768 '                                                                       =
64770 ' GOSUB 64760 MANDANDO EN UN CAMPO LLAMADO GUAPRI#,                     =
64772 '                                                                       =
64773 '             LA CANTIDAD O NUMERO QUE DESEEMOS EDITAR.                 =
64774 '                                                                       =
64775 '             Y EN UN CAMPO LLAMADO N.D% EL NUMERO DE DECIMALES         =
64776 '                                                                       =
64778 ' DEVOLVERA EL CAMPO EDITADO EN GUAPRI$ Y LA LONGITUD EN L.C%           =
64780 '                                                                       =
64782 '========================================================================
64784 '
64786 '
64788 GUAPRI$=STR$(GUAPRI#):L.P%=0     ':N.D%=0
64790 FOR I%=1 TO 30:TABENT$(I%)="":NEXT I%
64792 SIGNO$=LEFT$(GUAPRI$,1):GUAPRI$=RIGHT$(GUAPRI$,LEN(GUAPRI$)-1)
64794 FOR I%=1 TO LEN(GUAPRI$)
64796   IF MID$(GUAPRI$,I%,1)="." THEN L.P%=I%:I%=LEN(GUAPRI$)
64798 NEXT I%
64800 IF L.P%=0 THEN GUAPRI$=GUAPRI$+".000":GOTO 64794
64802 IF N.D%=0 THEN DEC$="":GOTO 64808
64804 DEC$=","+MID$(GUAPRI$,L.P%+1,N.D%)
64806 IF LEN(DEC$)<>N.D%+1 THEN DEC$=DEC$+LEFT$(CERO$,N.D%+1-LEN(DEC$))
64808 ENT$=LEFT$(GUAPRI$,L.P%-1)
64810 IF LEN(ENT$)=0 THEN GUAPRI$="0":GOTO 64834
64812 X%=31
64814 FOR I%=LEN(ENT$) TO 1 STEP -1
64816   X%=X%-1
64818   IF X%=27 OR X%=23 OR X%=19 OR X%=15 OR X%=12 THEN TABENT$(X%)=".":X%=X%-1
64820   TABENT$(X%)=MID$(ENT$,I%,1)
64822 NEXT I%
64824 GUAPRI$=""
64826 FOR I%=1 TO 30
64828   IF TABENT$(I%)="" THEN 64832
64830   GUAPRI$=GUAPRI$+TABENT$(I%)
64832 NEXT I%
64833 IF SIGNO$=" " THEN GUAPRI$=GUAPRI$+DEC$:L.C%=LEN(GUAPRI$)-1:RETURN
64834 GUAPRI$=GUAPRI$+DEC$+SIGNO$:L.C%=LEN(GUAPRI$)-1
64835 N.D%=0
64836 RETURN
64838 '
