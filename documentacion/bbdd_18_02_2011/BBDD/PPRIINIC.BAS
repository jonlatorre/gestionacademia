10 '                       PACAINIC.BAS
20 '                      --------------
30 '       GESTION MENU GENERAL DE ACTIVOS FINANCIEROS
40 '       -------------------------------------------
50 '
52 ON ERROR GOTO 160
54 '
56 '
100 GOSUB 33000     'LEER DATOS COMUNES
130 FECHA$=MID$(DATE$,4,3)+LEFT$(DATE$,3)+RIGHT$(DATE$,2)
150 OPTION BASE 1
160 '******************************
165 '***TRATAMIENTO DEL PROGRAMA***
170 '******************************
175 GOSUB 8000
180 COLOR 10
190 LOCATE 4,20:PRINT "- MENU GENERAL DE GESTION DE ACADEMIAS -"
195 LOCATE 5,20:PRINT STRING$(42,205)
200 LOCATE 7,9:PRINT " - GESTION DE FICHEROS -"
202 LOCATE 7,41: PRINT CHR$(186)
204 LOCATE 7,49: PRINT "    - V A R I O S -"
206 LOCATE 8,9:PRINT STRING$(25,205)
208 LOCATE 8,41: PRINT CHR$(186)
210 LOCATE 8,49:PRINT STRING$(23,205)
224 LOCATE 9,9:PRINT "Fichero de Alumnos."
226 LOCATE 9,41:PRINT CHR$(186)
228 LOCATE 9,49:PRINT "Final del trabajo diario."
236 LOCATE 10,9:PRINT "Fichero de Grupos."
238 LOCATE 10,41:PRINT CHR$(186)
240 LOCATE 10,49:PRINT "Proceso de Facturaci¢n. "
245 LOCATE 11,9:PRINT "Fichero de Bancos.   "
246 LOCATE 11,41:PRINT CHR$(186)
248 LOCATE 11,49:PRINT "Escuela Idiomas INGLES."
254 LOCATE 12,9:PRINT "Fichero de Calendario. "
256 LOCATE 12,41:PRINT CHR$(186)
258 LOCATE 12,49:PRINT "Escuela Idiomas FRANCES."
263 LOCATE 13,9:PRINT "Fichero de Notas y Ausencias."
264 LOCATE 13,41:PRINT CHR$(186)
266 LOCATE 13,49:PRINT "Escuela Idiomas ALEMAN.      "
270 LOCATE 14,9:PRINT "Fichero de Empresas."
272 LOCATE 14,41:PRINT CHR$(186)
274 LOCATE 14,49:PRINT "Escuela de TURISMO."
276 LOCATE 15,9:PRINT "Fichero de Biblioteca."
278 LOCATE 15,41:PRINT CHR$(186)
280 LOCATE 15,49:PRINT "                   "
282 LOCATE 16,9:PRINT "Fichero de Direcciones."
284 LOCATE 16,41:PRINT CHR$(186)
286 LOCATE 16,49:PRINT "                   "
372 LOCATE 19,35:COLOR 15:PRINT " ESC "+CHR$(205)+CHR$(205)+CHR$(16)+" Fin ":COLOR 10
400 GOSUB 8500
410 LOCATE 22,15:PRINT "Seleccione Opci¢n con las Flechas y Pulse la Tecla ";
420 COLOR 15
425 PRINT CHR$(17)+CHR$(196)+CHR$(217)
430 COLOR 10
440 '
450 FILA%=9:COLUMNA%=5:OPCIONES%=8
460 GOSUB 20000
465 IF ATRAS%=1 THEN 450
470 IF I.A%>OPCIONES% THEN 500
480 ON I.A% GOTO 1000,1010,1020,1130,1170,1180,1040,1050
490 '
500 FILA%=9:COLUMNA%=45:OPCIONES%=6
510 GOSUB 20000
515 IF ATRAS%=1 THEN 450
520 IF I.A%>OPCIONES% THEN 600
530 ON I.A% GOTO 1110,1030,1140,1150,1160,1190
540 '
600 '
640 '
700 GOTO 450
800  '*********************************************************
810  '*** DISTRIBUCION GENERAL DE PROGRAMAS DE CONTABILIDAD ***
820  '*********************************************************
830  '
1000 RUN "PACACLIE"      'GESTION DE ALUMNOS
1010 RUN "PACAGRUP"      'GESTION DE GRUPOSS
1020 RUN "PACABANC"      'GESTION DE BANCOS
1030 RUN "PACADISF"      'PROCESO DE FACTURACION
1040 RUN "PBIBLIOT"      'PROCESO BIBLIOTECA
1050 RUN "PDIRCLIE"      'PROCESO DIRECCIONES
1110 RUN "PACAFDIA"        'RESTAURAR FICHEROS DIA SIGUIENTE
1120 '
1125 GOTO 160
1130 RUN "PACACALE"       'ACTUALIZAR FICHERO CALENDARIO
1140 RUN "PACAESCU"     'ESCUELA IDIOMAS INGLES
1150 RUN "PACAESFR"     'ESCUELA IDIOMAS FRANCES
1160 RUN "PACAESAL"     'ESCUELA IDIOMAS ALEMAN
1170 RUN "PACAFANO"     'ACTUALIZAR FICHERO DE NOTAS-AUSENCIAS
1180 RUN "PEMPCLIE"     'ACTUALIZAR FICHERO DE EMPRESAS
1190 RUN "PTURINIC"     'ESCUELA DE TURISMO
8000 '***********************************************
8010 '***  RUTINA PARA SACAR CARATULA EN PANTALLA ***
8020 '***********************************************
8030 '
8040 CLS:COLOR 10:LOCATE 1,1:PRINT CHR$(201)+STRING$(78,205)+CHR$(187)
8050 LOCATE 2,1:PRINT CHR$(186):COLOR 11:LOCATE 2,3:PRINT" " EMPRESA$" ":COLOR 10:LOCATE 2,34:PRINT "Aplicaci¢n : ACADEMIAS ":COLOR 11:LOCATE 2,63:PRINT "FECHA : "FECHA$" ":COLOR 10 : LOCATE 2,80 :PRINT CHR$(186)
8060 LOCATE 3,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
8070 FOR J%=4 TO 21 :LOCATE J%,1:PRINT CHR$(186):LOCATE J%,80 :PRINT CHR$(186):NEXT
8080 LOCATE 21,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
8090 LOCATE 22,1:PRINT CHR$(186):COLOR 11:LOCATE 22,3:PRINT "Mensajes: ":COLOR 10:LOCATE 22,80:PRINT CHR$(186)
8100 LOCATE 23,1:PRINT CHR$(200)+STRING$(78,205)+CHR$(188);
8110 COLOR 7,0,0:RETURN
8120 '
8250 '
8490 '*************************
8500 '***IMPRESION DE MENSAJES*
8510 '*************************
8515 '
8520 COLOR 10:L.L$=""+MEN$+"":LOCATE 22,15:PRINT L.L$;
8525 IF RET%=1 THEN FOR H=1 TO 1500:NEXT H:RET%=0
8530 MEN$=SPACE$(64)
8540 RETURN
8550 '
9000 '**********************
9010 '***FIN DEL PROGRAMA***
9020 '**********************
9030 CLS
9040 SYSTEM
9060 '
9070 '
9080 '
9090 '
20000 '********************************************
20010 '*** RATONCITO PARA SELECCIONAR OPCIONES  ***
20020 '********************************************
20030 '***                                      ***
20040 '*** FILA%=FILA DONDE APARECERA EL RATON  ***
20050 '***                                      ***
20060 '*** COLUMNA%=COLUMNA DONDE APARECERA EL  ***
20070 '***          RATON                       ***
20080 '***                                      ***
20090 '*** OPCIONES%=NUMERO DE OPCIONES         ***
20100 '***                                      ***
20110 '*** CON ESC SALE A LA SENTENCIA 9000     ***
20120 '***                                      ***
20130 '********************************************
20140 '
20150 R$=CHR$(0):ATRAS%=0
20160 FOR I.A%=1 TO OPCIONES%
20170 COLOR 15:LOCATE FILA%,COLUMNA%:PRINT CHR$(205)+CHR$(205)+CHR$(16)
20180 COLOR 10:R$=INKEY$:IF R$="" THEN 20180
20190 IF ASC(R$)=27 THEN 9000
20200 IF R$=CHR$(0)+CHR$(80) THEN R$=CHR$(31)
20210 IF R$=CHR$(0)+CHR$(72) THEN R$=CHR$(30)
20220 IF R$="2" THEN R$=CHR$(31)
20230 IF R$="8" THEN R$=CHR$(30)
20240 IF ASC(R$)=13 OR ASC(R$)=30 OR ASC(R$)=31 THEN 20250  ELSE 20180
20250 IF ASC(R$)=13 THEN RETURN
20260 LOCATE FILA%,COLUMNA%:PRINT "   "
20270 IF ASC(R$)=30 AND I.A%=1 THEN ATRAS%=1:RETURN
20280 IF ASC(R$)=30 THEN FILA%=FILA%-1:I.A%=I.A%-1:GOTO 20170 'AL NEXT
20290 FILA%=FILA%+1
20300 NEXT I.A%
20310 RETURN
20320 'ESTO SE ACABA
20330 '
33000 '**********************************
33010 '***APERTURA FICHERO DATOS FIJOS***
33020 '**********************************
33030 OPEN "R",#1,"FDATFIJ.DAT",100
33040 FIELD #1,2 AS NRO$,8 AS NDIRE$,30 AS NEMPRESA$,15 AS NNIF$,8 AS NPROG$,37 AS NFILLER$
33050 GET #1,1
33052 NROEM$=NRO$
33060 DIRE$=NDIRE$
33070 EMPRESA$=NEMPRESA$
33080 NIF$=NNIF$
33082 PROGRAMA$=NPROG$
33090 CLOSE
33100 '
33110 '
33120 RETURN
33130 '
