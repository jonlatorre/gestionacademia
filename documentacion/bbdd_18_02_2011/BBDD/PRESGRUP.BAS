10 '                       PRESGRUP.BAS
20 '                      --------------
30 '              GESTION DE GRUPOS DE HOSTELERIA
40 '              -------------------------------
50 '
60 ON ERROR GOTO 9100
70 GOSUB 33000
80 KEY 1,CHR$(14):KEY 7,CHR$(7):KEY 8,CHR$(9):KEY 10,CHR$(10)
90 CERO$=STRING$(15,"0")
110 '
120 '
132 FECHA$=MID$(DATE$,4,3)+LEFT$(DATE$,3)+RIGHT$(DATE$,2)
140 DEFSTR G,S,C,F
150 OPTION BASE 1
160 DIM TABRUT$(6),DIAS%(12),TABENT$(30)
170 '
180 DATA "     ALTAS DE GRUPOS     "
190 DATA "     BAJAS DE GRUPOS     "
200 DATA "  MODIFICACION DE GRUPOS "
210 DATA "    CONSULTA DE GRUPOS   "
220 DATA "    INFORMES DE GRUPOS   "
222 DATA "     FIN DEL PROGRAMA    "
250 '
260 FOR I%=1 TO 6
270    READ TABRUT$(I%)
280 NEXT I%
290 '
292 DATA 31,28,31,30,31,30,31,31,30,31,30,31
294 FOR I%=1 TO 12
296    READ DIAS%(I%)
298 NEXT I%
300 '*********************************
302 '***PRESENTAMOS EL MENU GENERAL***
304 '*********************************
306 TIT$="- MENU DE GESTION DE GRUPOS -"
308 X%=80-LEN(TIT$):X%=INT(X%/2)
310 GOSUB 8000
312 LOCATE 4,X%:PRINT TIT$
314 LOCATE 5,X%:PRINT STRING$(LEN(TIT$),205)
316 LOCATE 7,26:PRINT "1.- ALTAS DE GRUPOS."
318 LOCATE 8,26:PRINT "2.- BAJAS DE GRUPOS."
320 LOCATE 9,26:PRINT "3.- MODIFICACION DE GRUPOS."
322 LOCATE 10,26:PRINT "4.- CONSULTA DE GRUPOS."
324 LOCATE 11,26:PRINT "5.- INFORMES DE GRUPOS."
326 LOCATE 12,26:PRINT "6.- No se usa."
328 LOCATE 13,26:PRINT "7.- No se usa."
330 LOCATE 14,26:PRINT "8.- No se usa."
332 LOCATE 15,26:PRINT "9.- No se usa."
334 LOCATE 16,25:PRINT "10.- No se usa."
336 LOCATE 17,25:PRINT "11.- No se usa."
338 LOCATE 19,24:COLOR 12:PRINT " ESC ";
340 COLOR 15:PRINT " Finalizar ";
342 COLOR 11:PRINT " OPCION : <  > "
344 '
346 'PEDIMOS OPCION.
348 F.C1%=19:C.C1%=51:L.E%=2:L.D%=0:NEG%=0:BO%=2:GOSUB 63000
350 IF I.T%=4 THEN COLOR 15:GOTO 9000
352 IF I.T%<>0 THEN 348
354 COLOR 15
356 I.A%=VAL(D.E$)
358 IF I.A%<1 OR I.A%>11 THEN 338
360 ON I.A% GOTO 510,2660,2660,2660,4080,302,302,302,302,302,302
362 '
364 '
366 '
500 '*************************
510 '***TRATAMIENTO DE ALTA***
520 '*************************
522 GOSUB 8500:MEN$="Espere Por Favor...":GOSUB 8500
530 GOSUB 32000        'Apertura Fichero de GRUPOS
550 TIT$=TABRUT$(I.A%)
560 GOSUB 8000
570 '
580 GOSUB 31000
590 '
600 '
610 '
615 GOSUB 7650
620 '
630       '*************************************
640       '***ENTRADA NUMERO DE GRUPO        ***
650       '*************************************
660       COLOR 15        'Presentamos Mensaje Teclas de Funcion.
670       GET #6,1:N.ORDEN%=ULTGRU%+1
680       GRUPO$=STR$(N.ORDEN%):LN%=LEN(GRUPO$)-1
690       GRUPO$=LEFT$(CERO$,3-LN%)+RIGHT$(GRUPO$,LN%)
700       IF N.ORDEN%<900 THEN 720
710       GOSUB 8500:MEN$="TENEMOS MUCHOS GRUPOS, PULSAR UNA TECLA":GOSUB 8500:A$=INPUT$(1)
720       LOCATE 6,15:PRINT USING"###";N.ORDEN%:LSET GGRUPO=GRUPO$
730       '
750       '***********************
752       '***ENTRADA ESCUELA  ***
754       '***********************
756     ' F.C1%=4:C.C1%=77:L.E%=1:BO%=1:GOSUB 64000
758     ' IF I.T%=0 THEN ESCUE$=D.E$:LSET GESCUE=ESCUE$:GOTO 774
760     ' IF I.T%=1 AND I.A%=1 THEN 756
762     ' IF I.T%=1 AND I.A%=3 THEN ESCUE$=GESCUE:GOTO 774
764     ' IF I.T%=3 THEN 750
766     ' IF I.T%=4 THEN 4000               'Fin Entrada.
768     ' IF I.T%=2 AND I.A%=1 THEN LSET GESCUE=ESCUE$:GOTO 774
770     ' IF I.T%=2 THEN 756
772     ' '
774     ' IF ESCUE$="S" OR ESCUE$="N" THEN 778
775     ' GOTO 750
776     ' '
778     ' LOCATE 4,77:PRINT ESCUE$
850       '***********************
852       '***ENTRADA CURSO    ***
854       '***********************
856       F.C1%=6:C.C1%=33:L.E%=1:BO%=1:GOSUB 63000
858       IF I.T%=0 THEN CURSO$=D.E$:LSET GCURSO=CURSO$:GOTO 874
860       IF I.T%=1 AND I.A%=1 THEN 856
862       IF I.T%=1 AND I.A%=3 THEN CURSO$=GCURSO:GOTO 874
864       IF I.T%=3 THEN 850
866       IF I.T%=4 THEN 4000               'Fin Entrada.
868       IF I.T%=2 AND I.A%=1 THEN LSET GCURSO=CURSO$:GOTO 874
870       IF I.T%=2 THEN 856
872       '
874       LOCATE 6,33:PRINT CURSO$
876       '
880       '***********************
890       '***ENTRADA TEXTO    ***
900       '***********************
910       F.C1%=6:C.C1%=49:L.E%=29:BO%=29:GOSUB 64000
920       IF I.T%=0 THEN TEXTO$=D.E$:LSET GTEXTO=TEXTO$:GOTO 1000
930       IF I.T%=1 AND I.A%=1 THEN TEXTO$="":LSET GTEXTO=TEXTO$:GOTO 1000
940       IF I.T%=1 AND I.A%=3 THEN TEXTO$=GTEXTO:GOTO 1000
945       IF I.T%=3 AND I.A%=1 THEN LOCATE 6,33:PRINT SPC(1):GOTO 850
950       IF I.T%=3 THEN 850
960       IF I.T%=4 THEN 4000               'Fin Entrada.
970       IF I.T%=2 AND I.A%=1 THEN LSET GTEXTO=TEXTO$:GOTO 1000
980       IF I.T%=2 THEN 890
990       '
1000       LOCATE 6,49:PRINT TEXTO$
1010       '
1020       '***********************
1030       '***ENTRADA CUOTA     **
1040       '***********************
1050     ' F.C1%=8:C.C1%=13:L.E%=5:BO%=6:ESC%=1:GOSUB 63000
1060     ' IF I.T%=0 THEN CUOTA#=VAL(D.E$):LSET GCUOTA=MKS$(CUOTA#):GOTO 1140
1070     ' IF I.T%=1 AND I.A%=1 THEN 1050
1080     ' IF I.T%=1 AND I.A%=3 THEN CUOTA#=CVS(GCUOTA):GOTO 1140
1085     ' IF I.T%=3 AND I.A%=1 THEN LOCATE 6,63:PRINT SPC(15):GOTO 910
1090     ' IF I.T%=3 THEN 910
1100      'IF I.T%=4 THEN 4000               'Fin Entrada.
1110      'IF I.T%=2 AND I.A%=1 THEN LSET GCUOTA=MKS$(CUOTA#):GOTO 1140
1120      'IF I.T%=2 THEN 1050
1130      ''
1140      'GUAPRI#=CUOTA#:GOSUB 64770:LOCATE 8,18-L.C%:PRINT GUAPRI$
1150      ''
1440      ''***********************
1450       '***ENTRADA  ALUMNOS  **
1460       '***********************
1470       F.C1%=8:C.C1%=36:L.E%=2:BO%=2:ESC%=1:GOSUB 63000
1480       IF I.T%=0 THEN ALUMN%=VAL(D.E$):LSET GALUMNOS=MKI$(ALUMN%):GOTO 1560
1490       IF I.T%=1 AND I.A%=1 THEN 1470
1500       IF I.T%=1 AND I.A%=3 THEN ALUMN%=CVI(GALUMNOS):GOTO 1560
1505       IF I.T%=3 AND I.A%=1 THEN LOCATE 8,13:PRINT SPC(6):GOTO 910
1510       IF I.T%=3 THEN 910
1520       IF I.T%=4 THEN 4000               'Fin Entrada.
1530       IF I.T%=2 AND I.A%=1 THEN LSET GALUMNOS=MKI$(ALUMN%):GOTO 1560
1540       IF I.T%=2 THEN 1470
1550       '
1560       LOCATE 8,36:PRINT USING"##";ALUMN%
1570       '
1600       '***********************
1602       '***HORARIO  LUNES-A  **
1604       '***********************
1606       F.C1%=16:C.C1%=18:L.E%=8:BO%=12:ESC%=0:GOSUB 63000
1608       IF I.T%=0 THEN ENTR1A$=D.E$:LSET GLUNESA=ENTR1A$:GOTO 1626
1610       IF I.T%=1 AND I.A%=1 THEN ENTR1A$="":LSET GLUNESA=ENTR1A$:GOTO 1690
1612       IF I.T%=1 AND I.A%=3 THEN ENTR1A$=GLUNESA:GOTO 1630
1614       IF I.T%=3 AND I.A%=1 THEN LOCATE 8,36:PRINT SPC(2):GOTO 1470
1616       IF I.T%=3 THEN 1470
1618       IF I.T%=4 THEN 4000               'Fin Entrada.
1620       IF I.T%=2 AND I.A%=1 THEN LSET GLUNESA=ENTR1A$:GOTO 1626
1622       IF I.T%=2 THEN 1606
1624       '
1626       IF VAL(ENTR1A$)=0 THEN LSET GLUNESA="        ":GOTO 1690
1627       LOCATE 16,18:PRINT LEFT$(ENTR1A$,2)"-"MID$(ENTR1A$,3,2)" "MID$(ENTR1A$,5,2)"-"RIGHT$(ENTR1A$,2)
1628       '
1630       '***********************
1632       '***ENTRADA PISO LU-A **
1634       '***********************
1636       F.C1%=16:C.C1%=31:L.E%=2:BO%=2:ESC%=1:GOSUB 64000
1638       IF I.T%=0 THEN PILUA$=D.E$:LSET GPILUA=PILUA$:GOTO 1656
1640       IF I.T%=1 AND I.A%=1 THEN PILUA$="":LSET GPILUA=PILUA$:GOTO 1656
1642       IF I.T%=1 AND I.A%=3 THEN PILUA$=GPILUA:GOTO 1660
1644       IF I.T%=3 AND I.A%=1 THEN LOCATE 16,18:PRINT SPC(12):GOTO 1606
1646       IF I.T%=3 THEN 1606
1648       IF I.T%=4 THEN 4000               'Fin Entrada.
1650       IF I.T%=2 AND I.A%=1 THEN LSET GPILUA=PILUA$:GOTO 1656
1652       IF I.T%=2 THEN 1636
1654       '
1656       LOCATE 16,31:PRINT PILUA$
1658       '
1660       '***********************
1662       '***ENTRADA AULA      **
1664       '***********************
1666       F.C1%=16:C.C1%=36:L.E%=2:BO%=2:ESC%=1:GOSUB 63000
1668       IF I.T%=0 THEN AULUA$=D.E$:LSET GAULUA=AULUA$:GOTO 1686
1670       IF I.T%=1 AND I.A%=1 THEN AULUA$="":LSET GAULUA=AULUA$:GOTO 1686
1672       IF I.T%=1 AND I.A%=3 THEN AULUA$=GAULUA:GOTO 1690
1674       IF I.T%=3 AND I.A%=1 THEN LOCATE 16,31:PRINT SPC(2):GOTO 1636
1676       IF I.T%=3 THEN 1636
1678       IF I.T%=4 THEN 4000               'Fin Entrada.
1680       IF I.T%=2 AND I.A%=1 THEN LSET GAULUA=AULUA$:GOTO 1686
1682       IF I.T%=2 THEN 1666
1684       '
1686       LOCATE 16,36:PRINT USING"##";VAL(AULUA$)
1688       '
1690       '***********************
1692       '***HORARIO  MARTES   **
1694       '***********************
1696       F.C1%=17:C.C1%=18:L.E%=8:BO%=12:ESC%=0:GOSUB 63000
1698       IF I.T%=0 THEN ENTR2A$=D.E$:LSET GMARTEA=ENTR2A$:GOTO 1716
1700       IF I.T%=1 AND I.A%=1 THEN ENTR2A$="":LSET GMARTEA=ENTR2A$:GOTO 1780
1702       IF I.T%=1 AND I.A%=3 THEN ENTR2A$=GMARTEA:GOTO 1720
1704       IF I.T%=3 AND I.A%=1 THEN LOCATE 16,36:PRINT SPC(2):GOTO 1666
1706       IF I.T%=3 THEN 1666
1708       IF I.T%=4 THEN 4000               'Fin Entrada.
1710       IF I.T%=2 AND I.A%=1 THEN LSET GMARTEA=ENTR2A$:GOTO 1716
1712       IF I.T%=2 THEN 1696
1714       '
1716       IF VAL(ENTR2A$)=0 THEN LSET GMARTEA="        ":GOTO 1780
1717       LOCATE 17,18:PRINT LEFT$(ENTR2A$,2)"-"MID$(ENTR2A$,3,2)" "MID$(ENTR2A$,5,2)"-"RIGHT$(ENTR2A$,2)
1718       '
1720       '***********************
1722       '***ENTRADA PISO MA-A **
1724       '***********************
1726       F.C1%=17:C.C1%=31:L.E%=2:BO%=2:ESC%=1:GOSUB 64000
1728       IF I.T%=0 THEN PIMAA$=D.E$:LSET GPIMAA=PIMAA$:GOTO 1746
1730       IF I.T%=1 AND I.A%=1 THEN PIMAA$="":LSET GPIMAA=PIMAA$:GOTO 1746
1732       IF I.T%=1 AND I.A%=3 THEN PIMAA$=GPIMAA:GOTO 1750
1734       IF I.T%=3 AND I.A%=1 THEN LOCATE 17,18:PRINT SPC(12):GOTO 1696
1736       IF I.T%=3 THEN 1696
1738       IF I.T%=4 THEN 4000               'Fin Entrada.
1740       IF I.T%=2 AND I.A%=1 THEN LSET GPIMAA=PIMAA$:GOTO 1746
1742       IF I.T%=2 THEN 1726
1744       '
1746       LOCATE 17,31:PRINT PIMAA$
1748       '
1750       '***********************
1752       '***ENTRADA AULA MART-A*
1754       '***********************
1756       F.C1%=17:C.C1%=36:L.E%=2:BO%=2:ESC%=1:GOSUB 63000
1758       IF I.T%=0 THEN AUMAA$=D.E$:LSET GAUMAA=AUMAA$:GOTO 1776
1760       IF I.T%=1 AND I.A%=1 THEN AUMAA$="":LSET GAUMAA=AUMAA$:GOTO 1776
1762       IF I.T%=1 AND I.A%=3 THEN AUMAA$=GAUMAA:GOTO 1780
1764       IF I.T%=3 AND I.A%=1 THEN LOCATE 17,31:PRINT SPC(2):GOTO 1726
1766       IF I.T%=3 THEN 1726
1768       IF I.T%=4 THEN 4000               'Fin Entrada.
1770       IF I.T%=2 AND I.A%=1 THEN LSET GAUMAA=AUMAA$:GOTO 1776
1772       IF I.T%=2 THEN 1756
1774       '
1776       LOCATE 17,36:PRINT USING"##";VAL(AUMAA$)
1778       '
1780       '***********************
1782       '***HORARIO  MIERCOLES**
1784       '***********************
1786       F.C1%=18:C.C1%=18:L.E%=8:BO%=12:ESC%=0:GOSUB 63000
1788       IF I.T%=0 THEN ENTR3A$=D.E$:LSET GMIERCA=ENTR3A$:GOTO 1806
1790       IF I.T%=1 AND I.A%=1 THEN ENTR3A$="":LSET GMIERCA=ENTR3A$:GOTO 1870
1792       IF I.T%=1 AND I.A%=3 THEN ENTR3A$=GMIERCA:GOTO 1810
1794       IF I.T%=3 AND I.A%=1 THEN LOCATE 17,36:PRINT SPC(2):GOTO 1756
1796       IF I.T%=3 THEN 1756
1798       IF I.T%=4 THEN 4000               'Fin Entrada.
1800       IF I.T%=2 AND I.A%=1 THEN LSET GMIERCA=ENTR3A$:GOTO 1806
1802       IF I.T%=2 THEN 1786
1804       '
1806       IF VAL(ENTR3A$)=0 THEN LSET GMIERCA="        ":GOTO 1870
1807       LOCATE 18,18:PRINT LEFT$(ENTR3A$,2)"-"MID$(ENTR3A$,3,2)" "MID$(ENTR3A$,5,2)"-"RIGHT$(ENTR3A$,2)
1808       '
1810       '***********************
1812       '***ENTRADA PISO MIE-A**
1814       '***********************
1816       F.C1%=18:C.C1%=31:L.E%=2:BO%=2:ESC%=1:GOSUB 64000
1818       IF I.T%=0 THEN PIMIA$=D.E$:LSET GPIMIA=PIMIA$:GOTO 1836
1820       IF I.T%=1 AND I.A%=1 THEN PIMIA$="":LSET GPIMIA=PIMIA$:GOTO 1836
1822       IF I.T%=1 AND I.A%=3 THEN PIMIA$=GPIMIA:GOTO 1840
1824       IF I.T%=3 AND I.A%=1 THEN LOCATE 18,18:PRINT SPC(12):GOTO 1786
1826       IF I.T%=3 THEN 1786
1828       IF I.T%=4 THEN 4000               'Fin Entrada.
1830       IF I.T%=2 AND I.A%=1 THEN LSET GPIMIA=PIMIA$:GOTO 1836
1832       IF I.T%=2 THEN 1816
1834       '
1836       LOCATE 18,31:PRINT PIMIA$
1838       '
1840       '***********************
1842       '***ENTRADA AULA MIE-A**
1844       '***********************
1846       F.C1%=18:C.C1%=36:L.E%=2:BO%=2:ESC%=1:GOSUB 63000
1848       IF I.T%=0 THEN AUMIA$=D.E$:LSET GAUMIA=AUMIA$:GOTO 1866
1850       IF I.T%=1 AND I.A%=1 THEN AUMIA$="":LSET GAUMIA=AUMIA$:GOTO 1866
1852       IF I.T%=1 AND I.A%=3 THEN AUMIA$=GAUMIA:GOTO 1870
1854       IF I.T%=3 AND I.A%=1 THEN LOCATE 18,31:PRINT SPC(2):GOTO 1816
1856       IF I.T%=3 THEN 1816
1858       IF I.T%=4 THEN 4000               'Fin Entrada.
1860       IF I.T%=2 AND I.A%=1 THEN LSET GAUMIA=AUMIA$:GOTO 1866
1862       IF I.T%=2 THEN 1846
1864       '
1866       LOCATE 18,36:PRINT USING"##";VAL(AUMIA$)
1868       '
1870       '***********************
1872       '***HORARIO  JUEVES-A***
1874       '***********************
1876       F.C1%=19:C.C1%=18:L.E%=8:BO%=12:ESC%=0:GOSUB 63000
1878       IF I.T%=0 THEN ENTR4A$=D.E$:LSET GJUEVEA=ENTR4A$:GOTO 1896
1880       IF I.T%=1 AND I.A%=1 THEN ENTR4A$="":LSET GJUEVEA=ENTR4A$:GOTO 1960
1882       IF I.T%=1 AND I.A%=3 THEN ENTR4A$=GJUEVEA:GOTO 1900
1884       IF I.T%=3 AND I.A%=1 THEN LOCATE 18,36:PRINT SPC(2):GOTO 1846
1886       IF I.T%=3 THEN 1846
1888       IF I.T%=4 THEN 4000               'Fin Entrada.
1890       IF I.T%=2 AND I.A%=1 THEN LSET GJUEVEA=ENTR4A$:GOTO 1896
1892       IF I.T%=2 THEN 1876
1894       '
1896       IF VAL(ENTR4A$)=0 THEN LSET GJUEVEA="        ":GOTO 1960
1897       LOCATE 19,18:PRINT LEFT$(ENTR4A$,2)"-"MID$(ENTR4A$,3,2)" "MID$(ENTR4A$,5,2)"-"RIGHT$(ENTR4A$,2)
1898       '
1900       '***********************
1902       '***ENTRADA PISO JUEV-A*
1904       '***********************
1906       F.C1%=19:C.C1%=31:L.E%=2:BO%=2:ESC%=1:GOSUB 64000
1908       IF I.T%=0 THEN PIJUA$=D.E$:LSET GPIJUA=PIJUA$:GOTO 1926
1910       IF I.T%=1 AND I.A%=1 THEN PIJUA$="":LSET GPIJUA=PIJUA$:GOTO 1926
1912       IF I.T%=1 AND I.A%=3 THEN PIJUA$=GPIJUA:GOTO 1930
1914       IF I.T%=3 AND I.A%=1 THEN LOCATE 19,18:PRINT SPC(12):GOTO 1876
1916       IF I.T%=3 THEN 1876
1918       IF I.T%=4 THEN 4000               'Fin Entrada.
1920       IF I.T%=2 AND I.A%=1 THEN LSET GPIJUA=PIJUA$:GOTO 1926
1922       IF I.T%=2 THEN 1906
1924       '
1926       LOCATE 19,31:PRINT PIJUA$
1928       '
1930       '***********************
1932       '***ENTRADA AULA JUEV-A*
1934       '***********************
1936       F.C1%=19:C.C1%=36:L.E%=2:BO%=2:ESC%=1:GOSUB 63000
1938       IF I.T%=0 THEN AUJUA$=D.E$:LSET GAUJUA=AUJUA$:GOTO 1956
1940       IF I.T%=1 AND I.A%=1 THEN AUJUA$="":LSET GAUJUA=AUJUA$:GOTO 1956
1942       IF I.T%=1 AND I.A%=3 THEN AUJUA$=GAUJUA:GOTO 1960
1944       IF I.T%=3 AND I.A%=1 THEN LOCATE 19,31:PRINT SPC(2):GOTO 1906
1946       IF I.T%=3 THEN 1906
1948       IF I.T%=4 THEN 4000               'Fin Entrada.
1950       IF I.T%=2 AND I.A%=1 THEN LSET GAUJUA=AUJUA$:GOTO 1956
1952       IF I.T%=2 THEN 1936
1954       '
1956       LOCATE 19,36:PRINT USING"##";VAL(AUJUA$)
1958       '
1960       '***********************
1962       '***HORARIO  VIERNES-A**
1964       '***********************
1966       F.C1%=20:C.C1%=18:L.E%=8:BO%=12:ESC%=0:GOSUB 63000
1968       IF I.T%=0 THEN ENTR5A$=D.E$:LSET GVIERNA=ENTR5A$:GOTO 1986
1970       IF I.T%=1 AND I.A%=1 THEN ENTR5A$="":LSET GVIERNA=ENTR5A$:GOTO 2050
1972       IF I.T%=1 AND I.A%=3 THEN ENTR5A$=GVIERNA:GOTO 1990
1974       IF I.T%=3 AND I.A%=1 THEN LOCATE 19,36:PRINT SPC(2):GOTO 1936
1976       IF I.T%=3 THEN 1936
1978       IF I.T%=4 THEN 4000               'Fin Entrada.
1980       IF I.T%=2 AND I.A%=1 THEN LSET GVIERNA=ENTR5A$:GOTO 1986
1982       IF I.T%=2 THEN 1966
1984       '
1986       IF VAL(ENTR5A$)=0 THEN LSET GVIERNA="        ":GOTO 2050
1987       LOCATE 20,18:PRINT LEFT$(ENTR5A$,2)"-"MID$(ENTR5A$,3,2)" "MID$(ENTR5A$,5,2)"-"RIGHT$(ENTR5A$,2)
1988       '
1990       '***********************
1992       '***ENTRADA PISO VIE-A**
1994       '***********************
1996       F.C1%=20:C.C1%=31:L.E%=2:BO%=2:ESC%=1:GOSUB 64000
1998       IF I.T%=0 THEN PIVIA$=D.E$:LSET GPIVIA=PIVIA$:GOTO 2016
2000       IF I.T%=1 AND I.A%=1 THEN PIVIA$="":LSET GPIVIA=PIVIA$:GOTO 2016
2002       IF I.T%=1 AND I.A%=3 THEN PIVIA$=GPIVIA:GOTO 2020
2004       IF I.T%=3 AND I.A%=1 THEN LOCATE 20,18:PRINT SPC(12):GOTO 1966
2006       IF I.T%=3 THEN 1966
2008       IF I.T%=4 THEN 4000               'Fin Entrada.
2010       IF I.T%=2 AND I.A%=1 THEN LSET GPIVIA=PIVIA$:GOTO 2016
2012       IF I.T%=2 THEN 1996
2014       '
2016       LOCATE 20,31:PRINT PIVIA$
2018       '
2020       '***********************
2022       '***ENTRADA AULA VIE-A**
2024       '***********************
2026       F.C1%=20:C.C1%=36:L.E%=2:BO%=2:ESC%=1:GOSUB 63000
2028       IF I.T%=0 THEN AUVIA$=D.E$:LSET GAUVIA=AUVIA$:GOTO 2046
2030       IF I.T%=1 AND I.A%=1 THEN AUVIA$="":LSET GAUVIA=AUVIA$:GOTO 2046
2032       IF I.T%=1 AND I.A%=3 THEN AUVIA$=GAUVIA:GOTO 2050
2034       IF I.T%=3 AND I.A%=1 THEN LOCATE 20,31:PRINT SPC(2):GOTO 1996
2036       IF I.T%=3 THEN 1996
2038       IF I.T%=4 THEN 4000               'Fin Entrada.
2040       IF I.T%=2 AND I.A%=1 THEN LSET GAUVIA=AUVIA$:GOTO 2046
2042       IF I.T%=2 THEN 2026
2044       '
2046       LOCATE 20,36:PRINT USING"##";VAL(AUVIA$)
2048       '
2050       '***********************
2052       '***HORARIO  LUNES-A  **
2054       '***********************
2056       F.C1%=16:C.C1%=57:L.E%=8:BO%=12:ESC%=0:GOSUB 63000
2058       IF I.T%=0 THEN ENTR1B$=D.E$:LSET GLUNESB=ENTR1B$:GOTO 2076
2060       IF I.T%=1 AND I.A%=1 THEN ENTR1B$="":LSET GLUNESB=ENTR1B$:GOTO 2140
2062       IF I.T%=1 AND I.A%=3 THEN ENTR1B$=GLUNESB:GOTO 2080
2064       IF I.T%=3 AND I.A%=1 THEN LOCATE 20,36:PRINT SPC(2):GOTO 2026
2066       IF I.T%=3 THEN 2026
2068       IF I.T%=4 THEN 4000               'Fin Entrada.
2070       IF I.T%=2 AND I.A%=1 THEN LSET GLUNESB=ENTR1B$:GOTO 2076
2072       IF I.T%=2 THEN 2056
2074       '
2076       IF VAL(ENTR1B$)=0 THEN LSET GLUNESB="        ":GOTO 2140
2077       B$="1":LOCATE 16,57:PRINT LEFT$(ENTR1B$,2)"-"MID$(ENTR1B$,3,2)" "MID$(ENTR1B$,5,2)"-"RIGHT$(ENTR1B$,2)
2078       '
2080       '***********************
2082       '***ENTRADA PISO LU-A **
2084       '***********************
2086       F.C1%=16:C.C1%=70:L.E%=2:BO%=2:ESC%=1:GOSUB 64000
2088       IF I.T%=0 THEN PILUB$=D.E$:LSET GPILUB=PILUB$:GOTO 2106
2090       IF I.T%=1 AND I.A%=1 THEN PILUB$="":LSET GPILUB=PILUB$:GOTO 2106
2092       IF I.T%=1 AND I.A%=3 THEN PILUB$=GPILUB:GOTO 2110
2094       IF I.T%=3 AND I.A%=1 THEN LOCATE 16,57:PRINT SPC(12):GOTO 2056
2096       IF I.T%=3 THEN 2056
2098       IF I.T%=4 THEN 4000               'Fin Entrada.
2100       IF I.T%=2 AND I.A%=1 THEN LSET GPILUB=PILUB$:GOTO 2106
2102       IF I.T%=2 THEN 2086
2104       '
2106       LOCATE 16,70:PRINT PILUB$
2108       '
2110       '***********************
2112       '***ENTRADA AULA      **
2114       '***********************
2116       F.C1%=16:C.C1%=75:L.E%=2:BO%=2:ESC%=1:GOSUB 63000
2118       IF I.T%=0 THEN AULUB$=D.E$:LSET GAULUB=AULUB$:GOTO 2136
2120       IF I.T%=1 AND I.A%=1 THEN AULUB$="":LSET GAULUB=AULUB$:GOTO 2136
2122       IF I.T%=1 AND I.A%=3 THEN AULUB$=GAULUB:GOTO 2140
2124       IF I.T%=3 AND I.A%=1 THEN LOCATE 16,70:PRINT SPC(2):GOTO 2086
2126       IF I.T%=3 THEN 2086
2128       IF I.T%=4 THEN 4000               'Fin Entrada.
2130       IF I.T%=2 AND I.A%=1 THEN LSET GAULUB=AULUB$:GOTO 2136
2132       IF I.T%=2 THEN 2116
2134       '
2136       LOCATE 16,75:PRINT USING"##";VAL(AULUB$)
2138       '
2140       '***********************
2142       '***HORARIO  MARTES   **
2144       '***********************
2146       F.C1%=17:C.C1%=57:L.E%=8:BO%=12:ESC%=0:GOSUB 63000
2148       IF I.T%=0 THEN ENTR2B$=D.E$:LSET GMARTEB=ENTR2B$:GOTO 2166
2150       IF I.T%=1 AND I.A%=1 THEN ENTR2B$="":LSET GMARTEB=ENTR2B$:GOTO 2230
2152       IF I.T%=1 AND I.A%=3 THEN ENTR2B$=GMARTEB:GOTO 2170
2154       IF I.T%=3 AND I.A%=1 THEN LOCATE 16,75:PRINT SPC(2):GOTO 2116
2156       IF I.T%=3 THEN 2116
2158       IF I.T%=4 THEN 4000               'Fin Entrada.
2160       IF I.T%=2 AND I.A%=1 THEN LSET GMARTEB=ENTR2B$:GOTO 2166
2162       IF I.T%=2 THEN 2146
2164       '
2166       IF VAL(ENTR2B$)=0 THEN LSET GMARTEB="        ":GOTO 2230
2167       B$="1":LOCATE 17,57:PRINT LEFT$(ENTR2B$,2)"-"MID$(ENTR2B$,3,2)" "MID$(ENTR2B$,5,2)"-"RIGHT$(ENTR2B$,2)
2168       '
2170       '***********************
2172       '***ENTRADA PISO MA-A **
2174       '***********************
2176       F.C1%=17:C.C1%=70:L.E%=2:BO%=2:ESC%=1:GOSUB 64000
2178       IF I.T%=0 THEN PIMAB$=D.E$:LSET GPIMAB=PIMAB$:GOTO 2196
2180       IF I.T%=1 AND I.A%=1 THEN PIMAB$="":LSET GPIMAB=PIMAB$:GOTO 2196
2182       IF I.T%=1 AND I.A%=3 THEN PIMAB$=GPIMAB:GOTO 2200
2184       IF I.T%=3 AND I.A%=1 THEN LOCATE 17,57:PRINT SPC(12):GOTO 2146
2186       IF I.T%=3 THEN 2146
2188       IF I.T%=4 THEN 4000               'Fin Entrada.
2190       IF I.T%=2 AND I.A%=1 THEN LSET GPIMAB=PIMAB$:GOTO 2196
2192       IF I.T%=2 THEN 2176
2194       '
2196       LOCATE 17,70:PRINT PIMAB$
2198       '
2200       '***********************
2202       '***ENTRADA AULA MART-A*
2204       '***********************
2206       F.C1%=17:C.C1%=75:L.E%=2:BO%=2:ESC%=1:GOSUB 63000
2208       IF I.T%=0 THEN AUMAB$=D.E$:LSET GAUMAB=AUMAB$:GOTO 2226
2210       IF I.T%=1 AND I.A%=1 THEN AUMAB$="":LSET GAUMAB=AUMAB$:GOTO 2226
2212       IF I.T%=1 AND I.A%=3 THEN AUMAB$=GAUMAB:GOTO 2230
2214       IF I.T%=3 AND I.A%=1 THEN LOCATE 17,70:PRINT SPC(2):GOTO 2176
2216       IF I.T%=3 THEN 2176
2218       IF I.T%=4 THEN 4000               'Fin Entrada.
2220       IF I.T%=2 AND I.A%=1 THEN LSET GAUMAB=AUMAB$:GOTO 2226
2222       IF I.T%=2 THEN 2206
2224       '
2226       LOCATE 17,75:PRINT USING"##";VAL(AUMAB$)
2228       '
2230       '***********************
2232       '***HORARIO  MIERCOLES**
2234       '***********************
2236       F.C1%=18:C.C1%=57:L.E%=8:BO%=12:ESC%=0:GOSUB 63000
2238       IF I.T%=0 THEN ENTR3B$=D.E$:LSET GMIERCB=ENTR3B$:GOTO 2256
2240       IF I.T%=1 AND I.A%=1 THEN ENTR3B$="":LSET GMIERCB=ENTR3B$:GOTO 2320
2242       IF I.T%=1 AND I.A%=3 THEN ENTR3B$=GMIERCB:GOTO 2260
2244       IF I.T%=3 AND I.A%=1 THEN LOCATE 17,75:PRINT SPC(2):GOTO 2206
2246       IF I.T%=3 THEN 2206
2248       IF I.T%=4 THEN 4000               'Fin Entrada.
2250       IF I.T%=2 AND I.A%=1 THEN LSET GMIERCB=ENTR3B$:GOTO 2256
2252       IF I.T%=2 THEN 2236
2254       '
2256       IF VAL(ENTR3B$)=0 THEN LSET GMIERCB="        ":GOTO 2320
2257       B$="1":LOCATE 18,57:PRINT LEFT$(ENTR3B$,2)"-"MID$(ENTR3B$,3,2)" "MID$(ENTR3B$,5,2)"-"RIGHT$(ENTR3B$,2)
2258       '
2260       '***********************
2262       '***ENTRADA PISO MIE-A**
2264       '***********************
2266       F.C1%=18:C.C1%=70:L.E%=2:BO%=2:ESC%=1:GOSUB 64000
2268       IF I.T%=0 THEN PIMIB$=D.E$:LSET GPIMIB=PIMIB$:GOTO 2286
2270       IF I.T%=1 AND I.A%=1 THEN PIMIB$="":LSET GPIMIB=PIMIB$:GOTO 2286
2272       IF I.T%=1 AND I.A%=3 THEN PIMIB$=GPIMIB:GOTO 2290
2274       IF I.T%=3 AND I.A%=1 THEN LOCATE 18,57:PRINT SPC(12):GOTO 2236
2276       IF I.T%=3 THEN 2236
2278       IF I.T%=4 THEN 4000               'Fin Entrada.
2280       IF I.T%=2 AND I.A%=1 THEN LSET GPIMIB=PIMIB$:GOTO 2286
2282       IF I.T%=2 THEN 2266
2284       '
2286       LOCATE 18,70:PRINT PIMIB$
2288       '
2290       '***********************
2292       '***ENTRADA AULA MIE-A**
2294       '***********************
2296       F.C1%=18:C.C1%=75:L.E%=2:BO%=2:ESC%=1:GOSUB 63000
2298       IF I.T%=0 THEN AUMIB$=D.E$:LSET GAUMIB=AUMIB$:GOTO 2316
2300       IF I.T%=1 AND I.A%=1 THEN AUMIB$="":LSET GAUMIB=AUMIB$:GOTO 2316
2302       IF I.T%=1 AND I.A%=3 THEN AUMIB$=GAUMIB:GOTO 2320
2304       IF I.T%=3 AND I.A%=1 THEN LOCATE 18,70:PRINT SPC(2):GOTO 2266
2306       IF I.T%=3 THEN 2266
2308       IF I.T%=4 THEN 4000               'Fin Entrada.
2310       IF I.T%=2 AND I.A%=1 THEN LSET GAUMIB=AUMIB$:GOTO 2316
2312       IF I.T%=2 THEN 2296
2314       '
2316       LOCATE 18,75:PRINT USING"##";VAL(AUMIB$)
2318       '
2320       '***********************
2322       '***HORARIO  JUEVES-A***
2324       '***********************
2326       F.C1%=19:C.C1%=57:L.E%=8:BO%=12:ESC%=0:GOSUB 63000
2328       IF I.T%=0 THEN ENTR4B$=D.E$:LSET GJUEVEB=ENTR4B$:GOTO 2346
2330       IF I.T%=1 AND I.A%=1 THEN ENTR4B$="":LSET GJUEVEB=ENTR4B$:GOTO 2410
2332       IF I.T%=1 AND I.A%=3 THEN ENTR4B$=GJUEVEB:GOTO 2350
2334       IF I.T%=3 AND I.A%=1 THEN LOCATE 18,75:PRINT SPC(2):GOTO 2296
2336       IF I.T%=3 THEN 2296
2338       IF I.T%=4 THEN 4000               'Fin Entrada.
2340       IF I.T%=2 AND I.A%=1 THEN LSET GJUEVEB=ENTR4B$:GOTO 2346
2342       IF I.T%=2 THEN 2326
2344       '
2346       IF VAL(ENTR4B$)=0 THEN LSET GJUEVEB="        ":GOTO 2410
2347       B$="1":LOCATE 19,57:PRINT LEFT$(ENTR4B$,2)"-"MID$(ENTR4B$,3,2)" "MID$(ENTR4B$,5,2)"-"RIGHT$(ENTR4B$,2)
2348       '
2350       '***********************
2352       '***ENTRADA PISO JUEV-A*
2354       '***********************
2356       F.C1%=19:C.C1%=70:L.E%=2:BO%=2:ESC%=1:GOSUB 64000
2358       IF I.T%=0 THEN PIJUB$=D.E$:LSET GPIJUB=PIJUB$:GOTO 2376
2360       IF I.T%=1 AND I.A%=1 THEN PIJUB$="":LSET GPIJUB=PIJUB$:GOTO 2376
2362       IF I.T%=1 AND I.A%=3 THEN PIJUB$=GPIJUB:GOTO 2380
2364       IF I.T%=3 AND I.A%=1 THEN LOCATE 19,57:PRINT SPC(12):GOTO 2326
2366       IF I.T%=3 THEN 2326
2368       IF I.T%=4 THEN 4000               'Fin Entrada.
2370       IF I.T%=2 AND I.A%=1 THEN LSET GPIJUB=PIJUB$:GOTO 2376
2372       IF I.T%=2 THEN 2356
2374       '
2376       LOCATE 19,70:PRINT PIJUB$
2378       '
2380       '***********************
2382       '***ENTRADA AULA JUEV-A*
2384       '***********************
2386       F.C1%=19:C.C1%=75:L.E%=2:BO%=2:ESC%=1:GOSUB 63000
2388       IF I.T%=0 THEN AUJUB$=D.E$:LSET GAUJUB=AUJUB$:GOTO 2406
2390       IF I.T%=1 AND I.A%=1 THEN AUJUB$="":LSET GAUJUB=AUJUB$:GOTO 2406
2392       IF I.T%=1 AND I.A%=3 THEN AUJUB$=GAUJUB:GOTO 2410
2394       IF I.T%=3 AND I.A%=1 THEN LOCATE 19,70:PRINT SPC(2):GOTO 2356
2396       IF I.T%=3 THEN 2356
2398       IF I.T%=4 THEN 4000               'Fin Entrada.
2400       IF I.T%=2 AND I.A%=1 THEN LSET GAUJUB=AUJUB$:GOTO 2406
2402       IF I.T%=2 THEN 2386
2404       '
2406       LOCATE 19,75:PRINT USING"##";VAL(AUJUB$)
2408       '
2410       '***********************
2412       '***HORARIO  VIERNES-A**
2414       '***********************
2416       F.C1%=20:C.C1%=57:L.E%=8:BO%=12:ESC%=0:GOSUB 63000
2418       IF I.T%=0 THEN ENTR5B$=D.E$:LSET GVIERNB=ENTR5B$:GOTO 2436
2420       IF I.T%=1 AND I.A%=1 THEN ENTR5B$="":LSET GVIERNB=ENTR5B$:GOTO 2502
2422       IF I.T%=1 AND I.A%=3 THEN ENTR5B$=GVIERNB:GOTO 2440
2424       IF I.T%=3 AND I.A%=1 THEN LOCATE 19,75:PRINT SPC(2):GOTO 2386
2426       IF I.T%=3 THEN 2386
2428       IF I.T%=4 THEN 4000               'Fin Entrada.
2430       IF I.T%=2 AND I.A%=1 THEN LSET GVIERNB=ENTR5B$:GOTO 2436
2432       IF I.T%=2 THEN 2416
2434       '
2436       IF VAL(ENTR5B$)=0 THEN LSET GVIERNB="        ":GOTO 2502
2437       B$="1":LOCATE 20,57:PRINT LEFT$(ENTR5B$,2)"-"MID$(ENTR5B$,3,2)" "MID$(ENTR5B$,5,2)"-"RIGHT$(ENTR5B$,2)
2438       '
2440       '***********************
2442       '***ENTRADA PISO VIE-A**
2444       '***********************
2446       F.C1%=20:C.C1%=70:L.E%=2:BO%=2:ESC%=1:GOSUB 64000
2448       IF I.T%=0 THEN PIVIB$=D.E$:LSET GPIVIB=PIVIB$:GOTO 2466
2450       IF I.T%=1 AND I.A%=1 THEN PIVIB$="":LSET GPIVIB=PIVIB$:GOTO 2466
2452       IF I.T%=1 AND I.A%=3 THEN PIVIB$=GPIVIB:GOTO 2470
2454       IF I.T%=3 AND I.A%=1 THEN LOCATE 20,57:PRINT SPC(12):GOTO 2416
2456       IF I.T%=3 THEN 2416
2458       IF I.T%=4 THEN 4000               'Fin Entrada.
2460       IF I.T%=2 AND I.A%=1 THEN LSET GPIVIB=PIVIB$:GOTO 2466
2462       IF I.T%=2 THEN 2446
2464       '
2466       LOCATE 20,70:PRINT PIVIB$
2468       '
2470       '***********************
2472       '***ENTRADA AULA VIE-A**
2474       '***********************
2476       F.C1%=20:C.C1%=75:L.E%=2:BO%=2:ESC%=1:GOSUB 63000
2478       IF I.T%=0 THEN AUVIB$=D.E$:LSET GAUVIB=AUVIB$:GOTO 2496
2480       IF I.T%=1 AND I.A%=1 THEN AUVIB$="":LSET GAUVIB=AUVIB$:GOTO 2496
2482       IF I.T%=1 AND I.A%=3 THEN AUVIB$=GAUVIB:GOTO 2498
2484       IF I.T%=3 AND I.A%=1 THEN LOCATE 20,70:PRINT SPC(2):GOTO 2446
2486       IF I.T%=3 THEN 2446
2488       IF I.T%=4 THEN 4000               'Fin Entrada.
2490       IF I.T%=2 AND I.A%=1 THEN LSET GAUVIB=AUVIB$:GOTO 2496
2492       IF I.T%=2 THEN 2476
2494       '
2496       LOCATE 20,75:PRINT USING"##";VAL(AUVIB$)
2498       '
2500       '*************************************
2501       '***PEDIMOS CONFORMIDAD A LOS DATOS***
2502       '*************************************
2505       '
2510       GOSUB 8500:COLOR 10:LOCATE 22,15:PRINT "Datos Correctos ";
2515       COLOR 15:PRINT " ENTER ";
2520       COLOR 10:PRINT " Datos Erroneos ";
2525       COLOR 15:PRINT " F1 "
2530       COLOR 10
2535       A$=INPUT$(1)
2540       IF ASC(A$)<13 OR ASC(A$)>14 THEN BEEP:GOTO 2535
2545       IF ASC(A$)=14 THEN 550
2550       'Grabar Datos.
2555        IF B$="1" THEN LSET GSB="1":GOTO 2560
2557        LSET GSB="0":GOTO 2560
2558       IF VAL(ENTR1B$)=0 AND VAL(ENTR2B$)=0 AND VAL(ENTR3B$)=0 AND VAL(ENTR4B$)=0 AND VAL(ENTR5B$)=0 THEN LSET GSB="0"
2560       IF I.A%=3 THEN 2585
2561       LSET GSTATUS="O":LSET GALTAS=MKI$(0)   ':LSET GCONFIR=MKI$(0)
2562       LSET GLIBR=STRING$(16," "):LSET GALUS=STRING$(200," ")
2564       PUT #6,N.ORDEN%
2566       GET #6,1
2568       LSET GULTIMO=MKI$(N.ORDEN%)
2570       PUT #6,1
2572       CLOSE
2574       GOTO 530
2585       PUT #6,N.ORDEN%
2590       CLOSE
2610 '
2618 '
2650 '************************************************
2660 '***TRATAMIENTO COMUN DE BAJA,MODI, Y CONSULTA***
2670 '************************************************
2690 TIT$=TABRUT$(I.A%)
2710 GOSUB 32000:GOSUB 30000
2720 GOSUB 8000:GOSUB 31000
2732 IF I.A%=3 THEN GOSUB 8500:GOSUB 7500
2734 IF I.A%=2 THEN GOSUB 8500:LOCATE 22,14:COLOR 10:PRINT " F7 => ";:COLOR 15:PRINT " F¡n de Bajas"
2736 IF I.A%=4 THEN GOSUB 8500:LOCATE 22,14:COLOR 10:PRINT " F7 => ";:COLOR 15:PRINT " F¡n de Consultas"
2740    '*****************************
2750    '***PEDIMOS NUMERO DE GRUPO **
2760    '*****************************
2770 COLOR 15
2780      F.C1%=6:C.C1%=15:L.E%=3:BO%=3:ESC%=1:GOSUB 63000
2785      IF I.T%=0 THEN CLA$=D.E$:GOTO 2800            'Entrada OK
2790      IF I.T%=4 THEN 4000
2795      GOTO 2780                                     ' -ERROR-
2800      IF LEN(CLA$)<>3 THEN BEEP:GOTO 2780 'Se ha duplicado y no hay Cta.
2810      N.ORDEN%=VAL(CLA$)
2812      IF N.ORDEN%> ULTGRU% OR N.ORDEN%<2 THEN 2840
2814      GET #6,N.ORDEN%
2820      IF I.A%=4 AND CVI(GALTAS)>0 THEN  9500 ELSE 2850
2830      IF GSTATUS="O" THEN  2850
2835      GOSUB 8500:MEN$="ESTE GRUPO ESTA DADO DE BAJA, PULSAR UNA TECLA":GOSUB 8500:A$=INPUT$(1):GOTO 2732
2840      GOSUB 8500:MEN$="ESTE GRUPO NO EXISTE, PULSAR UNA TECLA":GOSUB 8500:A$=INPUT$(1):GOTO 2732
2850    ' LOCATE 4,77:PRINT GESCUE
2855      LOCATE 6,15:PRINT USING"###";VAL(CLA$)
2860      LOCATE 6,33:PRINT GCURSO
2870     LOCATE 6,63:PRINT GTEXTO
2880   ' GUAPRI#=CVS(GCUOTA):GOSUB 64770:LOCATE 8,18-L.C%:PRINT GUAPRI$
2910     LOCATE 8,36:PRINT USING"##";CVI(GALUMNOS)
2920     LOCATE 8,53:PRINT USING"##";CVI(GALTAS)
2930    'LOCATE 8,76:PRINT USING"##";CVI(GCONFIR)
2935     IF LEFT$(GLUNESA$,2)="  " THEN 2941
2937     LOCATE 16,18:PRINT LEFT$(GLUNESA,2)"-"MID$(GLUNESA,3,2)" "MID$(GLUNESA,5,2)"-"RIGHT$(GLUNESA,2)
2939     LOCATE 16,31:PRINT GPILUA:LOCATE 16,36:PRINT GAULUA
2941     IF LEFT$(GMARTEA$,2)="  " THEN 2947
2943     LOCATE 17,18:PRINT LEFT$(GMARTEA,2)"-"MID$(GMARTEA,3,2)" "MID$(GMARTEA,5,2)"-"RIGHT$(GMARTEA,2)
2945     LOCATE 17,31:PRINT GPIMAA:LOCATE 17,36:PRINT GAUMAA
2947     IF LEFT$(GMIERCA$,2)="  " THEN 2953
2949     LOCATE 18,18:PRINT LEFT$(GMIERCA,2)"-"MID$(GMIERCA,3,2)" "MID$(GMIERCA,5,2)"-"RIGHT$(GMIERCA,2)
2951     LOCATE 18,31:PRINT GPIMIA:LOCATE 18,36:PRINT GAUMIA
2953     IF LEFT$(GJUEVEA$,2)="  " THEN 2959
2955     LOCATE 19,18:PRINT LEFT$(GJUEVEA,2)"-"MID$(GJUEVEA,3,2)" "MID$(GJUEVEA,5,2)"-"RIGHT$(GJUEVEA,2)
2957     LOCATE 19,31:PRINT GPIJUA:LOCATE 19,36:PRINT GAUJUA
2959     IF LEFT$(GVIERNA$,2)="  " THEN 2965
2961     LOCATE 20,18:PRINT LEFT$(GVIERNA,2)"-"MID$(GVIERNA,3,2)" "MID$(GVIERNA,5,2)"-"RIGHT$(GVIERNA,2)
2963     LOCATE 20,31:PRINT GPIVIA:LOCATE 20,36:PRINT GAUVIA
2965     IF LEFT$(GLUNESB$,2)="  " THEN 2971
2967     LOCATE 16,57:PRINT LEFT$(GLUNESB,2)"-"MID$(GLUNESB,3,2)" "MID$(GLUNESB,5,2)"-"RIGHT$(GLUNESB,2)
2969     LOCATE 16,70:PRINT GPILUB:LOCATE 16,75:PRINT GAULUB
2971     IF LEFT$(GMARTEB$,2)="  " THEN 2977
2973     LOCATE 17,57:PRINT LEFT$(GMARTEB,2)"-"MID$(GMARTEB,3,2)" "MID$(GMARTEB,5,2)"-"RIGHT$(GMARTEB,2)
2975     LOCATE 17,70:PRINT GPIMAB:LOCATE 17,75:PRINT GAUMAB
2977     IF LEFT$(GMIERCB$,2)="  " THEN 2983
2979     LOCATE 18,57:PRINT LEFT$(GMIERCB,2)"-"MID$(GMIERCB,3,2)" "MID$(GMIERCB,5,2)"-"RIGHT$(GMIERCB,2)
2981     LOCATE 18,70:PRINT GPIMIB:LOCATE 18,75:PRINT GAUMIB
2983     IF LEFT$(GJUEVEB$,2)="  " THEN 2989
2985     LOCATE 19,57:PRINT LEFT$(GJUEVEB,2)"-"MID$(GJUEVEB,3,2)" "MID$(GJUEVEB,5,2)"-"RIGHT$(GJUEVEB,2)
2987     LOCATE 19,70:PRINT GPIJUB:LOCATE 19,75:PRINT GAUJUB
2989     IF LEFT$(GVIERNB$,2)="  " THEN 2995
2991     LOCATE 20,57:PRINT LEFT$(GVIERNB,2)"-"MID$(GVIERNB,3,2)" "MID$(GVIERNB,5,2)"-"RIGHT$(GVIERNB,2)
2993     LOCATE 20,70:PRINT GPIVIB:LOCATE 20,75:PRINT GAUVIB
2995     '
2997     IF GSTATUS<>"O" THEN COLOR 28:LOCATE 9,27:PRINT "ESTE GRUPO ESTA DADO DE BAJA"
2998     COLOR 15
3000     IF I.A%<>2 THEN 3190     'T. de Modi y consulta.
3010     '
3020     '*************************
3030     '***TRATAMIENTO DE BAJA***
3040     '*************************
3042     IF VAL(GALTAS)=0 THEN 3050
3044     GOSUB 8500:MEN$="NO PODEMOS DAR DE BAJA POR TENER ALUMNOS, PULSAR UNA TECLA":GOSUB 8500:A$=INPUT$(1):GOTO 2720
3050     GOSUB 8500
3060     COLOR 10:LOCATE 22,15:PRINT "Dar de baja ";
3070     COLOR 15:PRINT " ENTER ";
3080     COLOR 10:PRINT " No dar de baja ";
3090     COLOR 15:PRINT " F1 ":COLOR 10
3100     A$=INPUT$(1)
3110     IF ASC(A$)<13 OR ASC(A$)>14 THEN BEEP:GOTO 3100
3120     IF ASC(A$)=14 THEN 2720
3140     LSET GSTATUS="L":PUT #6,N.ORDEN%
3150     GOSUB 8500:MEN$="  Grupo dado de baja ":RET%=1:GOSUB 8500
3160     '
3170     GOTO 2720    'A BUSCAR OTRO
3180     '
3190     IF I.A%=3 THEN 3300    'T. DE MODIFICACION.
3200     '
3210     '*****************************
3220     '***TRATAMIENTO DE CONSULTA***
3230     '*****************************
3240     GOSUB 8500:MEN$="   Pulse una tecla para nueva consulta   ":GOSUB 8500
3250     A$=INPUT$(1)
3260     GOTO 2720
3270     '
3280     '
3290     '*********************************
3300     '***TRATAMIENTO DE MODIFICACION***
3310     '*********************************
3330     GOSUB 7510   'Presentar mensajes teclas de Funcion Modi.
3340     GOTO 770     '===>PASAMOS POR EL  ALTA
3350     '
3360     '
4000 '**************************
4010 '***FIN ENTRADA DE DATOS***
4020 '**************************
4030 CLS
4040 CLOSE
4050 GOTO 302
4060 '
4080 '**********************************
4110 '***LISTADO NUMERICO DEL FICHERO***
4140 '**********************************
4145 WIDTH "LPT1:",133:OPEN "LPT1:" FOR OUTPUT AS #9
4150 LPRINT CHR$(27) "C" CHR$(66);:LPRINT CHR$(15)
4170 GOSUB 8000
4200 COLOR 10:LOCATE 9,21:PRINT "- INFORME NUMERICO DE GRUPOS EN VIGOR -"
4230 LOCATE 10,21:PRINT STRING$(40,"-")
4240 LOCATE 15,28:PRINT "Final del listado ";
4245 COLOR 15:PRINT " F10 ":COLOR 10
4250 GOSUB 8500:LOCATE 22,15:PRINT "Espere por favor.........."
5010 LIN%=90:PAG%=0
5130 GOSUB 32000
5140 FOR NUME%=2 TO ULTGRU%
5150 GET #6,NUME%
5155 IF GSTATUS="L" THEN 5170
5157 IF CVI(GALTAS)=0 THEN 5170
5160 GOSUB 5460
5170 NEXT NUME%
5190 IF LIN%=90 THEN GOSUB 8500:MEN$="No hay datos en el Fichero, pulsar una tecla":GOSUB 8500:A$=INPUT$(1):GOTO 5370
5340 LPRINT CHR$(12)
5370 CLOSE:GOTO 302    'Volver al menu de Listado.
5400 '
5430 '*******************************************
5460 '***LINEA DE DETALLE DEL INFORME NUMERICO***
5490 '*******************************************
5520 '
5580 IF LIN%>66 THEN GOSUB 5910    'Hacer Cabeceras.
5581 LPRINT TAB(4) GGRUPO;
5582 LPRINT TAB(10) GCURSO;
5584 LPRINT TAB(27) GTEXTO;
5609 'GUAPRI#=CVS(GCUOTA):GOSUB 64770:LPRINT TAB(49-L.C%) GUAPRI$;
5610 GUAPRI#=CVI(GALUMNOS):GOSUB 64770:LPRINT TAB(54-L.C%) GUAPRI$;
5611 GUAPRI#=CVI(GALTAS):GOSUB 64770:LPRINT TAB(59-L.C%) GUAPRI$;
5612 'GUAPRI#=CVI(GCONFIR):GOSUB 64770:LPRINT TAB(64-L.C%) GUAPRI$;
5614 IF LEFT$(GLUNESA,1)=" " THEN 5618
5616 LPRINT TAB(67) LEFT$(GLUNESA,2)"-"MID$(GLUNESA,3,2)" "MID$(GLUNESA,5,2)"-"RIGHT$(GLUNESA,2);
5618 IF LEFT$(GMARTEA,1)=" " THEN 5622
5620 LPRINT TAB(80) LEFT$(GMARTEA,2)"-"MID$(GMARTEA,3,2)" "MID$(GMARTEA,5,2)"-"RIGHT$(GMARTEA,2);
5622 IF LEFT$(GMIERCA,1)=" " THEN 5626
5624 LPRINT TAB(93) LEFT$(GMIERCA,2)"-"MID$(GMIERCA,3,2)" "MID$(GMIERCA,5,2)"-"RIGHT$(GMIERCA,2);
5626 IF LEFT$(GJUEVEA,1)=" " THEN 5630
5628 LPRINT TAB(106) LEFT$(GJUEVEA,2)"-"MID$(GJUEVEA,3,2)" "MID$(GJUEVEA,5,2)"-"RIGHT$(GJUEVEA,2);
5630 IF LEFT$(GVIERNA,1)=" " THEN 5633
5632 LPRINT TAB(119) LEFT$(GVIERNA,2)"-"MID$(GVIERNA,3,2)" "MID$(GVIERNA,5,2)"-"RIGHT$(GVIERNA,2)
5633 IF GSB="0" THEN LIN%=LIN%-1:GOTO 5654
5634 LPRINT TAB(50) "Semana. -B- : ";
5635 IF LEFT$(GLUNESB,1)=" " THEN 5638
5636 LPRINT TAB(67) LEFT$(GLUNESB,2)"-"MID$(GLUNESB,3,2)" "MID$(GLUNESB,5,2)"-"RIGHT$(GLUNESB,2);
5638 IF LEFT$(GMARTEB,1)=" " THEN 5642
5640 LPRINT TAB(80) LEFT$(GMARTEB,2)"-"MID$(GMARTEB,3,2)" "MID$(GMARTEB,5,2)"-"RIGHT$(GMARTEB,2);
5642 IF LEFT$(GMIERCB,1)=" " THEN 5646
5644 LPRINT TAB(93) LEFT$(GMIERCB,2)"-"MID$(GMIERCB,3,2)" "MID$(GMIERCB,5,2)"-"RIGHT$(GMIERCB,2);
5646 IF LEFT$(GJUEVEB,1)=" " THEN 5650
5648 LPRINT TAB(106) LEFT$(GJUEVEB,2)"-"MID$(GJUEVEB,3,2)" "MID$(GJUEVEB,5,2)"-"RIGHT$(GJUEVEB,2);
5650 IF LEFT$(GVIERNB,1)=" " THEN LPRINT:GOTO 5654
5652 LPRINT TAB(119) LEFT$(GVIERNB,2)"-"MID$(GVIERNB,3,2)" "MID$(GVIERNB,5,2)"-"RIGHT$(GVIERNB,2)
5654 LPRINT
5720 LIN%=LIN%+3
5730 TECLA$=INKEY$
5760 IF TECLA$="" THEN 5820
5790 IF ASC(TECLA$)=10 THEN  9000
5820 RETURN
5850 '
5880 '***************************
5910 '***CABECERAS DEL LISTADO***
5940 '***************************
5950 IF LIN%=90 THEN 5970
5960 LPRINT CHR$(12)
5970 PAG%=PAG%+1
6000 LPRINT TAB(3) EMPRESA$;
6010 LPRINT TAB(48) "RELACION NUMERICA DE LOS GRUPOS EN VIGOR AL DIA "+FECHA$;
6060 LPRINT TAB(118):LPRINT USING "PAGINA : ###";PAG%
6090 '
6150 LPRINT TAB(3) STRING$(LEN(EMPRESA$),"-");
6155 LPRINT TAB(48) STRING$(56,"-");
6160 LPRINT TAB(118) STRING$(12,"-")
6210 LPRINT
6240 '
6250 LPRINT TAB(67) "      D I A S    Y    H O R A R I O S    D E    C L A S E"
6260 LPRINT TAB(67) STRING$(63,"-")
6270 LPRINT TAB(67) "   LUNES        MARTES     MIERCOLES     JUEVES       VIERNES  "
6280 LPRINT TAB(52) "NU.  NU.  NU.  -----------  -----------  -----------  -----------  -----------"
6290 LPRINT TAB(3) "GRUPO     C U R S O        T E X T O             ALU  ALT       DESDE HASTA  DESDE HASTA  DESDE HASTA  DESDE HASTA  DESDE HASTA"
6300 LPRINT TAB(3) "-----  ---------------  ---------------          ---  ---       ----- -----  ----- -----  ----- -----  ----- -----  ----- -----"
6330 LPRINT
6360 '
6390 LIN%=9
6420 RETURN
6450 '
7500 '***********************************************************
7510 '***PRESENTAMOS MENSAJES TECLAS DE FUNCION MODIFICACIONES***
7520 '***********************************************************
7530 GOSUB 8500:LOCATE 22,14
7540 COLOR 10:PRINT " ENTER =>";
7550 COLOR 15:PRINT " Saltar ";
7560 COLOR 10:PRINT " F7 =>";
7570 COLOR 15:PRINT " Fin Modificaciones ";
7580 COLOR 10:PRINT " F8 =>";
7590 COLOR 15:PRINT " Campo Atr s"
7600 '
7610 '
7620 '
7630 RETURN
7640 '**************************************************
7650 '***PRESENTAMOS MENSAJES TECLAS DE FUNCION ALTAS***
7660 '**************************************************
7670 GOSUB 8500:LOCATE 22,14
7680 COLOR 10:PRINT " ENTER =>";
7690 COLOR 15:PRINT " Saltar ";
7700 COLOR 10:PRINT " F7 =>";
7710 COLOR 15:PRINT " Fin Altas ";
7720 COLOR 10:PRINT " F8 =>";
7730 COLOR 15:PRINT " Campo Atr s ";
7740 COLOR 10:PRINT " F10 =>";
7750 COLOR 15:PRINT " Dup. ";
7760 '
7770 RETURN
8000 '***********************************************
8010 '***  RUTINA PARA SACAR CARATULA EN PANTALLA ***
8020 '***********************************************
8030 '
8040 CLS:COLOR 10:LOCATE 1,1:PRINT CHR$(201)+STRING$(78,205)+CHR$(187)
8050 LOCATE 2,1:PRINT CHR$(186):COLOR 11:LOCATE 2,3:PRINT EMPRESA$:COLOR 10:LOCATE 2,34:PRINT "Aplicaci¢n : HOSTELERIA":COLOR 11:LOCATE 2,63:PRINT "FECHA : "FECHA$" ":COLOR 10 : LOCATE 2,80 :PRINT CHR$(186)
8060 LOCATE 3,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
8070 FOR J%=4 TO 21 :LOCATE J%,1:PRINT CHR$(186):LOCATE J%,80 :PRINT CHR$(186):NEXT
8080 LOCATE 21,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
8090 LOCATE 22,1:PRINT CHR$(186):COLOR 11:LOCATE 22,3:PRINT "Mensajes: ":COLOR 10:LOCATE 22,80:PRINT CHR$(186)
8100 LOCATE 23,1:PRINT CHR$(200)+STRING$(78,205)+CHR$(188);
8110 COLOR 15
8120 RETURN
8250 '
8490 '*************************
8500 '***IMPRESION DE MENSAJES*
8510 '*************************
8515 '
8520 COLOR 10:L.L$=""+MEN$+"":LOCATE 22,15:PRINT L.L$;
8525 IF RET%=1 THEN FOR H=1 TO 7500:NEXT H:RET%=0
8530 MEN$=SPACE$(64)
8540 RETURN
8550 '
9000 '**********************
9010 '***FIN DEL PROGRAMA***
9020 '**********************
9030 CLOSE
9040 CLS:RUN "PRESINIC"
9050 GOTO 302
9060 '
9070 '
9080 '
9090 '
9100 '*******************************
9110 '***RUTINA CONTROL DE ERRORES***
9120 '*******************************
9130 IF ERR=24 OR ERR=25 OR ERR=27 THEN GOSUB 8500:MEN$="--COMPRUEBE LA IMPRESORA Y PULSE UNA TECLA--":GOSUB 8500:A$=INPUT$(1):GOSUB 8500:RESUME
9132 IF ERL=30220 AND ERR=53 THEN GOSUB 8500:MEN$="Fichero de TARIFAS inesixtente":RET%=1:GOSUB 8500:GOTO 9000
9134 GOTO 9170
9142 GOSUB 8500:MEN$="Fichero FRESALUM.DIR inexistente":RET%=1:GOSUB 8500:CLOSE:GOTO 9000
9144 GOSUB 8500:MEN$="Fichero FRESALUM.DAT inexistente":RET%=1:GOSUB 8500:CLOSE:GOTO 9000
9170 ON ERROR GOTO 0
9180 '
9500 '**************************************
9505 '***SACAR TODO EL GRUPO EN PANTALLA ***
9510 '**************************************
9515 'GET #2,N.ALU%
9520 'GET #6,VAL(GRUPO$)
9525 GOSUB 8000
9530 'NOM$=CNOMBRE:APE1$=CAPELL1:APE2$=CAPELL2:GOSUB 40000
9535 LOCATE 4,3:COLOR 11:PRINT "Grupo : ";:COLOR 15:PRINT GGRUPO
9540 LOCATE 4,16:COLOR 11:PRINT "Curso : ";:COLOR 15:PRINT LEFT$(GCURSO,10)
9545 LOCATE 4,35:COLOR 11:PRINT "Texto : ";:COLOR 15:PRINT LEFT$(GTEXTO,10)
9547 LOCATE 4,54:COLOR 11:PRINT "Altas : ";:COLOR 15:PRINT USING"###";CVI(GALTAS)
9548 'LOCATE 4,67:COLOR 11:PRINT "Conf. : ";:COLOR 15:PRINT USING"###";CVI(GCONFIR)
9550 COLOR 10:LOCATE 5,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
9555 COLOR 11:LOCATE 6,3:PRINT "Dias ÍÍÍ>     LUNES       MARTES      MIERCOLES     JUEVES       VIERNES"
9560 LOCATE 7,3:PRINT "           -----------  -----------  -----------  -----------  -----------"
9565 LOCATE 8,3:PRINT "Semana  A":COLOR 15
9570 IF LEFT$(GLUNESA,1)=" " THEN 9580
9575 LOCATE 8,14:PRINT LEFT$(GLUNESA,2)","MID$(GLUNESA,3,2)" "MID$(GLUNESA,5,2)","RIGHT$(GLUNESA,2)
9580 IF LEFT$(GMARTEA,1)=" " THEN 9590
9585 LOCATE 8,27:PRINT LEFT$(GMARTEA,2)","MID$(GMARTEA,3,2)" "MID$(GMARTEA,5,2)","RIGHT$(GMARTEA,2)
9590 IF LEFT$(GMIERCA,1)=" " THEN 9600
9595 LOCATE 8,40:PRINT LEFT$(GMIERCA,2)","MID$(GMIERCA,3,2)" "MID$(GMIERCA,5,2)","RIGHT$(GMIERCA,2)
9600 IF LEFT$(GJUEVEA,1)=" " THEN 9610
9605 LOCATE 8,53:PRINT LEFT$(GJUEVEA,2)","MID$(GJUEVEA,3,2)" "MID$(GJUEVEA,5,2)","RIGHT$(GJUEVEA,2)
9610 IF LEFT$(GVIERNA,1)=" " THEN 9617
9615 LOCATE 8,66:PRINT LEFT$(GVIERNA,2)","MID$(GVIERNA,3,2)" "MID$(GVIERNA,5,2)","RIGHT$(GVIERNA,2)
9617 IF GSB="0" THEN 9675
9620 COLOR 11:LOCATE 9,3:PRINT "Semana  B":COLOR 15
9625 IF LEFT$(GLUNESB,1)=" " THEN 9635
9630 LOCATE 9,14:PRINT LEFT$(GLUNESB,2)","MID$(GLUNESB,3,2)" "MID$(GLUNESB,5,2)","RIGHT$(GLUNESB,2)
9635 IF LEFT$(GMARTEB,1)=" " THEN 9645
9640 LOCATE 9,27:PRINT LEFT$(GMARTEB,2)","MID$(GMARTEB,3,2)" "MID$(GMARTEB,5,2)","RIGHT$(GMARTEB,2)
9645 IF LEFT$(GMIERCB,1)=" " THEN 9655
9650 LOCATE 9,40:PRINT LEFT$(GMIERCB,2)","MID$(GMIERCB,3,2)" "MID$(GMIERCB,5,2)","RIGHT$(GMIERCB,2)
9655 IF LEFT$(GJUEVEB,1)=" " THEN 9665
9660 LOCATE 9,53:PRINT LEFT$(GJUEVEB,2)","MID$(GJUEVEB,3,2)" "MID$(GJUEVEB,5,2)","RIGHT$(GJUEVEB,2)
9665 IF LEFT$(GVIERNB,1)=" " THEN 9675
9670 LOCATE 9,66:PRINT LEFT$(GVIERNB,2)","MID$(GVIERNB,3,2)" "MID$(GVIERNB,5,2)","RIGHT$(GVIERNB,2)
9675 COLOR 10:LOCATE 10,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
9680 COLOR 11:LOCATE 11,26:PRINT "- ALUMNOS QUE TIENE EL GRUPO -"
9685 LOCATE 12,26:PRINT STRING$(30,205)
9690 FF%=12
9695 IF CVI(GALTAS)<9 THEN TT%=CVI(GALTAS)*5:MAS%=0:GOTO 9705
9700 TT%=40:MAS%=1
9705 FOR A%=1 TO TT% STEP 5
9710     FF%=FF%+1:NUM%=VAL(MID$(GALUS,A%,5)):GET #2,NUM%
9715     IF CCUENTA=ALUCON$ THEN COLOR 28 ELSE COLOR 15
9720     LOCATE FF%,3:PRINT USING"#####";VAL(CCUENTA)
9725     LOCATE FF%,9:PRINT MID$(CFENA,3,2) LEFT$(CFENA,2)
9730     NOM$=CNOMBRE:APE1$=CAPELL1:APE2$=CAPELL2:GOSUB 40000
9735     LOCATE FF%,16:PRINT LEFT$(CUCUCU$,24)
9740 NEXT A%
9745 IF MAS%=0 THEN 10050
9750 FF%=12
9755 IF CVI(GALTAS)<17 THEN TT%=CVI(GALTAS)*5:MAS%=0:GOTO 9765
9760 TT%=80:MAS%=1
9765 FOR A%=41 TO TT% STEP 5
9770     FF%=FF%+1:NUM%=VAL(MID$(GALUS,A%,5)):GET #2,NUM%
9775     IF CCUENTA=ALUCON$ THEN COLOR 28 ELSE COLOR 15
9780     LOCATE FF%,41:PRINT USING"#####";VAL(CCUENTA)
9785     LOCATE FF%,47:PRINT MID$(CFENA,3,2) LEFT$(CFENA,2)
9790     NOM$=CNOMBRE:APE1$=CAPELL1:APE2$=CAPELL2:GOSUB 40000
9795     LOCATE FF%,54:PRINT LEFT$(CUCUCU$,24)
9800 NEXT A%
9805 IF MAS%=0 THEN 10050
9810 GOSUB 8500:COLOR 11:LOCATE 22,13:PRINT "Hay mas Alumnos en el Grupo, para verlos pulsa ";:COLOR 15:PRINT " ENTER ";:COLOR 11:PRINT ", si n¢ ";:COLOR 15:PRINT " F1"
9815 A$=INPUT$(1)
9820 IF ASC(A$)<13 OR ASC(A$)>14 THEN BEEP:GOTO 9815
9825 IF ASC(A$)=14 THEN 10050
9830 FOR FF%=13 TO 20
9835  LOCATE FF%,2:PRINT SPC(78)
9840 NEXT FF%
9845 FF%=12
9850 IF CVI(GALTAS)<25 THEN TT%=CVI(GALTAS)*5:MAS%=0:GOTO 9860
9855 TT%=120:MAS%=1
9860 FOR A%=81 TO TT% STEP 5
9865     FF%=FF%+1:NUM%=VAL(MID$(GALUS,A%,5)):GET #2,NUM%
9870     IF CCUENTA=ALUCON$ THEN COLOR 28 ELSE COLOR 15
9875     LOCATE FF%,3:PRINT USING"#####";VAL(CCUENTA)
9880     LOCATE FF%,9:PRINT MID$(CFENA,3,2) LEFT$(CFENA,2)
9885     NOM$=CNOMBRE:APE1$=CAPELL1:APE2$=CAPELL2:GOSUB 40000
9890     LOCATE FF%,16:PRINT LEFT$(CUCUCU$,24)
9895 NEXT A%
9900 IF MAS%=0 THEN 10050
9905 FF%=12
9910 IF CVI(GALTAS)<33 THEN TT%=CVI(GALTAS)*5:MAS%=0:GOTO 9920
9915 TT%=160:MAS%=1
9920 FOR A%=121 TO TT% STEP 5
9925     FF%=FF%+1:NUM%=VAL(MID$(GALUS,A%,5)):GET #2,NUM%
9930     IF CCUENTA=ALUCON$ THEN COLOR 28 ELSE COLOR 15
9935     LOCATE FF%,41:PRINT USING"#####";VAL(CCUENTA)
9940     LOCATE FF%,47:PRINT MID$(CFENA,3,2) LEFT$(CFENA,2)
9945     NOM$=CNOMBRE:APE1$=CAPELL1:APE2$=CAPELL2:GOSUB 40000
9950     LOCATE FF%,54:PRINT LEFT$(CUCUCU$,24)
9955 NEXT A%
9960 IF MAS%=0 THEN 10050
9965 GOSUB 8500:COLOR 11:LOCATE 22,13:PRINT "Hay mas Alumnos en el Grupo, para verlos pulsa ";:COLOR 15:PRINT " ENTER ";:COLOR 11:PRINT ", si n¢ ";:COLOR 15:PRINT " F1"
9970 A$=INPUT$(1)
9975 IF ASC(A$)<13 OR ASC(A$)>14 THEN BEEP:GOTO 9970
9980 IF ASC(A$)=14 THEN 10050
9985 FOR FF%=13 TO 20
9990  LOCATE FF%,2:PRINT SPC(78)
9995 NEXT FF%
10000 FF%=12
10005 TT%=200:MAS%=1
10010 FOR A%=161 TO TT% STEP 5
10015     FF%=FF%+1:NUM%=VAL(MID$(GALUS,A%,5)):GET #2,NUM%
10020     IF CCUENTA=ALUCON$ THEN COLOR 28 ELSE COLOR 15
10025     LOCATE FF%,3:PRINT USING"#####";VAL(CCUENTA)
10030     LOCATE FF%,9:PRINT MID$(CFENA,3,2) LEFT$(CFENA,2)
10035     NOM$=CNOMBRE:APE1$=CAPELL1:APE2$=CAPELL2:GOSUB 40000
10040     LOCATE FF%,16:PRINT LEFT$(CUCUCU$,24)
10045 NEXT A%
10050 GOTO 3220
30000 '*******************************
30010 '***APERTURA FICHERO ALUMNOS ***
30020 '*******************************
30025 '
30052 OPEN "R",#1,"FRESALUM.ALF",65
30054 FIELD #1,2 AS FULTI,20 AS FLLAMA,20 AS FAPE1,20 AS FAPE2,2 AS FILER,1 AS FSTA
30056 GET #1,1
30058  ULTIAL%=CVI(FULTI)
30060 'LSET FULTI=MKI$(1):LSET FLLAMA="":LSET FAPE1="":LSET FAPE2=""
30061 'LSET FILER="":LSET FSTA="A"
30062 'PUT #1,1
30090 ' Apertura del fichero de datos   FACAALUM.DAT
30100 OPEN "R",#2,"FRESALUM.DAT",430
30110 FIELD #2,5 AS CCUENTA,1 AS CSTATUS,20 AS CNOMBRE,20 AS CAPELL1,20 AS CAPELL2,40 AS CDIREC,20 AS CPOBLA,15 AS CPROVI,5 AS CCOPOS,7 AS CTELEFO,7 AS CTELEFA,13 AS CDNI,1 AS CCURSO
30112 FIELD #2,174 AS TODO1$,6 AS CFENA,4 AS CBANCO,20 AS CSUCUR,17 AS CCUBAN,6 AS CFALTA,1 AS CMARCA,50 AS COBSE1,50 AS COBSE2,40 AS COBSE3,2 AS CGR16,2 AS CGR17,2 AS CGR18,2 AS CGR19,2 AS CGR20,4 AS CFACT
30113 FIELD #2,250 AS TODO3$,132 AS TODO4$,2 AS CGR01,2 AS CGR02,2 AS CGR03,2 AS CGR04,2 AS CGR05,2 AS CGR06,2 AS CGR07,2 AS CGR08,2 AS CGR09,2 AS CGR10,2 AS CGR11,2 AS CGR12,2 AS CGR13,2 AS CGR14,2 AS CGR15,8 AS CIMPOR,10 AS CFILL
30114 FIELD #2,5 AS CCUEN1,1 AS CSTAT,2 AS CULTI,2 AS CULTACT,12 AS CFICHER,1 AS CSWG,1 AS CSWA,2 AS CVIGO,235 AS REST1$,4 AS CFEFAC,165 AS REST2$
30115 GET #2,1
30116  IF CFICHER<>"FRESALUM.DAT" THEN 9144
30117  ULTIMO%=CVI(CULTI)
30118  ULTACT%=CVI(CULTACT):N.R%=ULTACT%
30120  VIVAS%=CVI(CVIGO)
30122 'LSET CCUEN1="":LSET CSTAT="A":LSET CULTI=MKI$(1):LSET CULTACT=MKI$(1)
30124 'LSET CFICHER="FRESALUM.DAT":LSET CSWG="0":LSET CSWA="0"
30126 'LSET CVIGO=MKI$(0):LSET REST1$="":LSET CFEFAC="0000":LSET REST2$=""
30128 'PUT #2,1
30130 'CLOSE
30132 'STOP
30140 RETURN
30150 '
31000 '**********************************************
31010 '***PRESENTAMOS PANTALLA DE ENTRADA DE DATOS***
31020 '**********************************************
31030 COLOR 10:X%=80-LEN(TIT$):X%=INT(X%/2)
31040 LOCATE 4,X%:PRINT TIT$
31042 LOCATE 5,X%:PRINT STRING$(LEN(TIT$),205)
31045 '
31050 COLOR 11:LOCATE 6,3:PRINT "Grupo N§ : <   >    Curso. : < >    Texto. : <                             >"
31052 LOCATE 8,3:PRINT "                     Alumnos. : <  >"
31054 IF I.A%=1 THEN 31058
31056 LOCATE 8,43:PRINT "Altas. : <  >"  'Confirmados. : <  >"
31058 COLOR 10:LOCATE 9,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
31062 LOCATE 10,21:PRINT "- H O R A R I O S   D E L   G R U P O -"
31064 LOCATE 11,21:PRINT STRING$(39,205)
31066 LOCATE 12,11:PRINT "S E M A N A    - A -"                   "
31068 LOCATE 12,51:PRINT "S E M A N A    - B -"
31070 LOCATE 13,4:PRINT STRING$(35,205)
31072 LOCATE 13,43:PRINT STRING$(35,205)
31092 LOCATE 14,4:PRINT "    D I A     DESDE HASTA PISO AULA"
31094 LOCATE 14,44:PRINT "   D I A     DESDE HASTA PISO AULA"
31105 LOCATE 15,4:PRINT "ÍÍÍÍÍÍÍÍÍÍÍÍÍ ÍÍÍÍÍ ÍÍÍÍÍ ÍÍÍÍ ÍÍÍÍ"
31107 LOCATE 15,43:PRINT "ÍÍÍÍÍÍÍÍÍÍÍÍÍ ÍÍÍÍÍ ÍÍÍÍÍ ÍÍÍÍ ÍÍÍÍ"
31120 COLOR 11
31125 LOCATE 16,4:PRINT "Lunes .......                      "
31127 LOCATE 16,43:PRINT "Lunes .......                      "
31130 LOCATE 17,4:PRINT "Martes ......                      "
31140 LOCATE 17,43:PRINT "Martes ......                      "
31142 LOCATE 18,4:PRINT "Miercoles ...                      "
31144 LOCATE 18,43:PRINT "Miercoles ...                      "
31146 LOCATE 19,4:PRINT "Jueves ......                      "
31148 LOCATE 19,43:PRINT "Jueves ......                      "
31150 LOCATE 20,4:PRINT "Viernes .....                      "
31152 LOCATE 20,43:PRINT "Viernes .....                      "
31160 COLOR 15:RETURN
31170 '
32000 '*******************************
32010 '***APERTURA FICHERO GRUPOS  ***
32020 '*******************************
32030 'Comprobamos la existencia del fichero.
32040 ' Apertura del fichero de datos   FACAGRUP.DAT
32050 OPEN "R",#6,"FRESGRUP.DAT",380
32060 FIELD #6,3 AS GGRUPO,1 AS GSTATUS,1 AS GCURSO,29 AS GTEXTO,2 AS GALUMNOS,2 AS GALTAS,2 AS GCONFIR,4 AS GCUOTA,8 AS GLUNESA,2 AS GPILUA,2 AS GAULUA,8 AS GMARTEA,2 AS GPIMAA,2 AS GAUMAA
32070 FIELD #6,68 AS GPRIP,8 AS GMIERCA,2 AS GPIMIA,2 AS GAUMIA,8 AS GJUEVEA,2 AS GPIJUA,2 AS GAUJUA,8 AS GVIERNA,2 AS GPIVIA,2 AS GAUVIA
32080 FIELD #6,104 AS GPRI1,8 AS GLUNESB,2 AS GPILUB,2 AS GAULUB,8 AS GMARTEB,2 AS GPIMAB,2 AS GAUMAB,8 AS GMIERCB,2 AS GPIMIB,2 AS GAUMIB,8 AS GJUEVEB,2 AS GPIJUB
32085 FIELD #6,150 AS GPRI2,2 AS GAUJUB,8 AS GVIERNB,2 AS GPIVIB,2 AS GAUVIB,1 AS GSB,1 AS GESCUE,14 AS GLIBR,200 AS GALUS
32090 FIELD #6,3 AS GLIBR1,1 AS GSTATUS,12 AS GETIQUETA,2 AS GULTIMO,162 AS GLIB2,200 AS GLIB3
32100 FIELD #6,180 AS GTODO,200 AS GALUS
32110 GET #6,1
32120  IF GETIQUETA="FRESGRUP.DAT" THEN 32140
32130  GOSUB 8500:MEN$="NO TENEMOS FICHERO DE GRUPOS, PULSAR UNA TECLA":GOSUB 8500:A$=INPUT$(1):GOTO 9000
32140  ULTGRU%=CVI(GULTIMO)
32141 'LSET GLIBR1="":LSET GSTATUS="A":LSET GETIQUETA="FRESGRUP.DAT"
32142 'LSET GULTIMO=MKI$(1):LSET GLIB2="":LSET GLIB3=""
32143 'PUT #6,1
32144 'CLOSE:STOP
32150 RETURN
33000 '**********************************
33010 '***APERTURA FICHERO DATOS FIJOS***
33020 '**********************************
33030 OPEN "R",#1,"FDATFIJ.DAT",100
33040 FIELD #1,2 AS NRO$,8 AS NDIRE$,30 AS NEMPRESA$,15 AS NNIF$,8 AS NPROG$,37 AS NFILLER$
33050 GET #1,1
33052 NROEM$=NRO$
33060 DIRE$=NDIRE$
33070 EMPRESA$=NEMPRESA$
33080 NIF$=NNIF$
33082 PROGRAMA$=NPROG$
33090 CLOSE
33100 '
33110 '
33120 RETURN
33130 '
40000 'Ponemos el Nombre y los dos Apellidos en una linea.
40010 NOMBRE$=""
40020 'Bucle del Nombre.
40030 LONG%=LEN(NOM$)
40040 FOR I%=LONG% TO 1 STEP -1
40050    IF MID$(NOM$,I%,1)<>" " THEN LNOMBRE%=I%:I%=0
40060 NEXT I%
40070 '
40080 'Bucle del Apellido 1.
40090 LONG%=LEN(APE1$)
40100 FOR I%=LONG% TO 1 STEP -1
40110    IF MID$(APE1$,I%,1)<>" " THEN LAPELL1%=I%:I%=0
40120 NEXT I%
40130 '
40140 'Bucle del Apellido 2.
40150 LONG%=LEN(APE2$)
40160 FOR I%=LONG% TO 1 STEP -1
40170    IF MID$(APE2$,I%,1)<>" " THEN LAPELL2%=I%:I%=0
40180 NEXT I%
40190 CUCUCU$=LEFT$(NOM$,LNOMBRE%)+" "+LEFT$(APE1$,LAPELL1%)+" "+LEFT$(APE2$,LAPELL2%)
40200 CUCUCU$=LEFT$(CUCUCU$,50)
40210 RETURN
40220 '
50000 '************************
50010 '***RUTINA VIDEO INVERSO*
50020 '************************
50030 '
50035            ' Devuelve la opcion sobre I.A%
50050 R$=CHR$(0):F%=C.F%
50060 WHILE ASC(R$)<>13
50065 F.I%=C.F%-1
50070 FOR I.A%=1 TO N.L%
50080 F.I%=F.I%+1:IF F%=F.I% THEN 50100
50090 NEXT I.A%
50100 'Tengo el valor de I.A%
50110 COLOR 15:LOCATE F%,C%:PRINT TABRUT$(I.A%)
50120 R$=INKEY$:IF R$="" THEN 50120
50121 IF ASC(R$)=13 OR ASC(R$)=30 OR ASC(R$)=31 THEN 50130
50122 IF R$=CHR$(0)+CHR$(80) THEN R$=CHR$(31)
50123 IF R$=CHR$(0)+CHR$(72) THEN R$=CHR$(30)
50124 IF R$="2" THEN R$=CHR$(31)
50125 IF R$="8" THEN R$=CHR$(30)
50130 IF ASC(R$)=13 THEN 50190
50140 IF F%=C.F% AND ASC(R$)<>31 THEN 50120
50145 IF F%=L.F% AND ASC(R$)=31 AND NOMENU%=1 THEN LOCATE F%,C%:PRINT SPC(1):F%=C.F%:GOTO 50050
50150 IF F%=L.F% AND ASC(R$)=31 THEN COLOR 10:LOCATE F%,C%:PRINT TABRUT$(I.A%):F%=C.F%:GOTO 50050
50160 IF NOMENU%=1 THEN LOCATE F%,C%:PRINT SPC(1) ELSE COLOR 10:LOCATE F%,C%:PRINT TABRUT$(I.A%)
50170 IF ASC(R$)=30 THEN F%=F%-1
50180 IF ASC(R$)=31 THEN F%=F%+1
50190 WEND
50200 COLOR 10
50300 RETURN
50340 '
50510 '
63000 '********************************
63010 '***RUTINA DE ENTRADA NUMERICA***
63020 '********************************
63030 '
63040 D.E$="":I.T%=0
63050 LOCATE F.C1%,C.C1%,1,0,6
63060 FOR JMG%=1 TO L.E%
63070  D.R$=INPUT$(1)
63080  IF ASC(D.R$)=13 AND JMG%=1 THEN JMG%=L.E%:I.T%=1:GOTO 63200  '===>AL NEXT
63090  IF ASC(D.R$)=13 THEN JMG%=L.E%:GOTO 63200  '===>AL NEXT
63100  IF ASC(D.R$)=10 THEN JMG%=L.E%:I.T%=2:GOTO 63200  '===>AL NEXT
63110  IF ASC(D.R$)=9 THEN JMG%=L.E%:I.T%=3:GOTO 63200   '===>AL NEXT
63120  IF ASC(D.R$)=7 OR ASC(D.R$)=27 THEN JMG%=L.E%:I.T%=4:GOTO 63200   '===>AL NEXT
63130  IF JMG%=1 THEN LOCATE F.C1%,C.C1%:PRINT STRING$(BO%,"-"):LOCATE F.C1%,C.C1%
63140  IF D.R$<"0" OR D.R$>"9" THEN 63170               'Error
63150  D.E$=D.E$+D.R$:PRINT D.R$;
63160  GOTO 63200 'AL NEXT
63170  'Error.
63175  IF ASC(D.R$)=8 AND JMG%=1 THEN 63190
63180  IF ASC(D.R$)=8 THEN LOCATE F.C1%,C.C1%+LEN(D.E$)-1:PRINT "-":LOCATE F.C1%,C.C1%+LEN(D.E$)-1:D.E$=LEFT$(D.E$,LEN(D.E$)-1):JMG%=JMG%-1
63190  JMG%=JMG%-1
63200 NEXT JMG%
63210 IF I.T%<>0 THEN 63230
63220 IF LEN(D.E$)<>L.E% THEN D.E$=LEFT$(CERO$,L.E%-LEN(D.E$))+D.E$
63225 LOCATE F.C1%,C.C1%:PRINT STRING$(BO%," ")
63230 RETURN
63240 '
64000 '*************************************
64010 '***RUTINA DE ENTRADA ALFA/NUMERICA***
64020 '*************************************
64030 '
64040 D.E$="":I.T%=0
64050 LOCATE F.C1%,C.C1%,1,0,6
64060 FOR JMG%=1 TO L.E%
64070  D.R$=INPUT$(1)
64080  IF ASC(D.R$)=13 AND JMG%=1 THEN JMG%=L.E%:I.T%=1:GOTO 64200  '===>AL NEXT
64090  IF ASC(D.R$)=13 THEN JMG%=L.E%:GOTO 64200  '===>AL NEXT
64100  IF ASC(D.R$)=10 THEN JMG%=L.E%:I.T%=2:GOTO 64200  '===>AL NEXT
64110  IF ASC(D.R$)=9 THEN JMG%=L.E%:I.T%=3:GOTO 64200   '===>AL NEXT
64120  IF ASC(D.R$)=7 THEN JMG%=L.E%:I.T%=4:GOTO 64200   '===>AL NEXT
64130  IF JMG%=1 THEN LOCATE F.C1%,C.C1%:PRINT STRING$(BO%,"-"):LOCATE F.C1%,C.C1%
64135  IF ASC(D.R$)=34 THEN 64170
64140  IF ASC(D.R$)<32 OR ASC(D.R$)>126 THEN 64170               'Error
64150  D.E$=D.E$+D.R$:PRINT D.R$;
64160  GOTO 64200 'AL NEXT
64170  'Error.
64172  IF ASC(D.R$)=130 OR (ASC(D.R$)>159 AND ASC(D.R$)<166) THEN 64150
64175  IF ASC(D.R$)=8 AND JMG%=1 THEN 64190
64180  IF ASC(D.R$)=8 THEN LOCATE F.C1%,C.C1%+LEN(D.E$)-1:PRINT "-":LOCATE F.C1%,C.C1%+LEN(D.E$)-1:D.E$=LEFT$(D.E$,LEN(D.E$)-1):JMG%=JMG%-1
64190  JMG%=JMG%-1
64200 NEXT JMG%
64210 IF I.T%<>0 THEN 64230
64220 LOCATE F.C1%,C.C1%:PRINT SPC(BO%)
64225 LOCATE F.C1%,C.C1%:PRINT D.E$
64230 RETURN
64240 '
64760 '========================================================================
64762 ' RUTINA PARA EDITAR IMPORTES EN CRISTIANO X.XXX.XXX,XX                 =
64764 '                                                                       =
64766 ' SE ENTRARA A ESTA RUTINA DE LA FORMA  SIGUIENTE:                      =
64768 '                                                                       =
64770 ' GOSUB 64760 MANDANDO EN UN CAMPO LLAMADO GUAPRI#,                     =
64772 '                                                                       =
64773 '             LA CANTIDAD O NUMERO QUE DESEEMOS EDITAR.                 =
64774 '                                                                       =
64775 '             Y EN UN CAMPO LLAMADO N.D% EL NUMERO DE DECIMALES         =
64776 '                                                                       =
64778 ' DEVOLVERA EL CAMPO EDITADO EN GUAPRI$ Y LA LONGITUD EN L.C%           =
64780 '                                                                       =
64782 '========================================================================
64784 '
64786 '
64788 GUAPRI$=STR$(GUAPRI#):L.P%=0:N.D%=0
64790 FOR I%=1 TO 30:TABENT$(I%)="":NEXT I%
64792 SIGNO$=LEFT$(GUAPRI$,1):GUAPRI$=RIGHT$(GUAPRI$,LEN(GUAPRI$)-1)
64794 FOR I%=1 TO LEN(GUAPRI$)
64796   IF MID$(GUAPRI$,I%,1)="." THEN L.P%=I%:I%=LEN(GUAPRI$)
64798 NEXT I%
64800 IF L.P%=0 THEN DEC$="":ENT$=GUAPRI$:GOTO 64812
64802 IF N.D%=0 THEN DEC$="":GOTO 64808
64804 DEC$=","+MID$(GUAPRI$,L.P%+1,N.D%)
64806 IF LEN(DEC$)<>N.D%+1 THEN DEC$=DEC$+LEFT$(CERO$,N.D%+1-LEN(DEC$))
64808 ENT$=LEFT$(GUAPRI$,L.P%-1)
64810 IF LEN(ENT$)=0 THEN GUAPRI$="0":GOTO 64834
64812 X%=31
64814 FOR I%=LEN(ENT$) TO 1 STEP -1
64816   X%=X%-1
64818   IF X%=27 OR X%=23 OR X%=19 OR X%=15 OR X%=12 THEN TABENT$(X%)=".":X%=X%-1
64820   TABENT$(X%)=MID$(ENT$,I%,1)
64822 NEXT I%
64824 GUAPRI$=""
64826 FOR I%=1 TO 30
64828   IF TABENT$(I%)="" THEN 64832
64830   GUAPRI$=GUAPRI$+TABENT$(I%)
64832 NEXT I%
64833 IF SIGNO$=" " THEN GUAPRI$=GUAPRI$+DEC$:L.C%=LEN(GUAPRI$)-1:RETURN
64834 GUAPRI$=GUAPRI$+DEC$+SIGNO$:L.C%=LEN(GUAPRI$)-1
64836 RETURN
64838 '
