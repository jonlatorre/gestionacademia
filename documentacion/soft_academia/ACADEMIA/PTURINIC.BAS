10 '                       PTURINIC.BAS
20 '                      --------------
30 '      GESTION MENU GENERAL DE TURISMO-SECRETARIADO
40 '      --------------------------------------------
50 '
52 ON ERROR GOTO 160
54 '
56 '
100 GOSUB 33000     'LEER DATOS COMUNES
130 FECHA$=MID$(DATE$,4,3)+LEFT$(DATE$,3)+RIGHT$(DATE$,2)
150 OPTION BASE 1
160 '******************************
165 '***TRATAMIENTO DEL PROGRAMA***
170 '******************************
175 GOSUB 8000
180 COLOR 10
190 LOCATE 4,19:PRINT "- MENU GENERAL DE TURISMO Y SECRETARIADO -"
195 LOCATE 5,19:PRINT STRING$(44,205)
210 LOCATE 7,9:PRINT "Proceso de Alumnos."
212 LOCATE 7,41:PRINT CHR$(186)
214 LOCATE 7,49:PRINT "Proceso de Facturaci¢n."
216 LOCATE 8,9:PRINT " "
218 LOCATE 8,41:PRINT CHR$(186)
220 LOCATE 8,49:PRINT " "
222 LOCATE 9,9:PRINT "Proceso de Asignaturas."
224 LOCATE 9,41:PRINT CHR$(186)
226 LOCATE 9,49:PRINT "Proceso de Ausencias."
228 LOCATE 10,9:PRINT " "
230 LOCATE 10,41:PRINT CHR$(186)
232 LOCATE 10,49:PRINT " "
233 LOCATE 11,9:PRINT "  "
234 LOCATE 11,41:PRINT CHR$(186)
235 LOCATE 11,49:PRINT "Proceso de Calificaciones."
236 LOCATE 12,9:PRINT " "
238 LOCATE 12,41:PRINT CHR$(186)
240 LOCATE 12,49:PRINT " "
245 LOCATE 13,9:PRINT " "
246 LOCATE 13,41:PRINT CHR$(186)
248 LOCATE 13,49:PRINT " "
253 LOCATE 14,9:PRINT " "
254 LOCATE 14,41:PRINT CHR$(186)
255 LOCATE 14,49:PRINT "                              "
372 LOCATE 20,35:COLOR 15:PRINT " ESC "+CHR$(205)+CHR$(205)+CHR$(16)+" Fin ":COLOR 10
400 GOSUB 8500
410 LOCATE 23,15:PRINT "Seleccione Opci¢n con las Flechas y Pulse la Tecla ";
420 COLOR 15
425 PRINT CHR$(17)+CHR$(196)+CHR$(217)
430 COLOR 10
440 '
450 FILA%=7:COLUMNA%=5:OPCIONES%=2
460 GOSUB 20000
465 IF ATRAS%=1 THEN 450
470 IF I.A%>OPCIONES% THEN 500
480 ON I.A% GOTO 1030,1040
485 '
490 '
500 FILA%=7:COLUMNA%=45:OPCIONES%=3
510 GOSUB 20000
515 IF ATRAS%=1 THEN 450
520 IF I.A%>OPCIONES% THEN 600
530 ON I.A% GOTO 1120,1130,1140
535 '
540 '
600 '
640 '
700 GOTO 450
800  '*********************************************************
810  '*** DISTRIBUCION GENERAL DE PROGRAMAS DE CONTABILIDAD ***
820  '*********************************************************
830  '
1030 RUN "PTURCLIE"      'FICHERO DE ALUMNOS
1040 RUN "PTURASIG"      'FICHERO DE ASIGNATURAS
1070 GOTO 160
1080 GOTO 160
1090 GOTO 160
1100 GOTO 160
1105 GOTO 160
1115 GOTO 160
1120 RUN "PTURCOBR"        'PROCESO DE FACTURACION
1125 GOTO 160
1130 RUN "PTURAUSE"        'PROCESO DE AUSENCIAS
1140 RUN "PTURNOTA"        'PROCESO DE CALIFICACIONES
1150 GOTO 160
1160 GOTO 160
1170 GOTO 160
1180 GOTO 160
8000 '***********************************************
8010 '***  RUTINA PARA SACAR CARATULA EN PANTALLA ***
8020 '***********************************************
8030 '
8040 CLS:COLOR 10:LOCATE 1,1:PRINT CHR$(201)+STRING$(78,205)+CHR$(187)
8050 LOCATE 2,1:PRINT CHR$(186):COLOR 11:LOCATE 2,3:PRINT EMPRESA$ :COLOR 10:LOCATE 2,37:PRINT "APLICACIN : ACADEMIAS ":COLOR 11:LOCATE 2,63:PRINT "FECHA : "FECHA$" ":COLOR 10 : LOCATE 2,80 :PRINT CHR$(186)
8060 LOCATE 3,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
8070 FOR J%=4 TO 22 :LOCATE J%,1:PRINT CHR$(186):LOCATE J%,80 :PRINT CHR$(186):NEXT
8080 LOCATE 22,1:PRINT CHR$(204)+STRING$(78,205)+CHR$(185)
8090 LOCATE 23,1:PRINT CHR$(186):COLOR 11:LOCATE 23,3:PRINT "Mensajes: ":COLOR 10:LOCATE 23,80:PRINT CHR$(186)
8100 LOCATE 24,1:PRINT CHR$(200)+STRING$(78,205)+CHR$(188);
8110 COLOR 7,0,0:RETURN
8120 '
8250 '
8490 '*************************
8500 '***IMPRESION DE MENSAJES*
8510 '*************************
8515 '
8520 COLOR 10:L.L$=""+MEN$+"":LOCATE 23,15:PRINT L.L$;
8525 IF RET%=1 THEN FOR H=1 TO 1500:NEXT H:RET%=0
8530 MEN$=SPACE$(64)
8540 RETURN
8550 '
9000 '**********************
9010 '***FIN DEL PROGRAMA***
9020 '**********************
9030 CLS
9040 RUN "PACAINIC"
9060 '
9070 '
9080 '
9090 '
20000 '********************************************
20010 '*** RATONCITO PARA SELECCIONAR OPCIONES  ***
20020 '********************************************
20030 '***                                      ***
20040 '*** FILA%=FILA DONDE APARECERA EL RATON  ***
20050 '***                                      ***
20060 '*** COLUMNA%=COLUMNA DONDE APARECERA EL  ***
20070 '***          RATON                       ***
20080 '***                                      ***
20090 '*** OPCIONES%=NUMERO DE OPCIONES         ***
20100 '***                                      ***
20110 '*** CON ESC SALE A LA SENTENCIA 9000     ***
20120 '***                                      ***
20130 '********************************************
20140 '
20150 R$=CHR$(0):ATRAS%=0
20160 FOR I.A%=1 TO OPCIONES%
20170 COLOR 15:LOCATE FILA%,COLUMNA%:PRINT CHR$(205)+CHR$(205)+CHR$(16)
20180 COLOR 10:R$=INKEY$:IF R$="" THEN 20180
20190 IF ASC(R$)=27 THEN 9000
20200 IF R$=CHR$(0)+CHR$(80) THEN R$=CHR$(31)
20210 IF R$=CHR$(0)+CHR$(72) THEN R$=CHR$(30)
20220 IF R$="2" THEN R$=CHR$(31)
20230 IF R$="8" THEN R$=CHR$(30)
20240 IF ASC(R$)=13 OR ASC(R$)=30 OR ASC(R$)=31 THEN 20250  ELSE 20180
20250 IF ASC(R$)=13 THEN RETURN
20260 LOCATE FILA%,COLUMNA%:PRINT "   "
20270 IF ASC(R$)=30 AND I.A%=1 THEN ATRAS%=1:RETURN
20280 IF ASC(R$)=30 THEN FILA%=FILA%-2:I.A%=I.A%-1:GOTO 20170 'AL NEXT
20290 FILA%=FILA%+2
20300 NEXT I.A%
20310 RETURN
20320 'ESTO SE ACABA
20330 '
33000 '**********************************
33010 '***APERTURA FICHERO DATOS FIJOS***
33020 '**********************************
33030 OPEN "R",#1,"FDATFIJ.DAT",100
33040 FIELD #1,2 AS NRO$,8 AS NDIRE$,30 AS NEMPRESA$,15 AS NNIF$,8 AS NPROG$,37 AS NFILLER$
33050 GET #1,1
33052 NROEM$=NRO$
33060 DIRE$=NDIRE$
33070 EMPRESA$="*** TURISMO Y SECRETARIADO ***"
33080 NIF$=NNIF$
33082 PROGRAMA$=NPROG$
33090 CLOSE
33100 '
33110 '
33120 RETURN
33130 '
