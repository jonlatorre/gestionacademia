10 '                       PRESCLIE.BAS
20 '                      --------------
30 '         GESTION FICHERO DE ALUMNOS DE HOSTELERIA
40 '         ----------------------------------------
52 '
54 '
56 '
60 ON ERROR GOTO 9100
70 GOSUB 33000
80 KEY 1,CHR$(14):KEY 7,CHR$(7):KEY 8,CHR$(9):KEY 10,CHR$(10)
82 KEY 2,CHR$(15):KEY 3,CHR$(16):KEY 4,CHR$(17)
90 CERO$=STRING$(15,"0"):BLANCO$=STRING$(40," ")
100 '
130 FEDIA$=RIGHT$(DATE$,2)+LEFT$(DATE$,2)+MID$(DATE$,4,2)
132 FECHA$=RIGHT$(FEDIA$,2)+"-"+MID$(FEDIA$,3,2)+"-"+LEFT$(FEDIA$,2)
134 '
140 DEFSTR C,B,G,F
150 OPTION BASE 1
160 DIM DIAS%(12),TABENT$(30),GRU%(20)
170 FOR I%=1 TO 20:GRU%(I%)=0:NEXT I%
172 '
174 '
176 '
178 '
290 '
292 DATA 31,28,31,30,31,30,31,31,30,31,30,31
294 FOR I%=1 TO 12:READ DIAS%(I%):NEXT I%
296 '
299 '
300 '******************************
302 '***TRATAMIENTO DEL PROGRAMA***
304 '******************************
306 '
308 '
310 GOSUB 8000
312 COLOR 11
314 LOCATE 5,15:PRINT "- MENU GENERAL DE GESTION DE ALUMNOS DE HOSTELERIA -"
316 LOCATE 6,15:PRINT STRING$(52,205)
318 LOCATE 8,9:PRINT " - GESTION DEL FICHERO -"
320 COLOR 10:LOCATE 8,41: PRINT CHR$(186):COLOR 11
322 LOCATE 8,49: PRINT "- L I S T A D O S -"
324 LOCATE 9,9:PRINT STRING$(25,205)
326 COLOR 10:LOCATE 9,41: PRINT CHR$(186):COLOR 11
328 LOCATE 9,49:PRINT STRING$(23,205)
330 COLOR 10:LOCATE 10,9:PRINT "Altas de Alumnos."
332 LOCATE 10,41:PRINT CHR$(186)
334 LOCATE 10,49:PRINT "Listado num‚rico de Alumnos."
336 LOCATE 11,9:PRINT "Bajas de Alumnos."
338 LOCATE 11,41:PRINT CHR$(186)
340 LOCATE 11,49:PRINT "Listado alfab‚tico de Alumnos."
342 LOCATE 12,9:PRINT "Modificaci¢n de Alumnos."
344 LOCATE 12,41:PRINT CHR$(186)
346 LOCATE 12,49:PRINT "Listado de Alumnos de Baja."
348 LOCATE 13,9:PRINT "Consulta num‚rica de Alumnos."
350 LOCATE 13,41:PRINT CHR$(186)
352 LOCATE 13,49:PRINT "Listar Alumnos por Asignaturas."
354 LOCATE 14,9:PRINT "Consulta alfab‚tica de Alumnos."
356 LOCATE 14,41:PRINT CHR$(186)
358 LOCATE 14,49:PRINT "Listado de Alumnos por Cursos"
360 LOCATE 15,9:PRINT "Poner Asignaturas a los Alumnos."
361 LOCATE 15,41:PRINT CHR$(186)
362 LOCATE 15,49:PRINT "Recuperar Alumnos dados de Baja"
363 LOCATE 16,9:PRINT "Cambiar los Alumnos de Curso."
364 LOCATE 16,41:PRINT CHR$(186)
365 LOCATE 16,49:PRINT "Listado de Etiquetas.     "
376 LOCATE 19,23:COLOR 15:PRINT " ESC "+CHR$(205)+CHR$(205)+">":COLOR 10:LOCATE 19,31:PRINT " Fin de tratamiento de Alumnos":COLOR 10
378 GOSUB 8500
380 LOCATE 22,15:PRINT "Seleccione Opci¢n con las Flechas y Pulse la Tecla ";
382 COLOR 15
384 PRINT "<"+CHR$(196)+CHR$(217)
386 COLOR 10
388 '
390 FILA%=10:COLUMNA%=5:OPCIONES%=7
392 GOSUB 20000
394 IF ATRAS%=1 THEN 390
396 IF I.A%>OPCIONES% THEN 402
398 ON I.A% GOTO 510,2490,2490,2490,7402,7340,7350
400 '
402 FILA%=10:COLUMNA%=45:OPCIONES%=7
404 GOSUB 20000
406 IF ATRAS%=1 THEN 390
408 IF I.A%>OPCIONES% THEN 414
410 ON I.A% GOTO 7300,7310,7320,7330,7380,7390,7400
412 GOTO 300
414 '
416 '
418 GOTO 390
510 '
520 FALUDIR$="FRESALUM.ALF":FALUDAT$="FRESALUM.DAT"
600 GOSUB 30052:GOSUB 34030
610 '
612 TIT$="- ALTAS DE ALUMNOS DE HOSTELERIA -"
614 GOSUB 8000:GOSUB 31000
618 '
619 GOSUB 7650
630 '
632       '*******************************
634       '***ENTRADA NUMERO DE ALUMNO ***
636       '*******************************
638       COLOR 15
640       LOCATE 1,1:GET #2,1:N.ORDEN%=ULTIMO%+1
642       N$=STR$(N.ORDEN%):N$=LEFT$(CERO$,6-LEN(N$))+RIGHT$(N$,LEN(N$)-1)
643       GET #2,N.ORDEN%
644       CUENTA$=N$
656       '
658       '
661       GUAPRI#=N.ORDEN%:GOSUB 64770:LOCATE 6,19-L.C%:PRINT GUAPRI$
718       '
720       '********************
722       '***ENTRADA NOMBRE***
724       '********************
726       F.C1%=6:C.C1%=59:L.E%=20:BO%=20:GOSUB 64000
728       IF I.T%=0 THEN NOMBRA$=D.E$:SM%=1:GOTO 742
729       IF I.T%=5 THEN 726
730       IF I.T%=1 AND I.A%=1 THEN NOMBRA$="":GOTO 742
732       IF I.T%=1 AND I.A%=3 THEN NOMBRA$=CNOMBRE:GOTO 742
733       IF I.T%=3 AND I.A%=1 THEN LOCATE 6,59:PRINT SPC(20):GOTO 726
734       IF I.T%=3 THEN 726
736       IF I.T%=4 THEN 4000               'Fin Entrada.
738       IF I.T%=2 AND I.A%=1 THEN 742
740       IF I.T%=2 THEN 726
742       IF LEN(NOMBRA$)<20 THEN NOMBRA$=NOMBRA$+LEFT$(BLANCO$,20-LEN(NOMBRA$))
744       LOCATE 6,59:PRINT NOMBRA$
746       '
748       '***********************
750       '***ENTRADA APELLIDO1***
752       '***********************
754       F.C1%=7:C.C1%=14:L.E%=20:BO%=20:GOSUB 64000
756       IF I.T%=0 THEN APELL1$=D.E$:SM%=1:GOTO 770
757       IF I.T%=5 THEN 754
758       IF I.T%=1 AND I.A%=1 THEN 754
760       IF I.T%=1 AND I.A%=3 THEN APELL1$=CAPELL1:GOTO 770
761       IF I.T%=3 AND I.A%=1 THEN LOCATE 6,59:PRINT SPC(20):GOTO 726
762       IF I.T%=3 THEN 726
764       IF I.T%=4 THEN 4000               'Fin Entrada.
766       IF I.T%=2 AND I.A%=1 THEN 770
768       IF I.T%=2 THEN 750
770       IF LEFT$(APELL1$,1)=" " THEN 754
771       IF LEN(APELL1$)<20 THEN APELL1$=APELL1$+LEFT$(BLANCO$,20-LEN(APELL1$))
772       LOCATE 7,14:PRINT APELL1$
774       '
776       '***********************
778       '***ENTRADA APELLIDO2***
780       '***********************
782       F.C1%=7:C.C1%=59:L.E%=20:BO%=20:GOSUB 64000
784       IF I.T%=0 THEN APELL2$=D.E$:SM%=1:GOTO 798
785       IF I.T%=5 THEN 782
786       IF I.T%=1 AND I.A%=1 THEN APELL2$=" ":GOTO 798
788       IF I.T%=1 AND I.A%=3 THEN APELL2$=CAPELL2:GOTO 798
789       IF I.T%=3 AND I.A%=1 THEN LOCATE 7,14:PRINT SPC(20):GOTO 750
790       IF I.T%=3 THEN 750
792       IF I.T%=4 THEN 4000               'Fin Entrada.
794       IF I.T%=2 AND I.A%=1 THEN 798
796       IF I.T%=2 THEN 778
798       '
799       IF LEN(APELL2$)<20 THEN APELL2$=APELL2$+LEFT$(BLANCO$,20-LEN(APELL2$))
800       LOCATE 7,59:PRINT APELL2$
802       '
804       '***********************
806       '***ENTRADA DIRECCION***
808       '***********************
810       F.C1%=8:C.C1%=14:L.E%=40:BO%=40:GOSUB 64000
812       IF I.T%=0 THEN DIREC$=D.E$:GOTO 828
813       IF I.T%=5 THEN 810
814       IF I.T%=1 AND I.A%=1 THEN DIREC$="":GOTO 828
816       IF I.T%=1 AND I.A%=3 THEN DIREC$=CDIREC:GOTO 828
817       IF I.T%=3 AND I.A%=1 THEN LOCATE 7,59:PRINT SPC(20):GOTO 778
818       IF I.T%=3 THEN 778
820       IF I.T%=4 THEN 4000               'Fin Entrada.
822       IF I.T%=2 AND I.A%=1 THEN 828
824       IF I.T%=2 THEN 806
826       '
828       LOCATE 8,14:PRINT DIREC$
830       '
832       '***********************
834       '***ENTRADA POBLACION***
836       '***********************
838       F.C1%=9:C.C1%=14:L.E%=20:BO%=20:GOSUB 64000
840       IF I.T%=0 THEN POBLA$=D.E$:GOTO 856
841       IF I.T%=5 THEN 838
842       IF I.T%=1 AND I.A%=1 THEN POBLA$="":GOTO 856
844       IF I.T%=1 AND I.A%=3 THEN POBLA$=CPOBLA:GOTO 856
845       IF I.T%=3 AND I.A%=1 THEN LOCATE 8,14:PRINT SPC(40):GOTO 806
846       IF I.T%=3 THEN 806
848       IF I.T%=4 THEN 4000               'Fin Entrada.
850       IF I.T%=2 AND I.A%=1 THEN 856
852       IF I.T%=2 THEN 834
854       '
856       LOCATE 9,14:PRINT POBLA$
858       '
860       '***********************
862       '***ENTRADA PROVINCIA***
864       '***********************
866       F.C1%=9:C.C1%=59:L.E%=15:BO%=15:GOSUB 64000
868       IF I.T%=0 THEN PROVI$=D.E$:GOTO 884
869       IF I.T%=5 THEN 866
870       IF I.T%=1 AND I.A%=1 THEN PROVI$="":GOTO 884
872       IF I.T%=1 AND I.A%=3 THEN PROVI$=CPROVI:GOTO 884
873       IF I.T%=3 AND I.A%=1 THEN LOCATE 9,14:PRINT SPC(20):GOTO 834
874       IF I.T%=3 THEN 834
876       IF I.T%=4 THEN 4000               'Fin Entrada.
878       IF I.T%=2 AND I.A%=1 THEN 884
880       IF I.T%=2 THEN 866
882       '
884       LOCATE 9,59:PRINT PROVI$
886       '
888       '***************************
890       '***ENTRADA CODIGO POSTAL***
892       '***************************
894       F.C1%=10:C.C1%=14:L.E%=5:BO%=5:ESC%=1:GOSUB 63000
896       IF I.T%=0 THEN COPOS$=D.E$:GOTO 912
897       IF I.T%=5 THEN 894
898       IF I.T%=1 AND I.A%=1 THEN COPOS$="":GOTO 912
900       IF I.T%=1 AND I.A%=3 THEN COPOS$=CCOPOS:GOTO 912
901       IF I.T%=3 AND I.A%=1 THEN LOCATE 9,59:PRINT SPC(15):GOTO 866
902       IF I.T%=3 THEN 866
904       IF I.T%=4 THEN 4000               'Fin Entrada.
906       IF I.T%=2 AND I.A%=1 THEN 912
908       IF I.T%=2 THEN 894
910       '
912       LOCATE 10,14:PRINT COPOS$
914       '
916       '**********************
918       '***ENTRADA TELEFONO***
920       '**********************
922       F.C1%=10:C.C1%=59:L.E%=15:BO%=15:GOSUB 64000
924       IF I.T%=0 THEN TELEFO$=D.E$:GOTO 940
925       IF I.T%=5 THEN 922
926       IF I.T%=1 AND I.A%=1 THEN TELEFO$="":GOTO 940
928       IF I.T%=1 AND I.A%=3 THEN TELEFO$=CTELEFO+" "+CTELEFA:GOTO 940
929       IF I.T%=3 AND I.A%=1 THEN LOCATE 10,14:PRINT SPC(5):GOTO 894
930       IF I.T%=3 THEN 894
932       IF I.T%=4 THEN 4000               'Fin Entrada.
934       IF I.T%=2 AND I.A%=1 THEN 940
936       IF I.T%=2 THEN 918
938       '
940       IF LEN(TELEFO$)<15 THEN TELEFO$=TELEFO$+LEFT$(BLANCO$,15-LEN(TELEFO$))
942       LOCATE 10,59:PRINT TELEFO$
944       '
946       '**********************
948       '***ENTRADA D.N.I   ***
950       '**********************
952       F.C1%=11:C.C1%=14:L.E%=13:BO%=13:GOSUB 64000
954       IF I.T%=0 THEN DNI$=D.E$:GOTO 970
955       IF I.T%=5 THEN 952
956       IF I.T%=1 AND I.A%=1 THEN DNI$="":GOTO 972
958       IF I.T%=1 AND I.A%=3 THEN DNI$=CDNI:GOTO 972
959       IF I.T%=3 AND I.A%=1 THEN LOCATE 10,59:PRINT SPC(15):GOTO 918
960       IF I.T%=3 THEN 918
962       IF I.T%=4 THEN 4000               'Fin Entrada.
964       IF I.T%=2 AND I.A%=1 THEN 972
966       IF I.T%=2 THEN 948
968       '
970       '
972       LOCATE 11,14:PRINT DNI$
974       '
976       '**********************
978       '***ENTRADA GRUPO   ***
980       '**********************
982       F.C1%=11:C.C1%=59:L.E%=1:BO%=1:GOSUB 63000
983       IF I.T%=0 THEN CURSO$=D.E$:GOTO 1000
986       IF I.T%=5 THEN 982
987       IF I.T%=1 AND I.A%=1 THEN 982
988       IF I.T%=1 AND I.A%=3 THEN CURSO$=CCURSO:GOTO 1074
989       IF I.T%=3 AND I.A%=1 THEN LOCATE 11,14:PRINT SPC(13):GOTO 948
990       IF I.T%=3 THEN 948
992       IF I.T%=4 THEN 4000               'Fin Entrada.
994       IF I.T%=2 AND I.A%=1 THEN 1000
996       IF I.T%=2 THEN 978
998       '
1000      IF CURSO$=>"1" AND CURSO$<"6" THEN 1010
1004      GOSUB 8500:MEN$="Este Curso no existe, pulsar una tecla ":GOSUB 8500:A$=INPUT$(1)
1006      IF I.A%=1 THEN GOSUB 7650:GOTO 982
1008      GOSUB 7510:GOTO 982
1010       LOCATE 11,59:PRINT CURSO$
1011      IF CURSO$="1" THEN LOCATE 11,62:PRINT "PRIMERO":GOTO 1020
1012      IF CURSO$="2" THEN LOCATE 11,62:PRINT "SEGUNDO":GOTO 1020
1013      IF CURSO$="3" THEN LOCATE 11,62:PRINT "TERCERO":GOTO 1020
1014      IF CURSO$="4" THEN LOCATE 11,62:PRINT "CUARTO":GOTO 1020
1015      LOCATE 11,62:PRINT "QUINTO":GOTO 1020
1020      '
1072       '***********************
1074       '***ENTRADA DE FNACIM***
1076       '***********************
1078       F.C1%=12:C.C1%=14:L.E%=6:BO%=8:GOSUB 63000
1080       IF I.T%=0 THEN NACI$=D.E$:GOTO 1094
1081       IF I.T%=5 THEN 1078
1082       IF I.T%=1 AND I.A%=1 THEN 1078
1084       IF I.T%=1 AND I.A%=3 THEN NACI$=MID$(CFENA,5,2)+MID$(CFENA,3,2)+LEFT$(CFENA,2):GOTO 1094
1085       IF I.T%=3 AND I.A%=1 THEN LOCATE 11,59:PRINT SPC(1):LOCATE 11,62:PRINT SPC(10):GOTO 980
1086       IF I.T%=3 THEN 980
1088       IF I.T%=4 THEN 4000               'Fin Entrada.
1090       IF I.T%=2 AND I.A%=1 THEN 1094
1092       IF I.T%=2 THEN 1074
1094       FECSUB$=NACI$:GOSUB 60000
1095       IF ERF%<>1 THEN 1099
1096       BEEP:GOSUB 8500:MEN$="Fecha de Nacimiento Err¢nea, Pulsar una tecla":GOSUB 8500:A$=INPUT$(1):LOCATE 12,14:PRINT SPC(8)
1097       IF I.A%=1 THEN GOSUB 7650:GOTO 1074
1098       GOSUB 7500:GOTO 1074
1099       LOCATE 12,14:PRINT FDMA$:FENA$=FAMD$
1100       '*******************************
1101       '***ENTRADA FECHA DE ALTA    ***
1102       '*******************************
1103       '
1104       F.C1%=12:C.C1%=59:L.E%=6:BO%=8:ESC%=0:GOSUB 63000
1105       IF I.T%=0 THEN FALT$=D.E$:GOTO 1114 'Entrada OK
1106       IF I.T%=5 THEN 1104
1107       IF I.T%=1 AND I.A%=1 THEN FALT$=LEFT$(FECHA$,2)+MID$(FECHA$,4,2)+RIGHT$(FECHA$,2):GOTO 1114
1108       IF I.T%=1 AND I.A%=3  THEN FALT$=MID$(CFALTA,5,2)+MID$(CFALTA,3,2)+MID$(CFALTA,1,2):GOTO 1114
1109       IF I.T%=3 AND I.A%=3 THEN 1074               'Retroceder Campo.
1110       IF I.T%=3 AND I.A%=1 THEN LOCATE 12,14:PRINT SPC(8):GOTO 1074
1111       IF I.T%=4 THEN 4000               'Fin Entrada.
1112       IF I.T%=2 AND I.A%=3 THEN 1104
1113       IF I.T%=2 AND I.A%=1 THEN 1114
1114       '
1115       FECSUB$=FALT$:GOSUB 60000
1116       IF ERF%<>1 THEN 1120
1117       BEEP:GOSUB 8500:MEN$=" Fecha de Alta Err¢nea, pulsar una tecla":GOSUB 8500:A$=INPUT$(1):LOCATE 12,59:PRINT SPC(8)
1118       IF I.A%=1 THEN GOSUB 7650:GOTO 1104
1119       GOSUB 7500:GOTO 1104
1120       LOCATE 12,59:PRINT FDMA$:FEAL$=FAMD$
1500       '***********************
1502       '***ENTRADA DE BANCO ***
1504       '***********************
1506       F.C1%=13:C.C1%=14:L.E%=4:BO%=4:GOSUB 63000
1508       IF I.T%=0 THEN BANCA$=D.E$:GOTO 1526
1510       IF I.T%=5 THEN 1506
1512       IF I.T%=1 AND I.A%=1 THEN BANCA$=" ":CUBAN$=" ":GOTO 1606
1514       IF I.T%=1 AND I.A%=3 THEN BANCA$=CBANCO:GOTO 1540
1516       IF I.T%=3 AND I.A%=1 THEN LOCATE 12,59:PRINT SPC(8):GOTO 1104
1518       IF I.T%=3 THEN 1104
1520       IF I.T%=4 THEN 4000               'Fin Entrada.
1522       IF I.T%=2 AND I.A%=1 THEN 1526
1524       IF I.T%=2 THEN 1502
1526       BUSCA$=BANCA$:GOSUB 34260
1528       IF SW1%=0 THEN 1536
1530       GOSUB 8500:MEN$="Este Banco no existe, pulsar una tecla":GOSUB 8500:A$=INPUT$(1)
1532       IF I.A%=1 THEN GOSUB 7650:GOTO 1506
1534       GOSUB 7500:GOTO 1506
1536       LOCATE 13,14:PRINT BANCA$:LOCATE 13,19:PRINT LEFT$(BNOM,25)
1538       '***************************
1540       '***ENTRADA CTA.COMPENSA.***
1542       '***************************
1544       F.C1%=13:C.C1%=59:L.E%=10:BO%=10:GOSUB 63000
1546       IF I.T%=0 THEN CUBAN$=D.E$:GOTO 1564
1548       IF I.T%=5 THEN 1544
1550       IF I.T%=1 AND I.A%=1 THEN 1544
1552       IF I.T%=1 AND I.A%=3 THEN CUBAN$=CCUBAN:GOTO 1576
1554       IF I.T%=3 AND I.A%=1 THEN LOCATE 13,14:PRINT SPC(4):LOCATE 13,19:PRINT SPC(25):GOTO 1502
1556       IF I.T%=3 THEN 1502
1558       IF I.T%=4 THEN 4000               'Fin Entrada.
1560       IF I.T%=2 AND I.A%=1 THEN 1564
1562       IF I.T%=2 THEN 1540
1564       IF BANCA$<>"2095" THEN LOCATE 13,59:PRINT CUBAN$:GOTO 1576
1566       CUPRI$=LEFT$(CUBAN$,10):GOSUB 37000:CUBAN$=CUPRIF$
1567       IF DI%=0 THEN 1574
1568       BEEP:GOSUB 8500:MEN$="Cuenta Compensadora Err¢nea, pulsar una tecla":GOSUB 8500:A$=INPUT$(1)
1570       IF I.A%=1 THEN GOSUB 7650:GOTO 1544
1572       GOSUB 7500:GOTO 1544
1574       LOCATE 13,59:PRINT CUPRIE$
1576       '***************************
1578       '***ENTRADA SUCURSAL     ***
1580       '***************************
1582       F.C1%=14:C.C1%=14:L.E%=4:BO%=7:GOSUB 63000
1584       IF I.T%=0 THEN SUCUR$=D.E$:GOTO 1602
1586       IF I.T%=5 THEN 1582
1588       IF I.T%=1 AND I.A%=1 THEN 1582
1590       IF I.T%=1 AND I.A%=3 THEN SUCUR$=CSUCUR:GOTO 1606
1592       IF I.T%=3 AND I.A%=1 THEN LOCATE 13,59:PRINT SPC(17):GOTO 1542
1594       IF I.T%=3 THEN 1542
1596       IF I.T%=4 THEN 4000               'Fin Entrada.
1598       IF I.T%=2 AND I.A%=1 THEN 1602
1600       IF I.T%=2 THEN 1578
1602       '
1603       GOSUB 50000
1604       LOCATE 14,14:PRINT SUCUR$
1605       LOCATE 14,18:PRINT "-"DIGI$
1606       '
1612       '***************************
1614       '***ENTRADA IMPOR CUOTA  ***
1616       '***************************
1618       F.C1%=14:C.C1%=59:L.E%=7:BO%=8:ESC%=1:GOSUB 63000
1620       IF I.T%=0 THEN IMPOR#=VAL(D.E$):GOTO 1634
1621       IF I.T%=5 THEN 1618
1622       IF I.T%=1 AND I.A%=1 THEN 1618
1624       IF I.T%=1 AND I.A%=3 THEN IMPOR#=CVS(CIMPOR):GOTO 1636
1625       IF I.T%=3 AND I.A%=1 THEN LOCATE 14,14:PRINT SPC(20):GOTO 1580
1626       IF I.T%=3 THEN 1580
1628       IF I.T%=4 THEN 4000               'Fin Entrada.
1630       IF I.T%=2 AND I.A%=1 THEN 1634
1632       IF I.T%=2 THEN 1614
1634       GUAPRI#=IMPOR#:GOSUB 64770
1636       LOCATE 14,66-L.C%:PRINT GUAPRI$
1638       '
1642       '
1644       '***************************
1646       '***ENTRADA OBSERVACIO 1 ***
1648       '***************************
1650       F.C1%=16:C.C1%=23:L.E%=50:BO%=50:GOSUB 64000
1652       IF I.T%=0 THEN OBSE1$=D.E$:GOTO 1670
1654       IF I.T%=5 THEN 1648
1656       IF I.T%=1 AND I.A%=1 THEN OBSE1$="":GOTO 1670
1658       IF I.T%=1 AND I.A%=3 THEN OBSE1$=COBSE1:GOTO 1670
1660       IF I.T%=3 AND I.A%=1 THEN LOCATE 14,59:PRINT SPC(8):GOTO 1616
1662       IF I.T%=3 THEN 1616
1664       IF I.T%=4 THEN 4000               'Fin Entrada.
1666       IF I.T%=2 AND I.A%=1 THEN 1670
1668       IF I.T%=2 THEN 1648
1670       '
1672       LOCATE 16,23:PRINT OBSE1$
1674       '
1744       '***************************
1746       '***ENTRADA OBSERVACIO 2 ***
1748       '***************************
1750       F.C1%=17:C.C1%=23:L.E%=50:BO%=50:GOSUB 64000
1752       IF I.T%=0 THEN OBSE2$=D.E$:GOTO 1770
1754       IF I.T%=5 THEN 1748
1756       IF I.T%=1 AND I.A%=1 THEN OBSE2$="":GOTO 1770
1758       IF I.T%=1 AND I.A%=3 THEN OBSE2$=COBSE2:GOTO 1770
1760       IF I.T%=3 AND I.A%=1 THEN LOCATE 16,23:PRINT SPC(50):GOTO 1648
1762       IF I.T%=3 THEN 1648
1764       IF I.T%=4 THEN 4000               'Fin Entrada.
1766       IF I.T%=2 AND I.A%=1 THEN 1770
1768       IF I.T%=2 THEN 1748
1770       '
1772       LOCATE 17,23:PRINT OBSE2$
1774       '
1844       '***************************
1846       '***ENTRADA OBSERVACIO 2 ***
1848       '***************************
1850      'F.C1%=18:C.C1%=23:L.E%=50:BO%=50:GOSUB 64000
1852      'IF I.T%=0 THEN OBSE3$=D.E$:GOTO 1870
1854      'IF I.T%=5 THEN 1848
1856      'IF I.T%=1 AND I.A%=1 THEN OBSE3$="":GOTO 1870
1858      'IF I.T%=1 AND I.A%=3 THEN OBSE3$=COBSE3:GOTO 1870
1860      'IF I.T%=3 AND I.A%=1 THEN LOCATE 17,23:PRINT SPC(50):GOTO 1748
1862      'IF I.T%=3 THEN 1748
1864      'IF I.T%=4 THEN 4000               'Fin Entrada.
1866      'IF I.T%=2 AND I.A%=1 THEN 1870
1868      'IF I.T%=2 THEN 1848
1870       '
1872      'LOCATE 18,23:PRINT OBSE3$
1874       '
2000   '*************************************
2002   '***PEDIMOS CONFORMIDAD A LOS DATOS***
2004   '*************************************
2006   GOSUB 8500
2008   COLOR 10:LOCATE 22,15:PRINT "Datos Correctos ";
2010   COLOR 15:PRINT " ENTER ";
2012   COLOR 10:PRINT " Datos Erroneos ";
2014   COLOR 15:PRINT " F1 "
2016   COLOR 10
2018   '
2020   A$=INPUT$(1)
2022   IF ASC(A$)<13 OR ASC(A$)>14 THEN BEEP:GOTO 2020
2024   '
2026   IF ASC(A$)=14 AND I.A%=1 THEN 610
2028   IF ASC(A$)=14 AND I.A%=3 THEN 2545
2042   '
2043   LSET CCUENTA=CUENTA$:LSET CNOMBRE=NOMBRA$:LSET CAPELL1=APELL1$
2044   LSET CAPELL2=APELL2$:LSET CDIREC=DIREC$:LSET CPOBLA=POBLA$
2046   LSET CPROVI=PROVI$:LSET CCOPOS=COPOS$:LSET CTELEFO=LEFT$(TELEFO$,7):LSET CTELEFA=RIGHT$(TELEFO$,7)
2048   LSET CDNI=DNI$:LSET CCURSO=CURSO$:LSET CFENA=FENA$:LSET CMARCA="A"
2049   LSET CSTATUS="O":LSET CBANCO=BANCA$:LSET CCUBAN=CUBAN$:LSET CSUCUR=SUCUR$
2050   LSET CFALTA=FEAL$:LSET COBSE1=OBSE1$:LSET COBSE2=OBSE2$:LSET CIMPOR=MKD$(IMPOR#):LSET COBSE3=OBSE3$:LSET CCONFI=CONFI$:LSET CFILL="":LSET CDIGI=DIGI$
2052   IF I.A%=3 THEN 2100   'REGRABAR EN CASO DE MODIFICACION.
2053   LSET CFACT="0000":PUT #2,N.ORDEN%:VIVAS%=VIVAS%+1:GET #2,1:LSET CULTI=MKI$(N.ORDEN%):LSET CVIGO=MKI$(VIVAS%):PUT #2,1
2054   'GRABAMOS DIR.
2055   ULTIAL%=ULTIAL%+1
2056   GET #1,ULTIAL%
2058   LSET FULTI=MKI$(N.ORDEN%)
2059   LSET FLLAMA=NOMBRA$:LSET FAPE1=APELL1$:LSET FAPE2=APELL2$
2060   LSET FILER="  "
2062   LSET FSTA="O"
2064   PUT #1,ULTIAL%
2066   'REGRABAMOS 1 DIR.
2068   GET #1,1
2070   LSET FULTI=MKI$(ULTIAL%)
2080   PUT #1,1
2088   '
2090   '
2092   CLOSE:GOTO 600
2094   '
2096   '
2098   '
2100   'REGRABAR EN CASO DE MODIFICACION.
2102   LSET CMARCA="M":PUT #2,N.L%
2104   IF SM%=0 THEN 2420
2108   SM%=0
2110   GET #2,1:LSET CSWA="1":PUT #2,1
2120   FOR NUM%=2 TO ULTIAL%
2130   GET #1,NUM%
2140   IF CVI(FULTI)<>N.L% THEN 2200
2150   LSET FLLAMA=NOMBRA$:LSET FAPE1=APELL1$:LSET FAPE2=APELL2$
2160   PUT #1,NUM%
2170   GOTO 2420
2200   NEXT NUM%
2260   '
2420   '
2430   CLOSE:GOTO 2540
2440 '
2450 '
2460 '
2488 '
2490 '**********************************************
2495 '***PARTE COMUN BAJA,MODIFICACION Y CONSULTA***
2500 '**********************************************
2505 '
2510 IF I.A%=2 THEN TIT$="- BAJAS DE ALUMNOS DE HOSTELERIA -"
2515 IF I.A%=4 THEN TIT$="- CONSULTA DE ALUMNOS DE HOSTELERIA -"
2520 IF I.A%=3 THEN TIT$="- MODIFICACION DE ALUMNOS DE HOSTELERIA -"
2525 '
2530 GOSUB 8500:MEN$="Espere por favor......":GOSUB 8500
2535 FALUDIR$="FRESALUM.ALF":FALUDAT$="FRESALUM.DAT"
2540 GOSUB 30052:GOSUB 34030
2545 GOSUB 8000:GOSUB 31000
2550 IF I.A%=2 THEN GOSUB 7405
2555 IF I.A%=3 THEN GOSUB 7500
2560 IF I.A%=4 THEN GOSUB 7800
2565       '*******************************
2570       '***ENTRADA NUMERO DE ALUMNO ***
2575       '*******************************
2580       COLOR 15
2585       F.C1%=6:C.C1%=14:L.E%=5:BO%=6:ESC%=1:GOSUB 63000
2590       IF I.T%=0 THEN CUENTA$=D.E$:GOTO 2635 'Entrada OK
2595       IF I.T%=5 THEN 2585
2600       IF I.T%=1 AND I.A%=1 THEN 2585
2605       IF I.T%=1 THEN 2570
2610       IF I.T%=3 THEN 2570                 'Retroceder Campo.
2615       IF I.T%=4 THEN 4000               'Fin Entrada.
2620       IF I.T%=2 AND I.A%=1 THEN 2635
2625       IF I.T%=2 THEN 2570
2630       '
2635       '
2640       GUAPRI#=VAL(CUENTA$):GOSUB 64770:LOCATE 6,19-L.C%:PRINT GUAPRI$:BUSCA$=CUENTA$
2642       N.L%=VAL(CUENTA$)
2645       IF N.L%<2 OR N.L%>ULTIMO% THEN GOSUB 8500:MEN$="Este N£mero de Alumno no existe, pulsar una tecla":GOSUB 8500:A$=INPUT$(1):GOTO 2550
2650       GET #2,N.L%
2655       IF I.A%<>4 AND CMARCA="L" THEN GOSUB 8500:MEN$="Alumno dado de BAJA, pulsar una tecla":GOSUB 8500:A$=INPUT$(1):GOTO 2550
2660       GOSUB 2700   'PRESENTAR DATOS EN PANTALLA.
2665       IF I.A%=2 THEN 2990
2670       IF I.A%=4 THEN 3240
2675       GOTO 3400
2700 '***********************************
2702 '***PRESENTAMOS DATOS EN PANTALLA***
2704 '***********************************
2728 COLOR 15
2730 LOCATE 6,59:PRINT CNOMBRE
2740 LOCATE 7,14:PRINT CAPELL1
2750 LOCATE 7,59:PRINT CAPELL2
2760 LOCATE 8,14:PRINT CDIREC
2770 LOCATE 9,14:PRINT CPOBLA
2780 LOCATE 9,59:PRINT CPROVI
2790 LOCATE 10,14:PRINT CCOPOS
2800 LOCATE 10,59:PRINT CTELEFO+" "+CTELEFA
2810 LOCATE 11,14:PRINT CDNI
2820 LOCATE 11,59:PRINT CCURSO
2825 IF CCURSO="1" THEN LOCATE 11,62:PRINT "PRIMERO":GOTO 2840
2826 IF CCURSO="2" THEN LOCATE 11,62:PRINT "SEGUNDO":GOTO 2840
2828 IF CCURSO="3" THEN LOCATE 11,62:PRINT "TERCERO":GOTO 2840
2830 IF CCURSO="4" THEN LOCATE 11,62:PRINT "CUARTO":GOTO 2840
2832 LOCATE 11,62:PRINT "QUINTO":GOTO 2840
2840 LOCATE 12,14:PRINT RIGHT$(CFENA,2)"-"MID$(CFENA,3,2)"-"LEFT$(CFENA,2)
2845 LOCATE 12,59:PRINT RIGHT$(CFALTA,2)"-"MID$(CFALTA,3,2)"-"LEFT$(CFALTA,2)
2871 BUSCA$=CBANCO:GOSUB 34260
2872 IF SW1%=0 THEN BA$=LEFT$(BNOM,25):BANC$=CBANCO:GOTO 2874
2873 BA$="NO EXISTE":BANC$=""
2874 LOCATE 13,14:PRINT BANC$
2875 LOCATE 13,19:PRINT BA$
2876 IF CBANCO<>"2095" THEN 2881
2877 CUPRI$=LEFT$(CCUBAN,10):EDI$="1":GOSUB 37000
2878 IF DI%=1 THEN 2881
2879 '
2880 LOCATE 13,59:PRINT CUPRIE$:GOTO 2882
2881 LOCATE 13,59:PRINT CCUBAN
2882 LOCATE 14,14:PRINT CSUCUR"-"CDIGI
2884 GUAPRI#=CVD(CIMPOR):GOSUB 64770
2886 LOCATE 14,66-L.C%:PRINT GUAPRI$
2887 LOCATE 16,23:PRINT COBSE1
2888 LOCATE 17,23:PRINT COBSE2
2889 LOCATE 18,23:PRINT COBSE3
2890 GOTO 2970     'IF I.A%<>4 THEN 2970
2891 LOCATE 19,14:PRINT USING "###";CVI(CGR01)
2892 LOCATE 19,21:PRINT USING "###";CVI(CGR02)
2893 LOCATE 19,28:PRINT USING "###";CVI(CGR03)
2894 LOCATE 19,35:PRINT USING "###";CVI(CGR04)
2895 LOCATE 19,42:PRINT USING "###";CVI(CGR05)
2896 LOCATE 19,49:PRINT USING "###";CVI(CGR06)
2897 LOCATE 19,56:PRINT USING "###";CVI(CGR07)
2898 LOCATE 19,63:PRINT USING "###";CVI(CGR08)
2899 LOCATE 19,70:PRINT USING "###";CVI(CGR09)
2900 LOCATE 19,77:PRINT USING "###";CVI(CGR10)
2901 LOCATE 20,14:PRINT USING "###";CVI(CGR11)
2902 LOCATE 20,21:PRINT USING "###";CVI(CGR12)
2903 LOCATE 20,28:PRINT USING "###";CVI(CGR13)
2904 LOCATE 20,35:PRINT USING "###";CVI(CGR14)
2905 LOCATE 20,42:PRINT USING "###";CVI(CGR15)
2906 LOCATE 20,49:PRINT USING "###";CVI(CGR16)
2907 LOCATE 20,56:PRINT USING "###";CVI(CGR17)
2908 LOCATE 20,63:PRINT USING "###";CVI(CGR18)
2909 LOCATE 20,70:PRINT USING "###";CVI(CGR19)
2910 LOCATE 20,77:PRINT USING "###";CVI(CGR20)
2962 GUAPRI#=VIVAS%:GOSUB 64770:COLOR 11
2964 LOCATE 21,29:PRINT "Alumnos en vigor : ":COLOR 15
2966 LOCATE 21,52-L.C%:PRINT GUAPRI$
2970 IF CMARCA<>"L" THEN RETURN
2972 COLOR 19:LOCATE 4,61:PRINT "ALUMNO DADO DE BAJA":COLOR 15
2975 RETURN
2980 '*************************
2990 '***TRATAMIENTO DE BAJA***
3000 '*************************
3010 GOSUB 8500:COLOR 10
3020 LOCATE 22,15:PRINT "DAR DE BAJA ";
3030 COLOR 15:PRINT " ENTER ";
3040 COLOR 10:PRINT " NO DAR DE BAJA ";
3050 COLOR 15:PRINT " F1 "
3055 A$=INPUT$(1)
3057 IF ASC(A$)<13 OR ASC(A$)>14 THEN BEEP:GOTO 3055
3060 IF ASC(A$)=14 THEN 2545
3061 'GRU%(13)=CVI(CGR13):GRU%(14)=CVI(CGR14):GRU%(15)=CVI(CGR15):GRU%(1)=CVI(CGR01):GRU%(2)=CVI(CGR02):GRU%(3)=CVI(CGR03):GRU%(4)=CVI(CGR04)
3062 'GRU%(16)=CVI(CGR16):GRU%(17)=CVI(CGR17):GRU%(18)=CVI(CGR18):GRU%(5)=CVI(CGR05):GRU%(6)=CVI(CGR06):GRU%(7)=CVI(CGR07):GRU%(8)=CVI(CGR08)
3063 'GRU%(9)=CVI(CGR09):GRU%(10)=CVI(CGR10):GRU%(11)=CVI(CGR11):GRU%(12)=CVI(CGR12):GRU%(19)=CVI(CGR19):GRU%(20)=CVI(CGR20)
3064 LSET CMARCA="L"
3065 PUT #2,N.L%
3066 VIVAS%=VIVAS%-1
3067 GET #2,1:LSET CVIGO=MKI$(VIVAS%)
3068 PUT #2,1
3095 '
3100 'GOSUB 8500:MEN$=" Alumno dado de Baja ":RET%=1:GOSUB 8500
3102 'GOSUB 7650
3104 GOTO 2545
3200 '
3210 '
3220 '
3230 '*****************************
3240 '***TRATAMIENTO DE CONSULTA***
3250 '*****************************
3260 GOSUB 8500:MEN$="   Pulse una tecla para nueva consulta   ":GOSUB 8500
3270 A$=INPUT$(1)      ':GOSUB 7650:LOCATE 8,56:PRINT SPC(20)
3280 GOTO 2545
3290 '
3300 '
3310 '
3400 '*****************************
3410 '***MODIFICACION DE ALUMNOS***
3420 '*****************************
3430 '
3440 GOTO 720     'PASAMOS POR EL ALTA
3450 '
3460 '
4000 '**************************
4010 '***FIN ENTRADA DE DATOS***
4020 '**************************
4030 CLS
4040 CLOSE   'Cierre de los Ficheros.
4050 GOTO 302      'Volvemos al Menu.
4060 '
7300 RUN "PRESLANU"  'LISTAR ALUMNOS ORDEN DE NUMERO
7310 RUN "PRESLAAL"  'LISTAR ALUMNOS ORDEN ALFABETICO
7320 RUN "PRESLABA"  'LISTAR ALUMNOS DADOS DE BAJA
7330 RUN "PRESLAGR"  'LISTAR ALUMNOS POR GRUPOS
7340 RUN "PRESDIST"  'PONER ASIGNATURAS A LOS ALUMNOS
7350 RUN "PRESCANC"  'CAMBIAR DE CURSO A LOS ALUMNOS
7380 RUN "PRESLACU"  'LISTAR ALUMNOS POR CURSOS
7390 RUN "PRESREAL"  'RECUPERAR ALUMNOS DADOS DE BAJA
7400 RUN "PRESETIQ"  'LISTAR ETIQUETAS DE ALUMNOS
7402 RUN "PRESCOAL"  'CONSULTA ALFABETICA ALUMNOS
7405 '***********************************************************
7410 '***PRESENTAMOS MENSAJES TECLAS DE FUNCION BAJAS         ***
7420 '***********************************************************
7430 GOSUB 8500:LOCATE 22,14
7460 COLOR 10:PRINT " F7 =>";
7470 COLOR 15:PRINT " Fin de Bajas de Alumnos "
7480 '
7490 RETURN
7500 '***********************************************************
7510 '***PRESENTAMOS MENSAJES TECLAS DE FUNCION MODIFICACIONES***
7520 '***********************************************************
7530 GOSUB 8500:LOCATE 22,14
7532 'COLOR 10:PRINT "F1 =>";
7534 'COLOR 15:PRINT " Ayuda ";
7540 COLOR 10:PRINT " ENTER =>";
7550 COLOR 15:PRINT " Saltar ";
7560 COLOR 10:PRINT " F7 =>";
7570 COLOR 15:PRINT " Fin Modif. ";
7580 COLOR 10:PRINT " F8 =>";
7590 COLOR 15:PRINT " Campo Atr s"
7600 '
7610 '
7620 '
7630 RETURN
7640 '**************************************************
7650 '***PRESENTAMOS MENSAJES TECLAS DE FUNCION ALTAS***
7660 '**************************************************
7670 GOSUB 8500:LOCATE 22,14
7672 'COLOR 10:PRINT " F1 =>";
7674 'COLOR 15:PRINT " Ayuda ";
7680 COLOR 10:PRINT " ENTER =>";
7690 COLOR 15:PRINT " Saltar ";
7700 COLOR 10:PRINT " F7 =>";
7710 COLOR 15:PRINT " Fin Altas ";
7720 COLOR 10:PRINT " F8 =>";
7730 COLOR 15:PRINT " Campo Atr s ";
7740 COLOR 10:PRINT " F10 =>";
7750 COLOR 15:PRINT " Dup."
7760 '
7770 RETURN
7800 '***********************************************************
7810 '***PRESENTAMOS MENSAJES TECLAS DE FUNCION CONSULTAS     ***
7820 '***********************************************************
7830 GOSUB 8500:LOCATE 22,14
7860 COLOR 10:PRINT " F7 =>";
7870 COLOR 15:PRINT " Fin de Consultas de Alumnos "
7880 '
7890 RETURN
8000 '***********************************************
8010 '***  RUTINA PARA SACAR CARATULA EN PANTALLA ***
8020 '***********************************************
8030 '
8040 CLS:COLOR 10:LOCATE 1,1:PRINT CHR$(201)+STRING$(78,205)+CHR$(187)
8050 LOCATE 2,1:PRINT CHR$(186):COLOR 11:LOCATE 2,3:PRINT EMPRESA$:COLOR 10:LOCATE 2,34:PRINT "Aplicaci¢n : HOSTELERIA ":COLOR 11:LOCATE 2,63:PRINT "FECHA : "FECHA$" ":COLOR 10 : LOCATE 2,80 :PRINT CHR$(186)
8060 LOCATE 3,1:PRINT CHR$(200)+STRING$(78,205)+CHR$(188)
8070 'FOR J%=4 TO 21 :LOCATE J%,1:PRINT CHR$(186):LOCATE J%,80 :PRINT CHR$(186):NEXT
8080 LOCATE 21,1:PRINT CHR$(201)+STRING$(78,205)+CHR$(187)
8090 LOCATE 22,1:PRINT CHR$(186):COLOR 11:LOCATE 22,3:PRINT "Mensajes: ":COLOR 10:LOCATE 22,80:PRINT CHR$(186)
8100 LOCATE 23,1:PRINT CHR$(200)+STRING$(78,205)+CHR$(188);
8110 COLOR 15:RETURN
8120 '
8250 '
8490 '*************************
8500 '***IMPRESION DE MENSAJES*
8510 '*************************
8515 '
8520 COLOR 10:L.L$="Mensajes: "+MEN$+"":LOCATE 22,3:PRINT L.L$;
8525 IF RET%=1 THEN FOR H=1 TO 7500:NEXT H:RET%=0
8530 MEN$=SPACE$(66)
8540 RETURN
8550 '
9000 '**********************
9010 '***FIN DEL PROGRAMA***
9020 '**********************
9030 CLOSE
9040 RUN "PRESINIC"
9050 END
9060 '
9070 '
9080 '
9090 '
9100 '*******************************
9110 '***RUTINA CONTROL DE ERRORES***
9120 '*******************************
9130 IF ERR=24 OR ERR=25 OR ERR=27 THEN GOSUB 8500:MEN$="--COMPRUEBE LA IMPRESORA Y PULSE UNA TECLA---":GOSUB 8500:A$=INPUT$(1):RESUME
9140 GOTO 9150
9142 GOSUB 8500:MEN$="Fichero FRESALUM.DIR inexistente, pulsar una tecla":GOSUB 8500:A$=INPUT$(1):CLOSE:GOTO 9000
9144 GOSUB 8500:MEN$="Fichero FRESALUM.DAT inexistente, pulsar una tecla":GOSUB 8500:A$=INPUT$(1):CLOSE:GOTO 9000
9150 '
9170 ON ERROR GOTO 0
9180 '
20000 '********************************************
20010 '*** RATONCITO PARA SELECCIONAR OPCIONES  ***
20020 '********************************************
20030 '***                                      ***
20040 '*** FILA%=FILA DONDE APARECERA EL RATON  ***
20050 '***                                      ***
20060 '*** COLUMNA%=COLUMNA DONDE APARECERA EL  ***
20070 '***          RATON                       ***
20080 '***                                      ***
20090 '*** OPCIONES%=NUMERO DE OPCIONES         ***
20100 '***                                      ***
20110 '*** CON ESC SALE A LA SENTENCIA 9000     ***
20120 '***                                      ***
20130 '********************************************
20140 '
20150 R$=CHR$(0):ATRAS%=0
20160 FOR I.A%=1 TO OPCIONES%
20170 COLOR 15:LOCATE FILA%,COLUMNA%:PRINT CHR$(205)+CHR$(205)+">"
20180 COLOR 10:R$=INKEY$:IF R$="" THEN 20180
20190 IF ASC(R$)=27 THEN 9000
20200 IF R$=CHR$(0)+CHR$(80) THEN R$=CHR$(31)
20210 IF R$=CHR$(0)+CHR$(72) THEN R$=CHR$(30)
20220 IF R$="2" THEN R$=CHR$(31)
20230 IF R$="8" THEN R$=CHR$(30)
20240 IF ASC(R$)=13 OR ASC(R$)=30 OR ASC(R$)=31 THEN 20250  ELSE 20180
20250 IF ASC(R$)=13 THEN RETURN
20260 LOCATE FILA%,COLUMNA%:PRINT "   "
20270 IF ASC(R$)=30 AND I.A%=1 THEN ATRAS%=1:RETURN
20280 IF ASC(R$)=30 THEN FILA%=FILA%-1:I.A%=I.A%-1:GOTO 20170 'AL NEXT
20290 FILA%=FILA%+1
20300 NEXT I.A%
20310 RETURN
20320 'ESTO SE ACABA
20330 '
30000 '*******************************
30010 '***APERTURA FICHERO ALUMNOS ***
30020 '*******************************
30025 '
30052 OPEN "R",#1,FALUDIR$,65
30054 FIELD #1,2 AS FULTI,20 AS FLLAMA,20 AS FAPE1,20 AS FAPE2,2 AS FILER,1 AS FSTA
30056 GET #1,1
30058  ULTIAL%=CVI(FULTI)
30090 ' Apertura del fichero de datos   FACAALUM.DAT
30100 OPEN "R",#2,FALUDAT$,350
30110 FIELD #2,5 AS CCUENTA,1 AS CSTATUS,20 AS CNOMBRE,20 AS CAPELL1,20 AS CAPELL2,40 AS CDIREC,20 AS CPOBLA,15 AS CPROVI,5 AS CCOPOS,7 AS CTELEFO,7 AS CTELEFA,13 AS CDNI,1 AS CCURSO
30112 FIELD #2,174 AS TODO1$,6 AS CFENA,4 AS CBANCO,4 AS CSUCUR,2 AS CDIGI,14 AS CVVV,10 AS CCUBAN,7 AS CBBBB,6 AS CFALTA,1 AS CMARCA,50 AS COBSE1,50 AS COBSE2,4 AS CFACT
30113 FIELD #2,250 AS TODO3$,82 AS TODO4$,8 AS CIMPOR,10 AS CFILL
30114 FIELD #2,5 AS CCUEN1,1 AS CSTAT,2 AS CULTI,2 AS CULTACT,12 AS CFICHER,1 AS CSWG,1 AS CSWA,2 AS CVIGO,235 AS REST1$,4 AS CFEFAC,85 AS REST2$
30115 GET #2,1
30116  IF CFICHER<>"FRESALUM.DAT" THEN 9144
30117  ULTIMO%=CVI(CULTI)
30118  ULTACT%=CVI(CULTACT):N.R%=ULTACT%
30120  VIVAS%=CVI(CVIGO)
30122 'LSET CCUEN1="":LSET CSTAT="A":LSET CULTI=MKI$(1):LSET CULTACT=MKI$(1)
30124 'LSET CFICHER="FRESALUM.DAT":LSET CSWG="0":LSET CSWA="0"
30126 'LSET CVIGO=MKI$(0):LSET REST1$="":LSET CFEFAC="0000":LSET REST2$=""
30128 'PUT #2,1
30130 'CLOSE
30132 'STOP
30140 RETURN
30150 '
31000 '**********************************************
31010 '***PRESENTAMOS PANTALLA DE ENTRADA DE DATOS***
31020 '**********************************************
31030 COLOR 10:X%=80-LEN(TIT$):X%=INT(X%/2)
31040 LOCATE 4,X%:PRINT TIT$
31042 LOCATE 5,X%:PRINT STRING$(LEN(TIT$),205)
31050 COLOR 11:LOCATE 6,1:PRINT "Alumno N§ : <" SPACE$(6) ">"
31052 LOCATE 6,46:PRINT "Nombre    : <" SPACE$(20) ">"
31054 LOCATE 7,1:PRINT "Apellido 1: <" SPACE$(20) ">"
31056 LOCATE 7,46:PRINT "Apellido 2: <" SPACE$(20) ">"
31058 LOCATE 8,1:PRINT "Direcci¢n : <" SPACE$(40) ">"
31060 LOCATE 9,1:PRINT "Poblaci¢n : <" SPACE$(20) ">"
31062 LOCATE 9,46:PRINT "Provincia : <" SPACE$(15) ">"
31064 LOCATE 10,1:PRINT "CD.Postal : <" SPACE$(5) ">"
31066 LOCATE 10,46:PRINT "Tel‚fonos : <" SPACE$(15) ">"
31068 LOCATE 11,1:PRINT "D.N.I.    : <" SPACE$(13) ">"
31070 LOCATE 11,46:PRINT "Curso     : <" SPACE$(1) ">"
31092 LOCATE 12,1:PRINT "F. Nacim. : <"SPACE$(8) ">"
31094 LOCATE 12,46:PRINT "F. Alta.  : <        >"
31196 LOCATE 13,1:PRINT "Banco     : <" SPACE$(4) ">"
31198 LOCATE 13,46:PRINT "N.Cuenta  : <" SPACE$(10) ">"
31199 LOCATE 14,1:PRINT "Sucursal  : <" SPACE$(7) ">"
31200 LOCATE 14,46:PRINT "Importe   : <" SPACE$(8) ">"
31201 LOCATE 16,6:PRINT "Observaciones 1 <" SPACE$(50) ">"
31202 LOCATE 17,6:PRINT "              2 <" SPACE$(50) ">"
31260 COLOR 15:RETURN
31270 '
33000 '**********************************
33010 '***APERTURA FICHERO DATOS FIJOS***
33020 '**********************************
33030 OPEN "R",#1,"FDATFIJ.DAT",100
33040 FIELD #1,2 AS NRO$,8 AS NDIRE$,30 AS NEMPRESA$,15 AS NNIF$,8 AS NPROG$,37 AS NFILLER$
33050 GET #1,1
33052 NROEM$=NRO$
33060 DIRE$=NDIRE$
33070 EMPRESA$="** ESCUELA DE HOSTELERIA **"
33080 NIF$=NNIF$
33082 PROGRAMA$=NPROG$
33090 CLOSE
33100 '
33110 '
33120 RETURN
33130 '
34000 '*****************************
34010 '***APERTURA FICHERO BANCOS***
34020 '*****************************
34030 FICHE1$="FACABANC.DAT"
34040 '
34050 'APERTURA FICHERO DE DATOS.
34060 OPEN "R",#3,FICHE1$,125
34070 'REGISTRO 1.
34080 FIELD #3,2 AS BULTIMO,2 AS BALTAS,2 AS BULTACT,12 AS BETIQUETA,106 AS BFILLER,1 AS BSTATUS
34090 'REGISTRO DE DATOS.
34100 FIELD #3,4 AS BANCO,30 AS BNOM,30 AS BDIREC,5 AS BCPOS,30 AS BPOBLA,20 AS BPROV,5 AS BFIL001,1 AS BSTATUS
34110 GET #3,1
34120 IF BETIQUETA="FACABANC.DAT" THEN 34160  'CONTINUAR
34130 GOSUB 8500:MEN$="NO EXISTE FICHERO BANCOS, PULSE UNA TECLA":GOSUB 8500
34140 A$=INPUT$(1)
34150 GOTO 9000
34160 'CONTINUAR.
34170 ULTDIR%=CVI(BULTIMO)    'ULTIMO INTRODUCIDO EN DIR.
34180 ULTBAN%=ULTDIR%         'ULTIMO PARA LA BUSQUEDA.
34190 ALTDIR%=CVI(BALTAS)     'NUMERO DE ALTAS EN DIR.
34200 ACTDIR%=CVI(BULTACT)    'ULTIMO NUMERO ACTUALIZADO EN DIR.
34210 N.B%=ACTDIR%            'NUMEO DE REGSITROS EN EL DIR.
34220 '
34230 RETURN
34240 '
34250 '*************************
34260 '***LECTURA AZAR BANCOS***
34270 '*************************
34280 'El argumento de busqueda sobre 'BUSCA$'
34290 'El numero de registros sobre 'N.B%'
34300 R.B%=0           'Donde devuelve el nro. de registro.
34310 R.W%=0           'Donde devuelve el nro. de registro del DIR.
34320 SW1%=0         'SW indicador de la busqueda.
34330 REG1%=0:REG2%=0:SW100%=0:DES%=0:HAS%=0
34340 '
34350 R.I%=INT((N.B%/2)+.5)
34360 R.C%=R.I%
34370 IF R.I%<1 THEN SW1%=1:DES%=2:HAS%=R.I%+R.C%:GOTO 34490
34380 IF R.I%>N.B% THEN SW1%=1:DES%=R.I%-R.C%:HAS%=N.B%:GOTO 34490
34390 IF R.I%=1 THEN R.I%=2:GET #3,R.I% ELSE GET #3,R.I%
34400 IF BANCO=BUSCA$ THEN R.W%=R.I%:R.B%=R.I%:GOTO 34660      'MIRAR STATUS
34410 R.C%=INT((R.C%/2)+.5):IF R.C%=R.I% THEN R.C%=R.I%-1
34420 IF BANCO>BUSCA$ THEN R.I%=R.I%-R.C%:GOTO 34440
34430 R.I%=R.I%+R.C%
34440 IF SW100%=0 AND REG1%=R.I% THEN R.I%=0:GOTO 34370
34450 IF SW100%=1 AND REG2%=R.I% THEN R.I%=0:GOTO 34370
34460 IF SW100%=0 THEN REG1%=R.I%:SW100%=1:GOTO 34370
34470 REG2%=R.I%:SW100%=0
34480 GOTO 34370
34490 'REGISTRO NO BUSCADO.
34500 XX%=0
34510 FOR A%=DES% TO HAS%
34520   GET #3,A%
34530   IF BANCO=BUSCA$ THEN SW1%=0:R.W%=A%:R.B%=A%:XX%=1:A%=HAS%
34540 NEXT A%
34550 IF XX%=1 THEN 34660
34560 '
34570 '
34580 'Registro NO BUSCADO
34590 XX%=0
34600 IF N.B%=0 THEN N.B%=1
34610 FOR JMG%=N.B% TO ULTBAN%
34620     GET #3,JMG%
34630     IF BANCO=BUSCA$ THEN SW1%=0:R.W%=JMG%:R.B%=JMG%:XX%=1:JMG%=32000
34640 NEXT JMG%
34650 IF XX%=0 THEN SW1%=1:WSTATUS$="":RETURN
34660 'MIRAMOS STATUS.
34670 IF BSTATUS<>"O" THEN WSTATUS$="L":SW1%=1:RETURN
34680 WSTATUS$=""
34690 RETURN
34700 '
36000 '**********************************************
36010 '***PRESENTAMOS PANTALLA DE ENTRADA DE DATOS***
36020 '**********************************************
36030 COLOR 10:X%=80-LEN(TIT$):X%=INT(X%/2)
36040 LOCATE 5,X%:PRINT TIT$
36042 LOCATE 6,X%:PRINT STRING$(LEN(TIT$),205)
36052 LOCATE 8,24:PRINT "Nombre    : <" SPACE$(20) ">"
36054 LOCATE 9,24:PRINT "Apellido 1: <" SPACE$(20) ">"
36056 LOCATE 10,24:PRINT "Apellido 2: <" SPACE$(20) ">"
36058 RETURN
37000 '*******************************************************************
37002 '*                                                                 *
37004 '*  RUTINA PARA VERIFICAR NUMEROS DE CUENTA Y SUS DIGITOS          *
37006 '*                                                                 *
37008 '*  ENTRADA NUMERO CUENTA EN -- CUPRI$ --                          *
37010 '*                                                                 *
37012 '*  SALIDA BUENA   DI%     = 0                                     *
37014 '*                 CUPRIF$ = CUENTA FORMATEADA PARA FICHEROS       *
37016 '*                 CUPRIE$ = CUENTA EDITADA PARA LISTADOS          *
37018 '*                                                                 *
37020 '*  SALIDA MALA    DI% = 1                                         *
37022 '*                                                                 *
37024 '*******************************************************************
37026 DIG%=0:N1%=0:N2%=0:N3%=0:N4%=0:N5%=0:N6%=0:N7%=0:N8%=0:N9%=0:DI%=0:N10%=0
37028 IF MID$(CUPRI$,1,1)>"2" THEN 37134
37030 IF MID$(CUPRI$,1,2) = "27" THEN 37046
37032 IF MID$(CUPRI$,1,1) <> "2" THEN 37046
37034 IF LEN(CUPRI$)<6 THEN 37204
37036 LN%=LEN(CUPRI$)-4:LC%=10-LEN(CUPRI$)
37038 CUPRIF$=LEFT$(CUPRI$,4)+LEFT$(CERO$,LC%)+RIGHT$(CUPRI$,LN%)
37040 CUPRIE$=CUPRIF$
37042 IF EDI$="1" THEN EDI$="0":RETURN
37044 D.E$="0"+MID$(CUPRIF$,2,9):GOTO 37074
37046 '
37048  IF MID$(CUPRI$,1,2) = "10" OR MID$(CUPRI$,1,2)="15" THEN 37052
37050 GOTO 37204
37052 IF LEN(CUPRI$)<4 THEN 37204
37054 LN%=LEN(CUPRI$)-2:LC%=10-LEN(CUPRI$)
37056 CUPRIF$=MID$(CUPRI$,1,2)+LEFT$(CERO$,LC%)+MID$(CUPRI$,3,LN%)
37058 CUPRIE$=CUPRIF$
37060 IF EDI$="1" THEN EDI$="0":RETURN
37062 D.E$=MID$(CUPRIF$,1,2)+LEFT$(CERO$,LC%)+RIGHT$(CUPRIF$,LN%)
37064 ' IF MID$(D.E$,1,2) = "30" THEN 37370
37066 IF MID$(D.E$,3,2)<"11" THEN MID$(D.E$,1,2)="00":GOTO 37074
37068 MID$(D.E$,1,2)="01"
37070 GOTO 37074
37072 '
37074 '
37076 '
37078 N1$=STR$(VAL(MID$(D.E$,9,1))*2)
37080 IF LEN(N1$)=2 THEN 37084
37082 N1%=N1%+VAL(MID$(N1$,3,1))
37084 N1%=N1%+VAL(MID$(N1$,2,1))
37086 N2%=VAL(MID$(D.E$,8,1))
37088 N3$=STR$(VAL(MID$(D.E$,7,1))*2)
37090 IF LEN(N3$)=2 THEN 37094
37092 N3%=N3%+VAL(MID$(N3$,3,1))
37094 N3%=N3%+VAL(MID$(N3$,2,1))
37096 N4%=VAL(MID$(D.E$,6,1))
37098 N5$=STR$(VAL(MID$(D.E$,5,1))*2)
37100 IF LEN(N5$)=2 THEN 37104
37102 N5%=N5%+VAL(MID$(N5$,3,1))
37104 N5%=N5%+VAL(MID$(N5$,2,1))
37106 N6%=VAL(MID$(D.E$,4,1))
37108 N7$=STR$(VAL(MID$(D.E$,3,1))*2)
37110 IF LEN(N7$)=2 THEN 37114
37112 N7%=N7%+VAL(MID$(N7$,3,1))
37114 N7%=N7%+VAL(MID$(N7$,2,1))
37116 N8%=VAL(MID$(D.E$,2,1))
37118 N9$=STR$(VAL(MID$(D.E$,1,1))*2)
37120 IF LEN(N9$)=2 THEN 37124
37122 N9%=N9%+VAL(MID$(N9$,3,1))
37124 N9%=N9%+VAL(MID$(N9$,2,1))
37126 'N10%=VAL(MID$(D.E$,1,1))
37128 DIG%=N1%+N2%+N3%+N4%+N5%+N6%+N7%+N8%+N9%    '+N10%
37130 DIG%=100-DIG%
37132 GOTO 37200
37134 IF MID$(CUPRI$,1,2)="38" THEN 37146
37136 IF MID$(CUPRI$,1,2)="75" THEN 37146
37138 IF MID$(CUPRI$,1,2)="75" THEN 37146
37140 IF MID$(CUPRI$,1,2)="80" THEN 37146
37142 IF MID$(CUPRI$,1,2)="90" THEN 37146
37144 IF MID$(CUPRI$,1,2)>"80" THEN 37212
37146 IF LEN(CUPRI$)<4 THEN 37204
37148 LN%=LEN(CUPRI$)-2:LC%=10-LEN(CUPRI$)
37150 CUPRIF$=MID$(CUPRI$,1,2)+LEFT$(CERO$,LC%)+MID$(CUPRI$,3,LN%)
37152 CUPRIE$=CUPRIF$
37154 IF EDI$="1" THEN EDI$="0":RETURN
37156 D.E$=MID$(CUPRIF$,1,2)+LEFT$(CERO$,LC%)+RIGHT$(CUPRIF$,LN%)
37158 N1%=VAL(MID$(D.E$,9,1))*2
37160 N2%=VAL(MID$(D.E$,8,1))*3
37162 N3%=VAL(MID$(D.E$,7,1))*4
37164 N4%=VAL(MID$(D.E$,6,1))*5
37166 N5%=VAL(MID$(D.E$,5,1))*6
37168 N6%=VAL(MID$(D.E$,4,1))*7
37170 N7%=VAL(MID$(D.E$,3,1))*8
37172 N10%=N1%+N2%+N3%+N4%+N5%+N6%+N7%
37174 N11%=INT(N10%/11)
37176 DIG%=N10%-(N11%*11)
37178 IF DIG%=1 THEN D$="0":GOTO 37202
37180 IF DIG%=2 THEN D$="9":GOTO 37202
37182 IF DIG%=3 THEN D$="8":GOTO 37202
37184 IF DIG%=4 THEN D$="7":GOTO 37202
37186 IF DIG%=5 THEN D$="6":GOTO 37202
37188 IF DIG%=6 THEN D$="5":GOTO 37202
37190 IF DIG%=7 THEN D$="4":GOTO 37202
37192 IF DIG%=8 THEN D$="3":GOTO 37202
37194 IF DIG%=9 THEN D$="2":GOTO 37202
37196 IF DIG%=10 THEN D$="1":GOTO 37202
37198 IF DIG%=0 THEN D$="1":GOTO 37202
37200 D$=STR$(DIG%)
37202 IF RIGHT$(D$,1)=RIGHT$(D.E$,1) THEN DI%=0:RETURN
37204 DI%=1:RETURN
37206 '
37208 '
37210 '
37212 'IF MID$(CUPRI$,1,2)="38" THEN 39050
37214 'IF MID$(CUPRI$,1,2)="75" THEN 39050
37216 'IF MID$(CUPRI$,1,2)="75" THEN 39050
37218 'IF MID$(CUPRI$,1,2)="80" THEN 39050
37220 'IF MID$(CUPRI$,1,2)="90" THEN 39050
37222 IF LEN(CUPRI$)<4 THEN 37268
37224 LN%=LEN(CUPRI$)-2:LC%=10-LEN(CUPRI$)
37226 CUPRIF$=MID$(CUPRI$,1,2)+LEFT$(CERO$,LC%)+MID$(CUPRI$,3,LN%)
37228 CUPRIE$=CUPRIF$
37230 IF EDI$="1" THEN EDI$="0":RETURN
37232 D.E$=MID$(CUPRIF$,1,2)+LEFT$(CERO$,LC%)+RIGHT$(CUPRIF$,LN%)
37234 N1%=VAL(MID$(D.E$,9,1))*6
37236 N2%=VAL(MID$(D.E$,8,1))*3
37238 N3%=VAL(MID$(D.E$,7,1))*7
37240 N4%=VAL(MID$(D.E$,6,1))*9
37242 N5%=VAL(MID$(D.E$,5,1))*10
37244 N6%=VAL(MID$(D.E$,4,1))*5
37246 N7%=VAL(MID$(D.E$,3,1))*8
37248 N8%=VAL(MID$(D.E$,2,1))*4
37250 N9%=VAL(MID$(D.E$,1,1))*2
37252 N10%=N1%+N2%+N3%+N4%+N5%+N6%+N7%+N8%+N9%
37254 N11%=INT(N10%/11)
37256 DIG%=N10%-(N11%*11)
37258 IF DIG%=0 THEN D$="0":GOTO 37266
37260 IF DIG%=1 THEN D$="1":GOTO 37266
37262 DIG%=11-DIG%
37264 D$=STR$(DIG%)
37266 IF RIGHT$(D$,1)=RIGHT$(D.E$,1) THEN DI%=0:RETURN
37268 DI%=1:RETURN
37270 '
37272 ' ***** FINAL DE LA RUTINA DE NUMERO DE CUENTA *****
37274 '
40000 'Ponemos el Nombre y los dos Apellidos en una linea.
40010 NOMBRE$=""
40020 'Bucle del Nombre.
40030 LONG%=LEN(NOM$)
40040 FOR I%=LONG% TO 1 STEP -1
40050    IF MID$(NOM$,I%,1)<>" " THEN LNOMBRE%=I%:I%=0
40060 NEXT I%
40070 '
40080 'Bucle del Apellido 1.
40090 LONG%=LEN(APE1$)
40100 FOR I%=LONG% TO 1 STEP -1
40110    IF MID$(APE1$,I%,1)<>" " THEN LAPELL1%=I%:I%=0
40120 NEXT I%
40130 '
40140 'Bucle del Apellido 2.
40150 LONG%=LEN(APE2$)
40160 FOR I%=LONG% TO 1 STEP -1
40170    IF MID$(APE2$,I%,1)<>" " THEN LAPELL2%=I%:I%=0
40180 NEXT I%
40190 CUCUCU$=LEFT$(NOM$,LNOMBRE%)+" "+LEFT$(APE1$,LAPELL1%)+" "+LEFT$(APE2$,LAPELL2%)
40200 CUCUCU$=LEFT$(CUCUCU$,50)
40210 RETURN
40220 '
50000  '******************************************
50002  '***CALCULO DEL DIGITO DE CUENTA CLIENTE***
50004  '******************************************
50006  '
50008  N01%=VAL(MID$(BANCA$,1,1)):N01%=N01%*4
50010  N02%=VAL(MID$(BANCA$,2,1)):N02%=N02%*8
50012  N03%=VAL(MID$(BANCA$,3,1)):N03%=N03%*5
50014  N04%=VAL(MID$(BANCA$,4,1)):N04%=N04%*10
50018  N05%=VAL(MID$(SUCUR$,1,1)):N05%=N05%*9
50020  N06%=VAL(MID$(SUCUR$,2,1)):N06%=N06%*7
50022  N07%=VAL(MID$(SUCUR$,3,1)):N07%=N07%*3
50024  N08%=VAL(MID$(SUCUR$,4,1)):N08%=N08%*6
50026  NTO%=N01%+N02%+N03%+N04%+N05%+N06%+N07%+N08%
50028  NCO%=INT(NTO%/11)
50030  RE1%=NTO%-(NCO%*11)
50032  DI1%=11-RE1%
50034  IF DI1%=11 THEN DI1%=0
50036  IF DI1%=10 THEN DI1%=1
50038  N01%=VAL(MID$(CUBAN$,1,1)):N01%=N01%*1
50040  N02%=VAL(MID$(CUBAN$,2,1)):N02%=N02%*2
50042  N03%=VAL(MID$(CUBAN$,3,1)):N03%=N03%*4
50044  N04%=VAL(MID$(CUBAN$,4,1)):N04%=N04%*8
50048  N05%=VAL(MID$(CUBAN$,5,1)):N05%=N05%*5
50050  N06%=VAL(MID$(CUBAN$,6,1)):N06%=N06%*10
50052  N07%=VAL(MID$(CUBAN$,7,1)):N07%=N07%*9
50053  N08%=VAL(MID$(CUBAN$,8,1)):N08%=N08%*7
50054  N09%=VAL(MID$(CUBAN$,9,1)):N09%=N09%*3
50055  N10%=VAL(MID$(CUBAN$,10,1)):N10%=N10%*6
50056  NTO%=N01%+N02%+N03%+N04%+N05%+N06%+N07%+N08%+N09%+N10%
50058  NCO%=INT(NTO%/11)
50060  RE1%=NTO%-(NCO%*11)
50062  DI2%=11-RE1%
50064  IF DI2%=11 THEN DI2%=0
50066  IF DI2%=10 THEN DI2%=1
50068  DI1$=STR$(DI1%):DI2$=STR$(DI2%):DIGI$=RIGHT$(DI1$,1)+RIGHT$(DI2$,1)
50070  '
50072  RETURN
50074  '
60000 '   +-------------------------------------------+
60010 '   +   SUBRUTINA de CONTROL DE FECHA LOGICA    +
60020 '   +-------------------------------------------+
60030 '   -  Recibe la fecha en formato DDMMAA sobre FECSUB$
60040 '   -  Devuelve sobre FEF$ la fecha en formato DD-MM-AA
60050 '   -  Utiliza ERF como Codigo de Retorno.0=fecha correcta,1=fecha erronea
60060 '-------------------------------------------------------------------------
60070 AA$=RIGHT$(FECSUB$,2):MM$=MID$(FECSUB$,3,2):DD$=LEFT$(FECSUB$,2)
60080 ANOMAX%=VAL(RIGHT$(DATE$,2))
60090 ANO%=VAL(AA$):MES%=VAL(MM$):DIA%=VAL(DD$):ERF%=0
60100 IF  (ANO% < 0  OR ANO% > 99 OR MES% < 1 OR MES% > 12) THEN 60140
60110 IF (ANO% MOD 4)= 0 THEN DIAS%(2)=29 ELSE DIAS%(2)=28
60120 IF (DIA% < 1 OR DIA% > DIAS%(MES%)) THEN 60140
60130 FDMA$=DD$+"-"+MM$+"-"+AA$:FAMD$=AA$+MM$+DD$:ERF%=0:RETURN 'Fecha Correcta
60140 ERF%=1:RETURN  'Fecha Incorrecta
60150 '-------------------------------------------------------------------------
60160 '
63000 '********************************
63010 '***RUTINA DE ENTRADA NUMERICA***
63020 '********************************
63030 '
63040 D.E$="":I.T%=0
63050 LOCATE F.C1%,C.C1%,1,0,6
63060 FOR JMG%=1 TO L.E%
63070  D.R$=INPUT$(1)
63075  IF ASC(D.R$)=14 AND JMG%=1 THEN JMG%=L.E%:I.T%=5:GOTO 63200  '===>AL NEXT
63080  IF ASC(D.R$)=13 AND JMG%=1 THEN JMG%=L.E%:I.T%=1:GOTO 63200  '===>AL NEXT
63090  IF ASC(D.R$)=13 THEN JMG%=L.E%:GOTO 63200  '===>AL NEXT
63100  IF ASC(D.R$)=10 THEN JMG%=L.E%:I.T%=2:GOTO 63200  '===>AL NEXT
63110  IF ASC(D.R$)=9 THEN JMG%=L.E%:I.T%=3:GOTO 63200   '===>AL NEXT
63120  IF ASC(D.R$)=7 THEN JMG%=L.E%:I.T%=4:GOTO 63200   '===>AL NEXT
63130  IF JMG%=1 THEN LOCATE F.C1%,C.C1%:PRINT STRING$(BO%,"-"):LOCATE F.C1%,C.C1%
63140  IF D.R$<"0" OR D.R$>"9" THEN 63170               'Error
63150  D.E$=D.E$+D.R$:PRINT D.R$;
63160  GOTO 63200 'AL NEXT
63170  'Error.
63175  IF ASC(D.R$)=8 AND JMG%=1 THEN 63190
63180  IF ASC(D.R$)=8 THEN LOCATE F.C1%,C.C1%+LEN(D.E$)-1:PRINT "-":LOCATE F.C1%,C.C1%+LEN(D.E$)-1:D.E$=LEFT$(D.E$,LEN(D.E$)-1):JMG%=JMG%-1
63190  JMG%=JMG%-1
63200 NEXT JMG%
63210 IF I.T%<>0 THEN 63230
63220 IF LEN(D.E$)<>L.E% THEN D.E$=LEFT$(CERO$,L.E%-LEN(D.E$))+D.E$
63225 LOCATE F.C1%,C.C1%:PRINT STRING$(BO%," ")
63230 RETURN
63240 '
64000 '*************************************
64010 '***RUTINA DE ENTRADA ALFA/NUMERICA***
64020 '*************************************
64030 '
64040 D.E$="":I.T%=0
64050 LOCATE F.C1%,C.C1%,1,0,6
64060 FOR JMG%=1 TO L.E%
64070  D.R$=INPUT$(1)
64075  IF ASC(D.R$)=14 AND JMG%=1 THEN JMG%=L.E%:I.T%=5:GOTO 64200  '===>AL NEXT
64080  IF ASC(D.R$)=13 AND JMG%=1 THEN JMG%=L.E%:I.T%=1:GOTO 64200  '===>AL NEXT
64090  IF ASC(D.R$)=13 THEN JMG%=L.E%:GOTO 64200  '===>AL NEXT
64100  IF ASC(D.R$)=10 THEN JMG%=L.E%:I.T%=2:GOTO 64200  '===>AL NEXT
64110  IF ASC(D.R$)=9 THEN JMG%=L.E%:I.T%=3:GOTO 64200   '===>AL NEXT
64120  IF ASC(D.R$)=7 THEN JMG%=L.E%:I.T%=4:GOTO 64200   '===>AL NEXT
64130  IF JMG%=1 THEN LOCATE F.C1%,C.C1%:PRINT STRING$(BO%," "):LOCATE F.C1%,C.C1%
64135  IF ASC(D.R$)=34 THEN 64170
64140  IF ASC(D.R$)<32 OR ASC(D.R$)>126 THEN 64170               'Error
64150  D.E$=D.E$+D.R$:PRINT D.R$;
64160  GOTO 64200 'AL NEXT
64170  'Error.
64172  IF D.R$="¥" OR D.R$="¤" THEN 64150
64175  IF ASC(D.R$)=8 AND JMG%=1 THEN 64190
64180  IF ASC(D.R$)=8 THEN LOCATE F.C1%,C.C1%+LEN(D.E$)-1:PRINT " ":LOCATE F.C1%,C.C1%+LEN(D.E$)-1:D.E$=LEFT$(D.E$,LEN(D.E$)-1):JMG%=JMG%-1
64190  JMG%=JMG%-1
64200 NEXT JMG%
64210 IF I.T%<>0 THEN 64230
64220 'D.E$=D.E$+LEFT$(BLANCO$,L.E%-LEN(D.E$))
64225 'LOCATE F.C1%,C.C1%:PRINT D.E$
64230 RETURN
64240 '
64760 '========================================================================
64762 ' RUTINA PARA EDITAR IMPORTES EN CRISTIANO X.XXX.XXX,XX                 =
64764 '                                                                       =
64766 ' SE ENTRARA A ESTA RUTINA DE LA FORMA  SIGUIENTE:                      =
64768 '                                                                       =
64770 ' GOSUB 64760 MANDANDO EN UN CAMPO LLAMADO GUAPRI#,                     =
64772 '                                                                       =
64773 '             LA CANTIDAD O NUMERO QUE DESEEMOS EDITAR.                 =
64774 '                                                                       =
64775 '             Y EN UN CAMPO LLAMADO N.D% EL NUMERO DE DECIMALES         =
64776 '                                                                       =
64778 ' DEVOLVERA EL CAMPO EDITADO EN GUAPRI$ Y LA LONGITUD EN L.C%           =
64780 '                                                                       =
64782 '========================================================================
64784 '
64786 '
64788 GUAPRI$=STR$(GUAPRI#):L.P%=0:N.D%=0
64790 FOR I%=1 TO 30:TABENT$(I%)="":NEXT I%
64792 SIGNO$=LEFT$(GUAPRI$,1):GUAPRI$=RIGHT$(GUAPRI$,LEN(GUAPRI$)-1)
64794 FOR I%=1 TO LEN(GUAPRI$)
64796   IF MID$(GUAPRI$,I%,1)="." THEN L.P%=I%:I%=LEN(GUAPRI$)
64798 NEXT I%
64800 IF L.P%=0 THEN DEC$="":ENT$=GUAPRI$:GOTO 64812
64802 IF N.D%=0 THEN DEC$="":GOTO 64808
64804 DEC$=","+MID$(GUAPRI$,L.P%+1,N.D%)
64806 IF LEN(DEC$)<>N.D%+1 THEN DEC$=DEC$+LEFT$(CERO$,N.D%+1-LEN(DEC$))
64808 ENT$=LEFT$(GUAPRI$,L.P%-1)
64810 IF LEN(ENT$)=0 THEN GUAPRI$="0":GOTO 64834
64812 X%=31
64814 FOR I%=LEN(ENT$) TO 1 STEP -1
64816   X%=X%-1
64818   IF X%=27 OR X%=23 OR X%=19 OR X%=15 OR X%=12 THEN TABENT$(X%)=".":X%=X%-1
64820   TABENT$(X%)=MID$(ENT$,I%,1)
64822 NEXT I%
64824 GUAPRI$=""
64826 FOR I%=1 TO 30
64828   IF TABENT$(I%)="" THEN 64832
64830   GUAPRI$=GUAPRI$+TABENT$(I%)
64832 NEXT I%
64833 IF SIGNO$=" " THEN GUAPRI$=GUAPRI$+DEC$:L.C%=LEN(GUAPRI$)-1:RETURN
64834 GUAPRI$=GUAPRI$+DEC$+SIGNO$:L.C%=LEN(GUAPRI$)-1
64836 RETURN
64838 '
